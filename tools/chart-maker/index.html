<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chart Maker | ì°¨íŠ¸ ë©”ì´ì»¤</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#f8f9fa;--bg2:#fff;--text:#212529;--text2:#6c757d;--border:#dee2e6;--accent:#667eea;--accent2:#764ba2;--shadow:rgba(0,0,0,.08)}
[data-theme=dark]{--bg:#121212;--bg2:#1e1e1e;--text:#e0e0e0;--text2:#999;--border:#333;--shadow:rgba(0,0,0,.3)}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:all .3s}
.header{text-align:center;padding:30px 20px 20px;position:relative}
.header h1{font-size:1.8rem;background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header p{color:var(--text2);margin-top:8px;font-size:.95rem}
.back-link{position:absolute;left:20px;top:35px;text-decoration:none;color:var(--accent);font-size:1.2rem}
.theme-btn{position:absolute;right:20px;top:30px;background:var(--bg2);border:2px solid var(--border);border-radius:50%;width:42px;height:42px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center}
.container{max-width:1100px;margin:0 auto;padding:0 20px 40px;display:grid;grid-template-columns:380px 1fr;gap:24px}
@media(max-width:800px){.container{grid-template-columns:1fr}}
.panel{background:var(--bg2);border-radius:16px;padding:24px;box-shadow:0 4px 20px var(--shadow)}
label{display:block;font-weight:600;margin-bottom:6px;font-size:.9rem}
select,input,textarea{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:10px;background:var(--bg);color:var(--text);font-size:.95rem;transition:border .2s;font-family:inherit}
select:focus,input:focus,textarea:focus{outline:none;border-color:var(--accent)}
textarea{resize:vertical;min-height:120px;font-family:'Courier New',monospace;font-size:.85rem}
.row{display:flex;gap:12px;margin-bottom:16px}
.row>div{flex:1}
.mb{margin-bottom:16px}
.btn{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;border:none;border-radius:10px;cursor:pointer;font-size:.95rem;font-weight:600;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(102,126,234,.4)}
.btn-secondary{background:var(--bg);border:2px solid var(--border);color:var(--text)}
.btn-secondary:hover{border-color:var(--accent)}
.btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px}
.themes{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
.theme-swatch{width:32px;height:32px;border-radius:8px;border:3px solid transparent;cursor:pointer;transition:all .2s;position:relative}
.theme-swatch.active{border-color:var(--accent);transform:scale(1.15)}
.theme-swatch::after{content:'';position:absolute;inset:0;border-radius:5px}
.canvas-wrap{display:flex;align-items:center;justify-content:center;min-height:400px}
canvas{max-width:100%;border-radius:8px;background:#fff}
[data-theme=dark] canvas{background:#1a1a1a}
.hint{font-size:.8rem;color:var(--text2);margin-top:4px}
</style>
</head>
<body>
<div class="header">
<a href="../" class="back-link">â† ë„êµ¬ ëª©ë¡</a>
<button class="theme-btn" onclick="toggleTheme()">ğŸŒ“</button>
<h1>ğŸ“Š Chart Maker</h1>
<p>ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©´ ì¦‰ì‹œ ì°¨íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤</p>
</div>
<div class="container">
<div class="panel" id="controls">
<div class="mb">
<label>ì°¨íŠ¸ ìœ í˜•</label>
<select id="chartType" onchange="render()">
<option value="bar">Bar (ë§‰ëŒ€)</option>
<option value="line">Line (êº¾ì€ì„ )</option>
<option value="pie">Pie (íŒŒì´)</option>
<option value="doughnut">Doughnut (ë„ë„›)</option>
</select>
</div>
<div class="mb">
<label>ë°ì´í„° ì…ë ¥ (CSV)</label>
<textarea id="dataInput" placeholder="ë ˆì´ë¸”,ê°’&#10;ì‚¬ê³¼,30&#10;ë°”ë‚˜ë‚˜,50&#10;ì²´ë¦¬,20&#10;í¬ë„,45&#10;ì˜¤ë Œì§€,35">ì‚¬ê³¼,30
ë°”ë‚˜ë‚˜,50
ì²´ë¦¬,20
í¬ë„,45
ì˜¤ë Œì§€,35</textarea>
<div class="hint">í˜•ì‹: ë ˆì´ë¸”,ê°’ (í•œ ì¤„ì— í•˜ë‚˜ì”©) ë˜ëŠ” CSV ë¶™ì—¬ë„£ê¸°</div>
</div>
<div class="mb">
<label>ì°¨íŠ¸ ì œëª©</label>
<input type="text" id="chartTitle" value="ê³¼ì¼ë³„ íŒë§¤ëŸ‰" oninput="render()">
</div>
<div class="row">
<div>
<label>ë„ˆë¹„</label>
<input type="number" id="cw" value="700" min="200" max="2000" onchange="render()">
</div>
<div>
<label>ë†’ì´</label>
<input type="number" id="ch" value="500" min="200" max="2000" onchange="render()">
</div>
</div>
<div class="mb">
<label>ìƒ‰ìƒ í…Œë§ˆ</label>
<div class="themes" id="themes"></div>
</div>
<div class="btn-row">
<button class="btn btn-primary" onclick="render()">ğŸ”„ ì°¨íŠ¸ ìƒì„±</button>
<button class="btn btn-secondary" onclick="download()">ğŸ’¾ PNG ë‹¤ìš´ë¡œë“œ</button>
</div>
</div>
<div class="panel">
<div class="canvas-wrap">
<canvas id="chart"></canvas>
</div>
</div>
</div>
<script>
const THEMES = {
  vivid: ['#667eea','#764ba2','#f093fb','#4facfe','#43e97b','#fa709a','#fee140','#a18cd1'],
  pastel: ['#ffd1dc','#bae1ff','#baffc9','#ffffba','#e8d1ff','#ffd1a4','#d1f0ff','#ffc9de'],
  neon: ['#ff006e','#8338ec','#3a86ff','#06d6a0','#ffd166','#ef476f','#118ab2','#073b4c'],
  earth: ['#bc6c25','#606c38','#dda15e','#283618','#fefae0','#7f5539','#9b2226','#0a9396'],
  ocean: ['#023e8a','#0077b6','#0096c7','#00b4d8','#48cae4','#90e0ef','#ade8f4','#caf0f8'],
  sunset: ['#ff4e50','#fc913a','#f9d423','#ede574','#e1f5c4','#ff6b6b','#feca57','#ff9ff3'],
  mono: ['#212529','#495057','#6c757d','#adb5bd','#ced4da','#dee2e6','#e9ecef','#f8f9fa']
};
let currentTheme = 'vivid';

function initThemes(){
  const el=document.getElementById('themes');
  Object.keys(THEMES).forEach(k=>{
    const d=document.createElement('div');
    d.className='theme-swatch'+(k===currentTheme?' active':'');
    d.style.background=`linear-gradient(135deg,${THEMES[k][0]},${THEMES[k][1]},${THEMES[k][2]})`;
    d.title=k;
    d.onclick=()=>{currentTheme=k;document.querySelectorAll('.theme-swatch').forEach(s=>s.classList.remove('active'));d.classList.add('active');render()};
    el.appendChild(d);
  });
}

function parseData(){
  const raw=document.getElementById('dataInput').value.trim();
  if(!raw)return{labels:[],values:[]};
  const lines=raw.split('\n').filter(l=>l.trim());
  const labels=[],values=[];
  lines.forEach(l=>{
    const parts=l.split(/[,\t;]/).map(s=>s.trim());
    if(parts.length>=2){
      labels.push(parts[0]);
      const v=parseFloat(parts[1]);
      if(!isNaN(v))values.push(v);
      else values.push(0);
    }
  });
  return{labels,values};
}

function render(){
  const canvas=document.getElementById('chart');
  const ctx=canvas.getContext('2d');
  const W=parseInt(document.getElementById('cw').value)||700;
  const H=parseInt(document.getElementById('ch').value)||500;
  canvas.width=W;canvas.height=H;
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  ctx.fillStyle=isDark?'#1a1a1a':'#ffffff';
  ctx.fillRect(0,0,W,H);
  const {labels,values}=parseData();
  if(!labels.length)return;
  const colors=THEMES[currentTheme];
  const type=document.getElementById('chartType').value;
  const title=document.getElementById('chartTitle').value;
  
  // Title
  ctx.fillStyle=isDark?'#e0e0e0':'#212529';
  ctx.font='bold 20px -apple-system,sans-serif';
  ctx.textAlign='center';
  ctx.fillText(title,W/2,35);
  
  if(type==='bar')drawBar(ctx,W,H,labels,values,colors,isDark);
  else if(type==='line')drawLine(ctx,W,H,labels,values,colors,isDark);
  else if(type==='pie')drawPie(ctx,W,H,labels,values,colors,isDark,false);
  else if(type==='doughnut')drawPie(ctx,W,H,labels,values,colors,isDark,true);
}

function drawBar(ctx,W,H,labels,values,colors,isDark){
  const pad={t:60,r:30,b:80,l:60};
  const cw=W-pad.l-pad.r,ch=H-pad.t-pad.b;
  const max=Math.max(...values)*1.15;
  const barW=Math.min(cw/labels.length*.7,80);
  const gap=(cw-barW*labels.length)/(labels.length+1);
  // Grid
  ctx.strokeStyle=isDark?'#333':'#e9ecef';ctx.lineWidth=1;
  for(let i=0;i<=5;i++){
    const y=pad.t+ch-ch*(i/5);
    ctx.beginPath();ctx.moveTo(pad.l,y);ctx.lineTo(W-pad.r,y);ctx.stroke();
    ctx.fillStyle=isDark?'#999':'#6c757d';ctx.font='12px sans-serif';ctx.textAlign='right';
    ctx.fillText(Math.round(max*i/5),pad.l-8,y+4);
  }
  // Bars
  labels.forEach((l,i)=>{
    const x=pad.l+gap+(barW+gap)*i;
    const h=(values[i]/max)*ch;
    const y=pad.t+ch-h;
    const grad=ctx.createLinearGradient(x,y,x,pad.t+ch);
    grad.addColorStop(0,colors[i%colors.length]);
    grad.addColorStop(1,colors[(i+1)%colors.length]);
    ctx.fillStyle=grad;
    roundRect(ctx,x,y,barW,h,6);
    // Value
    ctx.fillStyle=isDark?'#e0e0e0':'#212529';ctx.font='bold 13px sans-serif';ctx.textAlign='center';
    ctx.fillText(values[i],x+barW/2,y-8);
    // Label
    ctx.fillStyle=isDark?'#ccc':'#495057';ctx.font='13px sans-serif';
    ctx.save();ctx.translate(x+barW/2,pad.t+ch+16);
    if(l.length>6)ctx.rotate(-.4);
    ctx.fillText(l,0,0);ctx.restore();
  });
}

function drawLine(ctx,W,H,labels,values,colors,isDark){
  const pad={t:60,r:30,b:80,l:60};
  const cw=W-pad.l-pad.r,ch=H-pad.t-pad.b;
  const max=Math.max(...values)*1.15;
  const stepX=cw/(labels.length-1||1);
  // Grid
  ctx.strokeStyle=isDark?'#333':'#e9ecef';ctx.lineWidth=1;
  for(let i=0;i<=5;i++){
    const y=pad.t+ch-ch*(i/5);
    ctx.beginPath();ctx.moveTo(pad.l,y);ctx.lineTo(W-pad.r,y);ctx.stroke();
    ctx.fillStyle=isDark?'#999':'#6c757d';ctx.font='12px sans-serif';ctx.textAlign='right';
    ctx.fillText(Math.round(max*i/5),pad.l-8,y+4);
  }
  // Area
  const pts=values.map((v,i)=>({x:pad.l+stepX*i,y:pad.t+ch-(v/max)*ch}));
  ctx.beginPath();ctx.moveTo(pts[0].x,pad.t+ch);
  pts.forEach(p=>ctx.lineTo(p.x,p.y));
  ctx.lineTo(pts[pts.length-1].x,pad.t+ch);ctx.closePath();
  const aGrad=ctx.createLinearGradient(0,pad.t,0,pad.t+ch);
  aGrad.addColorStop(0,colors[0]+'60');aGrad.addColorStop(1,colors[0]+'05');
  ctx.fillStyle=aGrad;ctx.fill();
  // Line
  ctx.beginPath();pts.forEach((p,i)=>i===0?ctx.moveTo(p.x,p.y):ctx.lineTo(p.x,p.y));
  ctx.strokeStyle=colors[0];ctx.lineWidth=3;ctx.lineJoin='round';ctx.stroke();
  // Dots + labels
  pts.forEach((p,i)=>{
    ctx.beginPath();ctx.arc(p.x,p.y,6,0,Math.PI*2);ctx.fillStyle=colors[0];ctx.fill();
    ctx.beginPath();ctx.arc(p.x,p.y,3,0,Math.PI*2);ctx.fillStyle='#fff';ctx.fill();
    ctx.fillStyle=isDark?'#e0e0e0':'#212529';ctx.font='bold 12px sans-serif';ctx.textAlign='center';
    ctx.fillText(values[i],p.x,p.y-14);
    ctx.fillStyle=isDark?'#ccc':'#495057';ctx.font='13px sans-serif';
    ctx.fillText(labels[i],p.x,pad.t+ch+20);
  });
}

function drawPie(ctx,W,H,labels,values,colors,isDark,isDoughnut){
  const cx=W/2,cy=H/2+10;
  const r=Math.min(W,H)/2-80;
  const total=values.reduce((a,b)=>a+b,0);
  let startAngle=-Math.PI/2;
  const slices=[];
  values.forEach((v,i)=>{
    const angle=(v/total)*Math.PI*2;
    slices.push({start:startAngle,end:startAngle+angle,color:colors[i%colors.length],label:labels[i],value:v,pct:((v/total)*100).toFixed(1)});
    startAngle+=angle;
  });
  slices.forEach(s=>{
    ctx.beginPath();ctx.moveTo(cx,cy);ctx.arc(cx,cy,r,s.start,s.end);ctx.closePath();
    ctx.fillStyle=s.color;ctx.fill();
    ctx.strokeStyle=isDark?'#1a1a1a':'#fff';ctx.lineWidth=2;ctx.stroke();
  });
  if(isDoughnut){
    ctx.beginPath();ctx.arc(cx,cy,r*.55,0,Math.PI*2);
    ctx.fillStyle=isDark?'#1a1a1a':'#fff';ctx.fill();
    ctx.fillStyle=isDark?'#e0e0e0':'#212529';ctx.font='bold 24px sans-serif';ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.fillText(total,cx,cy-8);ctx.font='13px sans-serif';ctx.fillStyle=isDark?'#999':'#6c757d';ctx.fillText('í•©ê³„',cx,cy+16);
  }
  // Legend
  const legX=20,legY=H-labels.length*22-10;
  slices.forEach((s,i)=>{
    const y=legY+i*22;
    ctx.fillStyle=s.color;roundRect(ctx,legX,y,14,14,3);
    ctx.fillStyle=isDark?'#ccc':'#495057';ctx.font='13px sans-serif';ctx.textAlign='left';
    ctx.fillText(`${s.label} (${s.pct}%)`,legX+20,y+12);
  });
}

function roundRect(ctx,x,y,w,h,r){
  ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);
  ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);ctx.lineTo(x+r,y+h);
  ctx.quadraticCurveTo(x,y+h,x,y+h-r);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();ctx.fill();
}

function download(){
  const a=document.createElement('a');a.download='chart.png';
  a.href=document.getElementById('chart').toDataURL('image/png');a.click();
}

function toggleTheme(){
  const t=document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark';
  document.documentElement.setAttribute('data-theme',t);localStorage.setItem('theme',t);render();
}

document.documentElement.setAttribute('data-theme',localStorage.getItem('theme')||'light');
document.getElementById('dataInput').addEventListener('input',render);
initThemes();render();
</script>
</body>
</html>
