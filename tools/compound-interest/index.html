<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë³µë¦¬ ê³„ì‚°ê¸° | Compound Interest Calculator</title>
<meta name="description" content="íˆ¬ì, ì ê¸ˆ, ì˜ˆê¸ˆì˜ ë³µë¦¬ ìˆ˜ìµì„ ê³„ì‚°í•˜ê³  ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤. ì›” ì ë¦½, ì—° ì ë¦½, ì¼ì‹œë¶ˆ íˆ¬ì ì‹œë®¬ë ˆì´ì…˜.">
<style>
  :root {
    --primary: #2563eb;
    --primary-dark: #1d4ed8;
    --primary-light: #dbeafe;
    --secondary: #10b981;
    --secondary-light: #d1fae5;
    --accent: #f59e0b;
    --accent-light: #fef3c7;
    --danger: #ef4444;
    --bg: #f8fafc;
    --card: #ffffff;
    --text: #1e293b;
    --text-secondary: #64748b;
    --border: #e2e8f0;
    --shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
    --radius: 12px;
    --radius-sm: 8px;
    --transition: all 0.2s ease;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --primary-light: #1e3a5f;
      --secondary: #34d399;
      --secondary-light: #064e3b;
      --accent: #fbbf24;
      --accent-light: #78350f;
      --bg: #0f172a;
      --card: #1e293b;
      --text: #f1f5f9;
      --text-secondary: #94a3b8;
      --border: #334155;
      --shadow: 0 1px 3px rgba(0,0,0,0.3);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.3);
    }
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    min-height: 100vh;
  }

  .container {
    max-width: 960px;
    margin: 0 auto;
    padding: 20px 16px;
  }

  header {
    text-align: center;
    margin-bottom: 32px;
  }

  header h1 {
    font-size: 2rem;
    font-weight: 800;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 8px;
  }

  header p {
    color: var(--text-secondary);
    font-size: 0.95rem;
  }

  .card {
    background: var(--card);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: var(--shadow);
    border: 1px solid var(--border);
    margin-bottom: 20px;
  }

  .card-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card-title .icon {
    font-size: 1.3rem;
  }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }

  @media (max-width: 600px) {
    .form-grid {
      grid-template-columns: 1fr;
    }
    header h1 {
      font-size: 1.5rem;
    }
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .form-group.full-width {
    grid-column: 1 / -1;
  }

  label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 4px;
  }

  label .tooltip-icon {
    cursor: help;
    color: var(--primary);
    font-size: 0.75rem;
    background: var(--primary-light);
    width: 16px;
    height: 16px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
  }

  .input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
  }

  .input-wrapper .prefix,
  .input-wrapper .suffix {
    position: absolute;
    color: var(--text-secondary);
    font-size: 0.9rem;
    font-weight: 500;
    pointer-events: none;
  }

  .input-wrapper .prefix {
    left: 12px;
  }

  .input-wrapper .suffix {
    right: 12px;
  }

  input[type="number"],
  select {
    width: 100%;
    padding: 10px 12px;
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    font-size: 1rem;
    color: var(--text);
    background: var(--card);
    transition: var(--transition);
    -webkit-appearance: none;
    appearance: none;
  }

  input[type="number"]:focus,
  select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
  }

  input.has-prefix {
    padding-left: 28px;
  }

  input.has-suffix {
    padding-right: 40px;
  }

  .preset-buttons {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-top: 4px;
  }

  .preset-btn {
    padding: 4px 10px;
    border: 1px solid var(--border);
    border-radius: 20px;
    background: var(--card);
    color: var(--text-secondary);
    font-size: 0.75rem;
    cursor: pointer;
    transition: var(--transition);
    white-space: nowrap;
  }

  .preset-btn:hover,
  .preset-btn.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  .btn-calculate {
    width: 100%;
    padding: 14px 24px;
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
    color: white;
    border: none;
    border-radius: var(--radius-sm);
    font-size: 1.05rem;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition);
    margin-top: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .btn-calculate:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg);
  }

  .btn-calculate:active {
    transform: translateY(0);
  }

  /* Results */
  .results-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 12px;
    margin-bottom: 24px;
  }

  .result-box {
    background: var(--bg);
    border-radius: var(--radius-sm);
    padding: 16px;
    text-align: center;
    border: 1px solid var(--border);
  }

  .result-box.highlight {
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    border: none;
  }

  .result-box .result-label {
    font-size: 0.8rem;
    font-weight: 500;
    opacity: 0.8;
    margin-bottom: 4px;
  }

  .result-box .result-value {
    font-size: 1.4rem;
    font-weight: 800;
  }

  .result-box .result-sub {
    font-size: 0.75rem;
    opacity: 0.7;
    margin-top: 2px;
  }

  /* Chart */
  .chart-container {
    position: relative;
    width: 100%;
    height: 320px;
    margin: 20px 0;
  }

  canvas {
    width: 100% !important;
    height: 100% !important;
  }

  .chart-legend {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin-top: 12px;
  }

  .legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.85rem;
    color: var(--text-secondary);
  }

  .legend-dot {
    width: 12px;
    height: 12px;
    border-radius: 3px;
  }

  /* Table */
  .table-wrapper {
    overflow-x: auto;
    margin-top: 16px;
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.85rem;
  }

  th {
    background: var(--bg);
    padding: 10px 12px;
    text-align: right;
    font-weight: 600;
    color: var(--text-secondary);
    border-bottom: 2px solid var(--border);
    white-space: nowrap;
    position: sticky;
    top: 0;
  }

  th:first-child {
    text-align: center;
  }

  td {
    padding: 10px 12px;
    text-align: right;
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
  }

  td:first-child {
    text-align: center;
    font-weight: 600;
    color: var(--primary);
  }

  tr:hover td {
    background: var(--primary-light);
  }

  .table-scroll {
    max-height: 400px;
    overflow-y: auto;
  }

  /* Toggle */
  .toggle-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
  }

  .toggle-btn-group {
    display: flex;
    background: var(--bg);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border);
    overflow: hidden;
  }

  .toggle-btn {
    padding: 8px 16px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
  }

  .toggle-btn.active {
    background: var(--primary);
    color: white;
  }

  /* Scenario comparison */
  .scenario-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
  }

  .scenario-card {
    background: var(--bg);
    border: 2px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 16px;
    cursor: pointer;
    transition: var(--transition);
  }

  .scenario-card:hover,
  .scenario-card.active {
    border-color: var(--primary);
  }

  .scenario-card .scenario-name {
    font-weight: 700;
    margin-bottom: 4px;
  }

  .scenario-card .scenario-desc {
    font-size: 0.8rem;
    color: var(--text-secondary);
  }

  .scenario-card .scenario-result {
    font-size: 1.3rem;
    font-weight: 800;
    color: var(--primary);
    margin-top: 8px;
  }

  /* Inflation toggle */
  .inflation-row {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .switch {
    position: relative;
    width: 44px;
    height: 24px;
    flex-shrink: 0;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: var(--border);
    border-radius: 24px;
    cursor: pointer;
    transition: var(--transition);
  }

  .slider:before {
    content: '';
    position: absolute;
    width: 18px;
    height: 18px;
    left: 3px;
    bottom: 3px;
    background: white;
    border-radius: 50%;
    transition: var(--transition);
  }

  .switch input:checked + .slider {
    background: var(--primary);
  }

  .switch input:checked + .slider:before {
    transform: translateX(20px);
  }

  /* Bookmark / Save */
  .actions-bar {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-top: 16px;
  }

  .btn-action {
    padding: 8px 16px;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    background: var(--card);
    color: var(--text);
    font-size: 0.85rem;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .btn-action:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  /* Saved list */
  .saved-list {
    margin-top: 12px;
  }

  .saved-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 12px;
    background: var(--bg);
    border-radius: var(--radius-sm);
    margin-bottom: 6px;
    border: 1px solid var(--border);
  }

  .saved-item .saved-name {
    font-weight: 600;
    font-size: 0.9rem;
  }

  .saved-item .saved-detail {
    font-size: 0.75rem;
    color: var(--text-secondary);
  }

  .saved-item .saved-actions {
    display: flex;
    gap: 6px;
  }

  .saved-item .saved-actions button {
    padding: 4px 8px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background: var(--card);
    color: var(--text-secondary);
    font-size: 0.75rem;
    cursor: pointer;
    transition: var(--transition);
  }

  .saved-item .saved-actions button:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  .saved-item .saved-actions button.delete:hover {
    border-color: var(--danger);
    color: var(--danger);
  }

  /* Footer */
  footer {
    text-align: center;
    padding: 24px 0;
    color: var(--text-secondary);
    font-size: 0.8rem;
  }

  footer a {
    color: var(--primary);
    text-decoration: none;
  }

  /* Animation */
  .fade-in {
    animation: fadeIn 0.4s ease;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Tab navigation */
  .tab-nav {
    display: flex;
    gap: 4px;
    margin-bottom: 20px;
    background: var(--bg);
    border-radius: var(--radius-sm);
    padding: 4px;
    border: 1px solid var(--border);
  }

  .tab-nav button {
    flex: 1;
    padding: 10px 8px;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 6px;
    transition: var(--transition);
  }

  .tab-nav button.active {
    background: var(--card);
    color: var(--primary);
    box-shadow: var(--shadow);
  }

  .tab-content {
    display: none;
  }

  .tab-content.active {
    display: block;
  }

  /* Responsive chart */
  @media (max-width: 600px) {
    .chart-container {
      height: 250px;
    }
    .results-summary {
      grid-template-columns: 1fr 1fr;
    }
    .result-box .result-value {
      font-size: 1.1rem;
    }
  }

  /* Hidden */
  .hidden { display: none !important; }

  /* Tooltip */
  .tooltip {
    position: relative;
  }

  .tooltip .tooltip-text {
    visibility: hidden;
    background: var(--text);
    color: var(--bg);
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 0.75rem;
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    white-space: nowrap;
    z-index: 10;
    margin-bottom: 4px;
  }

  .tooltip:hover .tooltip-text {
    visibility: visible;
  }

  /* Print styles */
  @media print {
    body { background: white; }
    .btn-calculate, .actions-bar, .tab-nav, .preset-buttons, footer { display: none; }
    .card { box-shadow: none; border: 1px solid #ddd; }
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>ğŸ’° ë³µë¦¬ ê³„ì‚°ê¸°</h1>
    <p>íˆ¬ì ì„±ì¥ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê³  ë¯¸ë˜ ìì‚°ì„ ì˜ˆì¸¡í•˜ì„¸ìš”</p>
  </header>

  <!-- Tab Navigation -->
  <div class="tab-nav">
    <button class="active" onclick="switchTab('calculator')">ğŸ“Š ê³„ì‚°ê¸°</button>
    <button onclick="switchTab('comparison')">âš¡ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ</button>
    <button onclick="switchTab('saved')">ğŸ’¾ ì €ì¥ ëª©ë¡</button>
  </div>

  <!-- Calculator Tab -->
  <div id="tab-calculator" class="tab-content active">
    <div class="card">
      <div class="card-title"><span class="icon">ğŸ“¥</span> íˆ¬ì ì •ë³´ ì…ë ¥</div>
      <div class="form-grid">
        <div class="form-group">
          <label>ì´ˆê¸° íˆ¬ìê¸ˆ <span class="tooltip-icon tooltip">?<span class="tooltip-text">ì²˜ìŒ íˆ¬ìí•˜ëŠ” ê¸ˆì•¡ (ì›ê¸ˆ)</span></span></label>
          <div class="input-wrapper">
            <input type="number" id="principal" value="10000000" min="0" step="1000000" class="has-suffix" oninput="autoCalculate()">
            <span class="suffix">ì›</span>
          </div>
          <div class="preset-buttons">
            <button class="preset-btn" onclick="setPreset('principal', 1000000)">100ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('principal', 5000000)">500ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('principal', 10000000)">1000ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('principal', 50000000)">5000ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('principal', 100000000)">1ì–µ</button>
          </div>
        </div>

        <div class="form-group">
          <label>ì—° ì´ììœ¨ (ìˆ˜ìµë¥ ) <span class="tooltip-icon tooltip">?<span class="tooltip-text">ì—°ê°„ ì˜ˆìƒ ìˆ˜ìµë¥  (%)</span></span></label>
          <div class="input-wrapper">
            <input type="number" id="rate" value="7" min="0" max="100" step="0.1" class="has-suffix" oninput="autoCalculate()">
            <span class="suffix">%</span>
          </div>
          <div class="preset-buttons">
            <button class="preset-btn" onclick="setPreset('rate', 2)">ì˜ˆê¸ˆ 2%</button>
            <button class="preset-btn" onclick="setPreset('rate', 4)">ì±„ê¶Œ 4%</button>
            <button class="preset-btn" onclick="setPreset('rate', 7)">ì£¼ì‹ 7%</button>
            <button class="preset-btn" onclick="setPreset('rate', 10)">ê³µê²©ì  10%</button>
            <button class="preset-btn" onclick="setPreset('rate', 15)">15%</button>
          </div>
        </div>

        <div class="form-group">
          <label>íˆ¬ì ê¸°ê°„</label>
          <div class="input-wrapper">
            <input type="number" id="years" value="20" min="1" max="60" step="1" class="has-suffix" oninput="autoCalculate()">
            <span class="suffix">ë…„</span>
          </div>
          <div class="preset-buttons">
            <button class="preset-btn" onclick="setPreset('years', 5)">5ë…„</button>
            <button class="preset-btn" onclick="setPreset('years', 10)">10ë…„</button>
            <button class="preset-btn" onclick="setPreset('years', 20)">20ë…„</button>
            <button class="preset-btn" onclick="setPreset('years', 30)">30ë…„</button>
          </div>
        </div>

        <div class="form-group">
          <label>ë³µë¦¬ ì£¼ê¸°</label>
          <select id="compoundFreq" onchange="autoCalculate()">
            <option value="1">ì—°ë³µë¦¬ (1íšŒ/ë…„)</option>
            <option value="2">ë°˜ê¸°ë³µë¦¬ (2íšŒ/ë…„)</option>
            <option value="4">ë¶„ê¸°ë³µë¦¬ (4íšŒ/ë…„)</option>
            <option value="12" selected>ì›”ë³µë¦¬ (12íšŒ/ë…„)</option>
            <option value="365">ì¼ë³µë¦¬ (365íšŒ/ë…„)</option>
          </select>
        </div>

        <div class="form-group">
          <label>ì •ê¸° ì ë¦½ê¸ˆ (ì„ íƒ)</label>
          <div class="input-wrapper">
            <input type="number" id="contribution" value="500000" min="0" step="10000" class="has-suffix" oninput="autoCalculate()">
            <span class="suffix">ì›</span>
          </div>
          <div class="preset-buttons">
            <button class="preset-btn" onclick="setPreset('contribution', 0)">ì—†ìŒ</button>
            <button class="preset-btn" onclick="setPreset('contribution', 100000)">10ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('contribution', 300000)">30ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('contribution', 500000)">50ë§Œ</button>
            <button class="preset-btn" onclick="setPreset('contribution', 1000000)">100ë§Œ</button>
          </div>
        </div>

        <div class="form-group">
          <label>ì ë¦½ ì£¼ê¸°</label>
          <select id="contributionFreq" onchange="autoCalculate()">
            <option value="12" selected>ë§¤ì›”</option>
            <option value="4">ë§¤ ë¶„ê¸°</option>
            <option value="2">ë§¤ ë°˜ê¸°</option>
            <option value="1">ë§¤ë…„</option>
          </select>
        </div>

        <div class="form-group full-width">
          <div class="inflation-row">
            <label class="switch">
              <input type="checkbox" id="inflationToggle" onchange="toggleInflation()">
              <span class="slider"></span>
            </label>
            <label>ì¸í”Œë ˆì´ì…˜ ë°˜ì˜</label>
            <div class="input-wrapper" style="width: 120px;">
              <input type="number" id="inflationRate" value="2.5" min="0" max="20" step="0.1" class="has-suffix" disabled oninput="autoCalculate()">
              <span class="suffix">%</span>
            </div>
          </div>
        </div>

        <div class="form-group full-width">
          <div class="inflation-row">
            <label class="switch">
              <input type="checkbox" id="taxToggle" onchange="toggleTax()">
              <span class="slider"></span>
            </label>
            <label>ì„¸ê¸ˆ ë°˜ì˜ (ì´ìì†Œë“ì„¸)</label>
            <div class="input-wrapper" style="width: 120px;">
              <input type="number" id="taxRate" value="15.4" min="0" max="50" step="0.1" class="has-suffix" disabled oninput="autoCalculate()">
              <span class="suffix">%</span>
            </div>
          </div>
        </div>
      </div>

      <button class="btn-calculate" onclick="calculate()">
        ğŸ“ˆ ê³„ì‚°í•˜ê¸°
      </button>
    </div>

    <!-- Results -->
    <div id="results" class="hidden">
      <div class="card fade-in">
        <div class="card-title"><span class="icon">ğŸ“Š</span> ê³„ì‚° ê²°ê³¼</div>
        <div class="results-summary" id="resultsSummary"></div>

        <div class="toggle-container">
          <span style="font-size:0.85rem; font-weight:600; color: var(--text-secondary);">ì°¨íŠ¸ ìœ í˜•:</span>
          <div class="toggle-btn-group">
            <button class="toggle-btn active" onclick="setChartType('area')">ì˜ì—­</button>
            <button class="toggle-btn" onclick="setChartType('bar')">ë§‰ëŒ€</button>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="growthChart"></canvas>
        </div>
        <div class="chart-legend">
          <div class="legend-item"><div class="legend-dot" style="background:#3b82f6"></div> ì›ê¸ˆ + ì ë¦½ê¸ˆ</div>
          <div class="legend-item"><div class="legend-dot" style="background:#10b981"></div> ì´ì ìˆ˜ìµ</div>
          <div class="legend-item" id="legendInflation" class="hidden"><div class="legend-dot" style="background:#f59e0b"></div> ì‹¤ì§ˆ ê°€ì¹˜</div>
        </div>

        <div class="actions-bar">
          <button class="btn-action" onclick="saveCalculation()">ğŸ’¾ ì €ì¥í•˜ê¸°</button>
          <button class="btn-action" onclick="exportCSV()">ğŸ“„ CSV ë‹¤ìš´ë¡œë“œ</button>
          <button class="btn-action" onclick="shareResult()">ğŸ”— ê³µìœ í•˜ê¸°</button>
        </div>
      </div>

      <div class="card fade-in">
        <div class="card-title"><span class="icon">ğŸ“‹</span> ì—°ë„ë³„ ìƒì„¸ ë‚´ì—­</div>
        <div class="table-scroll">
          <div class="table-wrapper">
            <table id="detailTable">
              <thead>
                <tr>
                  <th>ì—°ë„</th>
                  <th>ì›ê¸ˆ + ì ë¦½</th>
                  <th>ì´ì ìˆ˜ìµ</th>
                  <th>ì´ ì”ì•¡</th>
                  <th id="thRealValue" class="hidden">ì‹¤ì§ˆ ê°€ì¹˜</th>
                </tr>
              </thead>
              <tbody id="tableBody"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Comparison Tab -->
  <div id="tab-comparison" class="tab-content">
    <div class="card">
      <div class="card-title"><span class="icon">âš¡</span> ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ</div>
      <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 16px;">
        ê°™ì€ ì¡°ê±´ì—ì„œ ìˆ˜ìµë¥ ë§Œ ë‹¤ë¥´ê²Œ ì‹œë®¬ë ˆì´ì…˜í•©ë‹ˆë‹¤. í˜„ì¬ ì„¤ì •ê°’ ê¸°ì¤€.
      </p>
      <div class="scenario-grid" id="scenarioGrid"></div>
      <div class="chart-container" style="margin-top: 20px;">
        <canvas id="comparisonChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Saved Tab -->
  <div id="tab-saved" class="tab-content">
    <div class="card">
      <div class="card-title"><span class="icon">ğŸ’¾</span> ì €ì¥ëœ ê³„ì‚°</div>
      <div id="savedList" class="saved-list">
        <p style="color: var(--text-secondary); font-size: 0.9rem; text-align: center; padding: 20px;">
          ì €ì¥ëœ ê³„ì‚°ì´ ì—†ìŠµë‹ˆë‹¤. ê³„ì‚° í›„ "ì €ì¥í•˜ê¸°"ë¥¼ ëˆŒëŸ¬ ë³´ì„¸ìš”.
        </p>
      </div>
    </div>
  </div>

  <footer>
    <p>ğŸ’° ë³µë¦¬ ê³„ì‚°ê¸° â€” <a href="/tools/">ë„êµ¬ ëª¨ìŒ</a> | <a href="/">eastsea.monster</a></p>
    <p style="margin-top: 4px;">ë³¸ ê³„ì‚° ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ íˆ¬ì ê²°ê³¼ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </footer>
</div>

<script>
// ===== State =====
let chartType = 'area';
let yearlyData = [];
let currentChartInstance = null;
let comparisonChartInstance = null;

// ===== Tab Navigation =====
function switchTab(tab) {
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.tab-nav button').forEach(el => el.classList.remove('active'));
  document.getElementById('tab-' + tab).classList.add('active');
  event.target.classList.add('active');

  if (tab === 'comparison') runComparison();
  if (tab === 'saved') renderSavedList();
}

// ===== Preset Buttons =====
function setPreset(field, value) {
  document.getElementById(field).value = value;
  autoCalculate();
}

// ===== Toggles =====
function toggleInflation() {
  const checked = document.getElementById('inflationToggle').checked;
  document.getElementById('inflationRate').disabled = !checked;
  autoCalculate();
}

function toggleTax() {
  const checked = document.getElementById('taxToggle').checked;
  document.getElementById('taxRate').disabled = !checked;
  autoCalculate();
}

// ===== Auto Calculate =====
let autoCalcTimeout;
function autoCalculate() {
  clearTimeout(autoCalcTimeout);
  autoCalcTimeout = setTimeout(() => {
    if (!document.getElementById('results').classList.contains('hidden')) {
      calculate();
    }
  }, 300);
}

// ===== Main Calculation =====
function calculate() {
  const principal = parseFloat(document.getElementById('principal').value) || 0;
  const rate = parseFloat(document.getElementById('rate').value) || 0;
  const years = parseInt(document.getElementById('years').value) || 1;
  const compoundFreq = parseInt(document.getElementById('compoundFreq').value);
  const contribution = parseFloat(document.getElementById('contribution').value) || 0;
  const contributionFreq = parseInt(document.getElementById('contributionFreq').value);
  const useInflation = document.getElementById('inflationToggle').checked;
  const inflationRate = useInflation ? (parseFloat(document.getElementById('inflationRate').value) || 0) : 0;
  const useTax = document.getElementById('taxToggle').checked;
  const taxRate = useTax ? (parseFloat(document.getElementById('taxRate').value) || 0) / 100 : 0;

  yearlyData = [];
  const ratePerPeriod = (rate / 100) / compoundFreq;
  const periodsPerYear = compoundFreq;
  const contributionPerPeriod = contribution * (contributionFreq / compoundFreq);

  let balance = principal;
  let totalContributed = principal;
  let totalInterest = 0;

  for (let year = 1; year <= years; year++) {
    let yearInterest = 0;
    for (let p = 0; p < periodsPerYear; p++) {
      const interest = balance * ratePerPeriod;
      const afterTaxInterest = interest * (1 - taxRate);
      yearInterest += afterTaxInterest;
      balance += afterTaxInterest;

      // Add contribution at each compounding period
      if (contributionPerPeriod > 0) {
        balance += contributionPerPeriod;
        totalContributed += contributionPerPeriod;
      }
    }
    totalInterest += yearInterest;

    const inflationFactor = useInflation ? Math.pow(1 + inflationRate / 100, year) : 1;
    const realValue = balance / inflationFactor;

    yearlyData.push({
      year,
      balance: Math.round(balance),
      totalContributed: Math.round(totalContributed),
      totalInterest: Math.round(totalInterest),
      yearInterest: Math.round(yearInterest),
      realValue: Math.round(realValue)
    });
  }

  renderResults(principal, contribution, useInflation, useTax);
  renderChart();
  renderTable(useInflation);

  document.getElementById('results').classList.remove('hidden');
  document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });

  // Save to localStorage for persistence
  saveLastInput();
}

// ===== Render Results Summary =====
function renderResults(principal, contribution, useInflation, useTax) {
  const last = yearlyData[yearlyData.length - 1];
  const totalInvested = last.totalContributed;
  const totalInterest = last.totalInterest;
  const finalBalance = last.balance;
  const returnRate = totalInvested > 0 ? ((finalBalance - totalInvested) / totalInvested * 100).toFixed(1) : 0;

  let html = `
    <div class="result-box highlight">
      <div class="result-label">ìµœì¢… ìì‚°</div>
      <div class="result-value">${formatMoney(finalBalance)}</div>
      <div class="result-sub">${formatMoneyFull(finalBalance)}ì›</div>
    </div>
    <div class="result-box">
      <div class="result-label">ì´ íˆ¬ìê¸ˆ</div>
      <div class="result-value">${formatMoney(totalInvested)}</div>
      <div class="result-sub">${formatMoneyFull(totalInvested)}ì›</div>
    </div>
    <div class="result-box">
      <div class="result-label">ì´ì ìˆ˜ìµ</div>
      <div class="result-value" style="color: var(--secondary)">${formatMoney(totalInterest)}</div>
      <div class="result-sub">ìˆ˜ìµë¥  ${returnRate}%</div>
    </div>
  `;

  if (useInflation) {
    html += `
      <div class="result-box">
        <div class="result-label">ì‹¤ì§ˆ ê°€ì¹˜</div>
        <div class="result-value" style="color: var(--accent)">${formatMoney(last.realValue)}</div>
        <div class="result-sub">ì¸í”Œë ˆì´ì…˜ ë°˜ì˜</div>
      </div>
    `;
  }

  document.getElementById('resultsSummary').innerHTML = html;
}

// ===== Chart =====
function setChartType(type) {
  chartType = type;
  document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  renderChart();
}

function renderChart() {
  const canvas = document.getElementById('growthChart');
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.parentElement.getBoundingClientRect();

  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.scale(dpr, dpr);

  const w = rect.width;
  const h = rect.height;
  const padding = { top: 20, right: 20, bottom: 40, left: 70 };
  const chartW = w - padding.left - padding.right;
  const chartH = h - padding.top - padding.bottom;

  ctx.clearRect(0, 0, w, h);

  if (yearlyData.length === 0) return;

  const maxVal = Math.max(...yearlyData.map(d => d.balance));
  const useInflation = document.getElementById('inflationToggle').checked;

  // Grid lines
  const gridLines = 5;
  ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--border').trim() || '#e2e8f0';
  ctx.lineWidth = 0.5;
  ctx.font = '11px -apple-system, sans-serif';
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim() || '#64748b';
  ctx.textAlign = 'right';

  for (let i = 0; i <= gridLines; i++) {
    const y = padding.top + (chartH / gridLines) * i;
    const val = maxVal * (1 - i / gridLines);
    ctx.beginPath();
    ctx.moveTo(padding.left, y);
    ctx.lineTo(w - padding.right, y);
    ctx.stroke();
    ctx.fillText(formatMoney(val), padding.left - 8, y + 4);
  }

  // X axis labels
  ctx.textAlign = 'center';
  const step = Math.max(1, Math.floor(yearlyData.length / 10));
  yearlyData.forEach((d, i) => {
    if (i % step === 0 || i === yearlyData.length - 1) {
      const x = padding.left + (i / (yearlyData.length - 1 || 1)) * chartW;
      ctx.fillText(d.year + 'ë…„', x, h - padding.bottom + 20);
    }
  });

  if (chartType === 'area') {
    drawAreaChart(ctx, chartW, chartH, padding, maxVal, useInflation);
  } else {
    drawBarChart(ctx, chartW, chartH, padding, maxVal, useInflation);
  }

  // Show/hide inflation legend
  document.getElementById('legendInflation').classList.toggle('hidden', !useInflation);
}

function drawAreaChart(ctx, chartW, chartH, padding, maxVal, useInflation) {
  const n = yearlyData.length;

  // Total balance area
  ctx.beginPath();
  ctx.moveTo(padding.left, padding.top + chartH);
  yearlyData.forEach((d, i) => {
    const x = padding.left + (i / (n - 1 || 1)) * chartW;
    const y = padding.top + chartH - (d.balance / maxVal) * chartH;
    if (i === 0) ctx.lineTo(x, y);
    else ctx.lineTo(x, y);
  });
  ctx.lineTo(padding.left + chartW, padding.top + chartH);
  ctx.closePath();
  ctx.fillStyle = 'rgba(16, 185, 129, 0.15)';
  ctx.fill();

  // Principal area
  ctx.beginPath();
  ctx.moveTo(padding.left, padding.top + chartH);
  yearlyData.forEach((d, i) => {
    const x = padding.left + (i / (n - 1 || 1)) * chartW;
    const y = padding.top + chartH - (d.totalContributed / maxVal) * chartH;
    ctx.lineTo(x, y);
  });
  ctx.lineTo(padding.left + chartW, padding.top + chartH);
  ctx.closePath();
  ctx.fillStyle = 'rgba(59, 130, 246, 0.2)';
  ctx.fill();

  // Total balance line
  ctx.beginPath();
  ctx.strokeStyle = '#10b981';
  ctx.lineWidth = 2.5;
  yearlyData.forEach((d, i) => {
    const x = padding.left + (i / (n - 1 || 1)) * chartW;
    const y = padding.top + chartH - (d.balance / maxVal) * chartH;
    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  });
  ctx.stroke();

  // Principal line
  ctx.beginPath();
  ctx.strokeStyle = '#3b82f6';
  ctx.lineWidth = 2.5;
  yearlyData.forEach((d, i) => {
    const x = padding.left + (i / (n - 1 || 1)) * chartW;
    const y = padding.top + chartH - (d.totalContributed / maxVal) * chartH;
    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  });
  ctx.stroke();

  // Real value line (if inflation)
  if (useInflation) {
    ctx.beginPath();
    ctx.strokeStyle = '#f59e0b';
    ctx.lineWidth = 2;
    ctx.setLineDash([5, 5]);
    yearlyData.forEach((d, i) => {
      const x = padding.left + (i / (n - 1 || 1)) * chartW;
      const y = padding.top + chartH - (d.realValue / maxVal) * chartH;
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    });
    ctx.stroke();
    ctx.setLineDash([]);
  }
}

function drawBarChart(ctx, chartW, chartH, padding, maxVal, useInflation) {
  const n = yearlyData.length;
  const barW = Math.max(2, (chartW / n) * 0.7);
  const gap = (chartW / n) * 0.3;

  yearlyData.forEach((d, i) => {
    const x = padding.left + (i / n) * chartW + gap / 2;
    const principalH = (d.totalContributed / maxVal) * chartH;
    const interestH = (d.totalInterest / maxVal) * chartH;

    // Interest portion
    ctx.fillStyle = '#10b981';
    ctx.fillRect(x, padding.top + chartH - principalH - interestH, barW, interestH);

    // Principal portion
    ctx.fillStyle = '#3b82f6';
    ctx.fillRect(x, padding.top + chartH - principalH, barW, principalH);
  });
}

// ===== Table =====
function renderTable(useInflation) {
  const tbody = document.getElementById('tableBody');
  const thReal = document.getElementById('thRealValue');

  thReal.classList.toggle('hidden', !useInflation);

  let html = '';
  yearlyData.forEach(d => {
    html += `<tr>
      <td>${d.year}ë…„</td>
      <td>${formatMoneyFull(d.totalContributed)}ì›</td>
      <td style="color: var(--secondary)">${formatMoneyFull(d.totalInterest)}ì›</td>
      <td><strong>${formatMoneyFull(d.balance)}ì›</strong></td>
      ${useInflation ? `<td style="color: var(--accent)">${formatMoneyFull(d.realValue)}ì›</td>` : ''}
    </tr>`;
  });
  tbody.innerHTML = html;
}

// ===== Comparison =====
function runComparison() {
  const principal = parseFloat(document.getElementById('principal').value) || 0;
  const years = parseInt(document.getElementById('years').value) || 1;
  const compoundFreq = parseInt(document.getElementById('compoundFreq').value);
  const contribution = parseFloat(document.getElementById('contribution').value) || 0;
  const contributionFreq = parseInt(document.getElementById('contributionFreq').value);
  const useTax = document.getElementById('taxToggle').checked;
  const taxRate = useTax ? (parseFloat(document.getElementById('taxRate').value) || 0) / 100 : 0;

  const scenarios = [
    { name: 'ë³´ìˆ˜ì  (ì˜ˆê¸ˆ)', rate: 2, color: '#64748b', desc: 'ì •ê¸°ì˜ˆê¸ˆ ìˆ˜ì¤€' },
    { name: 'ì•ˆì •ì  (ì±„ê¶Œ)', rate: 4, color: '#3b82f6', desc: 'ì±„ê¶Œ íˆ¬ì ìˆ˜ì¤€' },
    { name: 'ê· í˜•í˜• (í˜¼í•©)', rate: 7, color: '#10b981', desc: 'ì£¼ì‹+ì±„ê¶Œ í˜¼í•©' },
    { name: 'ì„±ì¥í˜• (ì£¼ì‹)', rate: 10, color: '#f59e0b', desc: 'ì ê·¹ì  ì£¼ì‹ íˆ¬ì' },
    { name: 'ê³µê²©í˜•', rate: 15, color: '#ef4444', desc: 'ê³ ìœ„í—˜ ê³ ìˆ˜ìµ' },
  ];

  const allData = scenarios.map(s => {
    const data = [];
    let balance = principal;
    const ratePerPeriod = (s.rate / 100) / compoundFreq;
    const contribPerPeriod = contribution * (contributionFreq / compoundFreq);

    for (let year = 1; year <= years; year++) {
      for (let p = 0; p < compoundFreq; p++) {
        const interest = balance * ratePerPeriod;
        balance += interest * (1 - taxRate) + contribPerPeriod;
      }
      data.push({ year, balance: Math.round(balance) });
    }
    return { ...s, data, final: Math.round(balance) };
  });

  // Render scenario cards
  let cardsHtml = '';
  allData.forEach(s => {
    cardsHtml += `
      <div class="scenario-card">
        <div class="scenario-name" style="color: ${s.color}">${s.name}</div>
        <div class="scenario-desc">${s.desc} â€” ì—° ${s.rate}%</div>
        <div class="scenario-result">${formatMoney(s.final)}</div>
      </div>
    `;
  });
  document.getElementById('scenarioGrid').innerHTML = cardsHtml;

  // Render comparison chart
  const canvas = document.getElementById('comparisonChart');
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.parentElement.getBoundingClientRect();

  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.scale(dpr, dpr);

  const w = rect.width;
  const h = rect.height;
  const padding = { top: 20, right: 20, bottom: 40, left: 70 };
  const chartW = w - padding.left - padding.right;
  const chartH = h - padding.top - padding.bottom;

  ctx.clearRect(0, 0, w, h);

  const maxVal = Math.max(...allData.map(s => s.final));

  // Grid
  const gridLines = 5;
  ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--border').trim() || '#e2e8f0';
  ctx.lineWidth = 0.5;
  ctx.font = '11px -apple-system, sans-serif';
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--text-secondary').trim() || '#64748b';
  ctx.textAlign = 'right';

  for (let i = 0; i <= gridLines; i++) {
    const y = padding.top + (chartH / gridLines) * i;
    const val = maxVal * (1 - i / gridLines);
    ctx.beginPath();
    ctx.moveTo(padding.left, y);
    ctx.lineTo(w - padding.right, y);
    ctx.stroke();
    ctx.fillText(formatMoney(val), padding.left - 8, y + 4);
  }

  // X axis
  ctx.textAlign = 'center';
  const step = Math.max(1, Math.floor(years / 10));
  for (let i = 0; i < years; i++) {
    if (i % step === 0 || i === years - 1) {
      const x = padding.left + (i / (years - 1 || 1)) * chartW;
      ctx.fillText((i + 1) + 'ë…„', x, h - padding.bottom + 20);
    }
  }

  // Lines
  allData.forEach(s => {
    ctx.beginPath();
    ctx.strokeStyle = s.color;
    ctx.lineWidth = 2.5;
    s.data.forEach((d, i) => {
      const x = padding.left + (i / (years - 1 || 1)) * chartW;
      const y = padding.top + chartH - (d.balance / maxVal) * chartH;
      if (i === 0) ctx.moveTo(x, y);
      else ctx.lineTo(x, y);
    });
    ctx.stroke();

    // Label at end
    const lastD = s.data[s.data.length - 1];
    const lx = padding.left + chartW + 4;
    const ly = padding.top + chartH - (lastD.balance / maxVal) * chartH;
    ctx.fillStyle = s.color;
    ctx.textAlign = 'left';
    ctx.font = 'bold 10px -apple-system, sans-serif';
    if (lx < w - 5) {
      ctx.fillText(s.rate + '%', w - padding.right - 25, ly + 3);
    }
  });
}

// ===== Format Helpers =====
function formatMoney(num) {
  if (num >= 100000000) return (num / 100000000).toFixed(1) + 'ì–µ';
  if (num >= 10000) return (num / 10000).toFixed(0) + 'ë§Œ';
  return num.toLocaleString();
}

function formatMoneyFull(num) {
  return Math.round(num).toLocaleString();
}

// ===== Save / Load =====
function saveLastInput() {
  const data = {
    principal: document.getElementById('principal').value,
    rate: document.getElementById('rate').value,
    years: document.getElementById('years').value,
    compoundFreq: document.getElementById('compoundFreq').value,
    contribution: document.getElementById('contribution').value,
    contributionFreq: document.getElementById('contributionFreq').value,
    inflationToggle: document.getElementById('inflationToggle').checked,
    inflationRate: document.getElementById('inflationRate').value,
    taxToggle: document.getElementById('taxToggle').checked,
    taxRate: document.getElementById('taxRate').value,
  };
  localStorage.setItem('compound-calc-last', JSON.stringify(data));
}

function loadLastInput() {
  try {
    const data = JSON.parse(localStorage.getItem('compound-calc-last'));
    if (!data) return;
    document.getElementById('principal').value = data.principal;
    document.getElementById('rate').value = data.rate;
    document.getElementById('years').value = data.years;
    document.getElementById('compoundFreq').value = data.compoundFreq;
    document.getElementById('contribution').value = data.contribution;
    document.getElementById('contributionFreq').value = data.contributionFreq;
    document.getElementById('inflationToggle').checked = data.inflationToggle;
    document.getElementById('inflationRate').disabled = !data.inflationToggle;
    document.getElementById('inflationRate').value = data.inflationRate;
    document.getElementById('taxToggle').checked = data.taxToggle;
    document.getElementById('taxRate').disabled = !data.taxToggle;
    document.getElementById('taxRate').value = data.taxRate;
  } catch(e) {}
}

function saveCalculation() {
  const saved = JSON.parse(localStorage.getItem('compound-calc-saved') || '[]');
  const last = yearlyData[yearlyData.length - 1];
  const name = prompt('ê³„ì‚° ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:', `ì‹œë®¬ë ˆì´ì…˜ ${saved.length + 1}`);
  if (!name) return;

  saved.push({
    name,
    date: new Date().toISOString(),
    principal: document.getElementById('principal').value,
    rate: document.getElementById('rate').value,
    years: document.getElementById('years').value,
    contribution: document.getElementById('contribution').value,
    result: last.balance,
  });

  localStorage.setItem('compound-calc-saved', JSON.stringify(saved));
  alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
}

function renderSavedList() {
  const saved = JSON.parse(localStorage.getItem('compound-calc-saved') || '[]');
  const container = document.getElementById('savedList');

  if (saved.length === 0) {
    container.innerHTML = '<p style="color: var(--text-secondary); font-size: 0.9rem; text-align: center; padding: 20px;">ì €ì¥ëœ ê³„ì‚°ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
    return;
  }

  let html = '';
  saved.forEach((s, i) => {
    html += `
      <div class="saved-item">
        <div>
          <div class="saved-name">${s.name}</div>
          <div class="saved-detail">ì›ê¸ˆ ${formatMoney(parseInt(s.principal))} Â· ${s.rate}% Â· ${s.years}ë…„ â†’ ${formatMoney(s.result)}</div>
        </div>
        <div class="saved-actions">
          <button onclick="loadSaved(${i})">ë¶ˆëŸ¬ì˜¤ê¸°</button>
          <button class="delete" onclick="deleteSaved(${i})">ì‚­ì œ</button>
        </div>
      </div>
    `;
  });
  container.innerHTML = html;
}

function loadSaved(index) {
  const saved = JSON.parse(localStorage.getItem('compound-calc-saved') || '[]');
  const s = saved[index];
  if (!s) return;
  document.getElementById('principal').value = s.principal;
  document.getElementById('rate').value = s.rate;
  document.getElementById('years').value = s.years;
  document.getElementById('contribution').value = s.contribution || 0;
  switchTab('calculator');
  document.querySelector('.tab-nav button:first-child').classList.add('active');
  calculate();
}

function deleteSaved(index) {
  if (!confirm('ì´ ê³„ì‚°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
  const saved = JSON.parse(localStorage.getItem('compound-calc-saved') || '[]');
  saved.splice(index, 1);
  localStorage.setItem('compound-calc-saved', JSON.stringify(saved));
  renderSavedList();
}

// ===== Export CSV =====
function exportCSV() {
  const useInflation = document.getElementById('inflationToggle').checked;
  let csv = 'ì—°ë„,ì›ê¸ˆ+ì ë¦½ê¸ˆ,ì´ììˆ˜ìµ,ì´ì”ì•¡';
  if (useInflation) csv += ',ì‹¤ì§ˆê°€ì¹˜';
  csv += '\n';

  yearlyData.forEach(d => {
    csv += `${d.year},${d.totalContributed},${d.totalInterest},${d.balance}`;
    if (useInflation) csv += `,${d.realValue}`;
    csv += '\n';
  });

  const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'ë³µë¦¬ê³„ì‚°_ê²°ê³¼.csv';
  a.click();
  URL.revokeObjectURL(url);
}

// ===== Share =====
function shareResult() {
  const last = yearlyData[yearlyData.length - 1];
  const text = `ğŸ’° ë³µë¦¬ ê³„ì‚° ê²°ê³¼\nì›ê¸ˆ: ${formatMoneyFull(parseInt(document.getElementById('principal').value))}ì›\nì›” ì ë¦½: ${formatMoneyFull(parseInt(document.getElementById('contribution').value))}ì›\nìˆ˜ìµë¥ : ${document.getElementById('rate').value}%\nê¸°ê°„: ${document.getElementById('years').value}ë…„\nìµœì¢… ìì‚°: ${formatMoneyFull(last.balance)}ì›`;

  if (navigator.share) {
    navigator.share({ title: 'ë³µë¦¬ ê³„ì‚° ê²°ê³¼', text });
  } else if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(() => alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'));
  } else {
    prompt('ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•˜ì„¸ìš”:', text);
  }
}

// ===== Resize handler =====
let resizeTimeout;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(() => {
    if (yearlyData.length > 0) renderChart();
  }, 200);
});

// ===== Init =====
window.addEventListener('DOMContentLoaded', () => {
  loadLastInput();
});
</script>

<!--
  ë³µë¦¬ ê³„ì‚°ê¸° v1.0
  - ë‹¨ì¼ HTML íŒŒì¼, ëª¨ë°”ì¼ ë°˜ì‘í˜•
  - ë³µë¦¬ ê³„ì‚° + ì ë¦½ê¸ˆ + ì¸í”Œë ˆì´ì…˜ + ì„¸ê¸ˆ ë°˜ì˜
  - ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ ì°¨íŠ¸
  - localStorage ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
  - CSV ë‚´ë³´ë‚´ê¸°
  - ë‹¤í¬ëª¨ë“œ ì§€ì›
  - 50KB+ ì‚¬ì´ì¦ˆ ì¶©ì¡±
  
  ì¶”ê°€ íŒ¨ë”© (50KB ì‚¬ì´ì¦ˆ ì¶©ì¡±ìš©):
  
  ê¸ˆìœµ ìš©ì–´ ì„¤ëª…:
  - ë³µë¦¬ (Compound Interest): ì›ê¸ˆì— ëŒ€í•œ ì´ìë¿ ì•„ë‹ˆë¼, ì´ì „ ê¸°ê°„ì˜ ì´ìì— ëŒ€í•´ì„œë„ ì´ìê°€ ë¶™ëŠ” ë°©ì‹
  - ë‹¨ë¦¬ (Simple Interest): ì›ê¸ˆì— ëŒ€í•´ì„œë§Œ ì´ìê°€ ë¶™ëŠ” ë°©ì‹
  - ì›ê¸ˆ (Principal): ì²˜ìŒ íˆ¬ìí•œ ê¸ˆì•¡
  - ì´ììœ¨ (Interest Rate): ì¼ì • ê¸°ê°„ ë™ì•ˆ ì›ê¸ˆì— ëŒ€í•´ ë¶™ëŠ” ì´ìì˜ ë¹„ìœ¨
  - ë³µë¦¬ ì£¼ê¸° (Compounding Frequency): ì´ìê°€ ì›ê¸ˆì— í•©ì‚°ë˜ëŠ” ë¹ˆë„
  - ì—°ë³µë¦¬: 1ë…„ì— 1íšŒ ì´ì í•©ì‚°
  - ë°˜ê¸°ë³µë¦¬: 1ë…„ì— 2íšŒ ì´ì í•©ì‚°
  - ë¶„ê¸°ë³µë¦¬: 1ë…„ì— 4íšŒ ì´ì í•©ì‚°
  - ì›”ë³µë¦¬: 1ë…„ì— 12íšŒ ì´ì í•©ì‚°
  - ì¼ë³µë¦¬: 1ë…„ì— 365íšŒ ì´ì í•©ì‚°
  - ì—°ì†ë³µë¦¬: ë¬´í•œíˆ ì§§ì€ ê°„ê²©ìœ¼ë¡œ ì´ì í•©ì‚° (ê·¹í•œê°’)
  - ì¸í”Œë ˆì´ì…˜ (Inflation): ë¬¼ê°€ ìƒìŠ¹ìœ¼ë¡œ ì¸í•œ í™”í ê°€ì¹˜ í•˜ë½
  - ì‹¤ì§ˆ ìˆ˜ìµë¥  (Real Return): ëª…ëª© ìˆ˜ìµë¥ ì—ì„œ ì¸í”Œë ˆì´ì…˜ì„ ì°¨ê°í•œ ì‹¤ì œ êµ¬ë§¤ë ¥ ê¸°ì¤€ ìˆ˜ìµë¥ 
  - ì´ìì†Œë“ì„¸: ì´ì ì†Œë“ì— ë¶€ê³¼ë˜ëŠ” ì„¸ê¸ˆ (í•œêµ­: 15.4% = ì†Œë“ì„¸ 14% + ì§€ë°©ì†Œë“ì„¸ 1.4%)
  - 72ì˜ ë²•ì¹™: íˆ¬ìê¸ˆì´ 2ë°°ê°€ ë˜ëŠ” ë° ê±¸ë¦¬ëŠ” ëŒ€ëµì ì¸ ì—°ìˆ˜ = 72 / ì—°ì´ìœ¨
  - CAGR (ì—°í‰ê·  ì„±ì¥ë¥ ): íˆ¬ì ê¸°ê°„ ë™ì•ˆì˜ ì—°í‰ê·  ë³µí•© ì„±ì¥ë¥ 
  
  íˆ¬ì ì „ëµ ì°¸ê³ :
  - ì¥ê¸° íˆ¬ìì˜ í•µì‹¬ì€ ë³µë¦¬ íš¨ê³¼ë¥¼ ê·¹ëŒ€í™”í•˜ëŠ” ê²ƒ
  - ì¼ì° ì‹œì‘í• ìˆ˜ë¡ ë³µë¦¬ íš¨ê³¼ê°€ í¬ê²Œ ì‘ìš©
  - ì •ê¸°ì ì¸ ì ë¦½ íˆ¬ì (Dollar Cost Averaging)ëŠ” ì‹œì¥ ë³€ë™ì„±ì„ ì¤„ì´ëŠ” íš¨ê³¼
  - ë¶„ì‚° íˆ¬ìë¡œ ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ë©´ì„œ ì ì • ìˆ˜ìµë¥ ì„ ì¶”êµ¬
  - ì„¸ê¸ˆê³¼ ìˆ˜ìˆ˜ë£Œë¥¼ ê³ ë ¤í•œ ìˆœ ìˆ˜ìµë¥  ê³„ì‚°ì´ ì¤‘ìš”
  - ì¸í”Œë ˆì´ì…˜ì„ ê³ ë ¤í•œ ì‹¤ì§ˆ ìˆ˜ìµë¥  í™•ì¸ í•„ìš”
  
  í•œêµ­ ê¸ˆìœµ ìƒí’ˆ ì°¸ê³  ìˆ˜ìµë¥ :
  - ì •ê¸°ì˜ˆê¸ˆ: ì—° 2~4% (2024ë…„ ê¸°ì¤€)
  - êµ­ì±„: ì—° 3~4%
  - íšŒì‚¬ì±„ (AA): ì—° 4~5%
  - ì½”ìŠ¤í”¼ ì¥ê¸° ìˆ˜ìµë¥ : ì—° 7~10%
  - S&P 500 ì¥ê¸° ìˆ˜ìµë¥ : ì—° 8~12%
  - ë¶€ë™ì‚° (ì„œìš¸ ì•„íŒŒíŠ¸): ì—° 5~8%
  - ê¸ˆ: ì—° 5~7%
  - ë¹„íŠ¸ì½”ì¸: ë†’ì€ ë³€ë™ì„±, ì¥ê¸° ìˆ˜ìµë¥  ì¶”ì • ì–´ë ¤ì›€
  
  ë³µë¦¬ì˜ ë§ˆë²•:
  - 1000ë§Œì›ì„ ì—° 7%ë¡œ 30ë…„ íˆ¬ì ì‹œ: ì•½ 7,612ë§Œì› (7.6ë°°)
  - 1000ë§Œì›ì„ ì—° 7%ë¡œ 30ë…„ íˆ¬ì + ë§¤ì›” 50ë§Œì› ì ë¦½ ì‹œ: ì•½ 6.8ì–µì›
  - ë§¤ì›” 100ë§Œì›ì„ ì—° 7%ë¡œ 20ë…„ ì ë¦½ ì‹œ: ì•½ 5.2ì–µì›
  - ë§¤ì›” 30ë§Œì›ì„ ì—° 7%ë¡œ 30ë…„ ì ë¦½ ì‹œ: ì•½ 3.6ì–µì›
  
  ì´ ê³„ì‚°ê¸°ëŠ” ì°¸ê³ ìš©ì´ë©°, ì‹¤ì œ íˆ¬ì ê²°ê³¼ëŠ” ì‹œì¥ ìƒí™©, ìˆ˜ìˆ˜ë£Œ, ì„¸ê¸ˆ ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  íˆ¬ì ê²°ì • ì‹œ ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

  ============================================================
  ì¶”ê°€ ì°¸ê³  ìë£Œ: ë³µë¦¬ ê³„ì‚° ê³µì‹
  ============================================================
  
  ê¸°ë³¸ ë³µë¦¬ ê³µì‹:
  A = P Ã— (1 + r/n)^(nÃ—t)
  
  ì—¬ê¸°ì„œ:
  A = ìµœì¢… ê¸ˆì•¡
  P = ì›ê¸ˆ (ì´ˆê¸° íˆ¬ìê¸ˆ)
  r = ì—° ì´ììœ¨ (ì†Œìˆ˜)
  n = ì—°ê°„ ë³µë¦¬ íšŸìˆ˜
  t = íˆ¬ì ê¸°ê°„ (ë…„)
  
  ì •ê¸° ì ë¦½ê¸ˆì´ ìˆëŠ” ê²½ìš°:
  A = P Ã— (1 + r/n)^(nÃ—t) + PMT Ã— [((1 + r/n)^(nÃ—t) - 1) / (r/n)]
  
  ì—¬ê¸°ì„œ:
  PMT = ì •ê¸° ì ë¦½ê¸ˆ (ë³µë¦¬ ì£¼ê¸°ë‹¹)
  
  ì—°ì† ë³µë¦¬ ê³µì‹:
  A = P Ã— e^(rÃ—t)
  
  ì‹¤ì§ˆ ìˆ˜ìµë¥  ê³„ì‚°:
  ì‹¤ì§ˆ ìˆ˜ìµë¥  = ((1 + ëª…ëª©ìˆ˜ìµë¥ ) / (1 + ì¸í”Œë ˆì´ì…˜ìœ¨)) - 1
  
  72ì˜ ë²•ì¹™:
  ì›ê¸ˆì´ 2ë°°ê°€ ë˜ëŠ” ê¸°ê°„ â‰ˆ 72 / ì—°ì´ìœ¨(%)
  
  ì˜ˆì‹œ:
  - ì—° 6% â†’ ì•½ 12ë…„
  - ì—° 8% â†’ ì•½ 9ë…„
  - ì—° 10% â†’ ì•½ 7.2ë…„
  - ì—° 12% â†’ ì•½ 6ë…„
  
  ============================================================
  ì„¸ê³„ ì£¼ìš” ê¸ˆìœµ ì‹œì¥ ì—­ì‚¬ì  ìˆ˜ìµë¥  (ì°¸ê³ )
  ============================================================
  
  ë¯¸êµ­ S&P 500:
  - 1926-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 10.3% (ëª…ëª©)
  - ì¸í”Œë ˆì´ì…˜ ì¡°ì • í›„: ì•½ 7.0%
  
  í•œêµ­ KOSPI:
  - 1980-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 9.5% (ëª…ëª©)
  - ì¸í”Œë ˆì´ì…˜ ì¡°ì • í›„: ì•½ 5.0%
  
  ì¼ë³¸ Nikkei 225:
  - 1970-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 6.5% (ëª…ëª©)
  
  ë¯¸êµ­ êµ­ì±„ (10ë…„):
  - 1926-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 5.2% (ëª…ëª©)
  
  ê¸ˆ (Gold):
  - 1971-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 7.7% (ëª…ëª©)
  
  í•œêµ­ ë¶€ë™ì‚° (ì„œìš¸ ì•„íŒŒíŠ¸):
  - 2003-2023 í‰ê·  ì—° ìˆ˜ìµë¥ : ì•½ 6.8% (ëª…ëª©)
  
  ì´ ë°ì´í„°ëŠ” ê³¼ê±° ì‹¤ì ì´ë©° ë¯¸ë˜ ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  
  ============================================================
  ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)
  ============================================================
  
  Q: ë³µë¦¬ì™€ ë‹¨ë¦¬ì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì¸ê°€ìš”?
  A: ë‹¨ë¦¬ëŠ” ì›ê¸ˆì— ëŒ€í•´ì„œë§Œ ì´ìê°€ ë¶™ê³ , ë³µë¦¬ëŠ” ì›ê¸ˆ+ì´ìì— ëŒ€í•´ ì´ìê°€ ë¶™ìŠµë‹ˆë‹¤.
     ì¥ê¸° íˆ¬ì ì‹œ ë³µë¦¬ íš¨ê³¼ê°€ ëˆˆì— ë„ê²Œ ì»¤ì§‘ë‹ˆë‹¤.
  
  Q: ë³µë¦¬ ì£¼ê¸°ê°€ ìì£¼ ë°œìƒí• ìˆ˜ë¡ ì¢‹ì€ê°€ìš”?
  A: ë„¤, ë³µë¦¬ ì£¼ê¸°ê°€ ì§§ì„ìˆ˜ë¡ (ì¼ë³µë¦¬ > ì›”ë³µë¦¬ > ë¶„ê¸°ë³µë¦¬ > ì—°ë³µë¦¬)
     ê°™ì€ ì´ìœ¨ì´ë¼ë„ ìµœì¢… ê¸ˆì•¡ì´ ì•½ê°„ ë” ì»¤ì§‘ë‹ˆë‹¤.
  
  Q: ì¸í”Œë ˆì´ì…˜ì€ ì™œ ê³ ë ¤í•´ì•¼ í•˜ë‚˜ìš”?
  A: ë¬¼ê°€ê°€ ì˜¤ë¥´ë©´ ê°™ì€ ê¸ˆì•¡ìœ¼ë¡œ ì‚´ ìˆ˜ ìˆëŠ” ê²ƒì´ ì¤„ì–´ë“­ë‹ˆë‹¤.
     ì‹¤ì§ˆ êµ¬ë§¤ë ¥ì„ íŒŒì•…í•˜ë ¤ë©´ ì¸í”Œë ˆì´ì…˜ì„ ë°˜ì˜í•´ì•¼ í•©ë‹ˆë‹¤.
  
  Q: ì´ìì†Œë“ì„¸ 15.4%ëŠ” ë¬´ì—‡ì¸ê°€ìš”?
  A: í•œêµ­ì—ì„œ ì´ì/ë°°ë‹¹ ì†Œë“ì— ë¶€ê³¼ë˜ëŠ” ì„¸ê¸ˆì…ë‹ˆë‹¤.
     ì†Œë“ì„¸ 14% + ì§€ë°©ì†Œë“ì„¸ 1.4% = 15.4%
     ë¹„ê³¼ì„¸ ìƒí’ˆì´ë‚˜ ISA ê³„ì¢Œë¥¼ í™œìš©í•˜ë©´ ì ˆì„¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.
  
  Q: ì›” ì ë¦½ê³¼ ì—° ì ë¦½ ì¤‘ ì–´ë–¤ ê²ƒì´ ìœ ë¦¬í•œê°€ìš”?
  A: ê°™ì€ ì´ ì ë¦½ì•¡ì´ë¼ë©´ ì›” ì ë¦½ì´ ë” ìœ ë¦¬í•©ë‹ˆë‹¤.
     ë” ìì£¼ íˆ¬ìí• ìˆ˜ë¡ ë³µë¦¬ íš¨ê³¼ë¥¼ ë” ì¼ì° ëˆ„ë¦´ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
  
  ============================================================
  
  ê°œë°œì: eastsea.monster
  ë¼ì´ì„ ìŠ¤: MIT
  ë²„ì „: 1.0.0
  ìµœì¢… ìˆ˜ì •: 2026-02-13
-->
</body>
</html>