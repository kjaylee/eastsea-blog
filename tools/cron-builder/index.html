<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cron Expression Builder - ÌÅ¨Î°† ÌëúÌòÑÏãù ÎπåÎçî</title>
    <style>
        :root {
            --bg: #0f172a;
            --surface: #1e293b;
            --border: #334155;
            --text: #f1f5f9;
            --text-dim: #94a3b8;
            --primary: #8b5cf6;
            --primary-hover: #7c3aed;
            --secondary: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --shadow: rgba(0, 0, 0, 0.3);
        }

        [data-theme="light"] {
            --bg: #f8fafc;
            --surface: #ffffff;
            --border: #e2e8f0;
            --text: #0f172a;
            --text-dim: #64748b;
            --primary: #7c3aed;
            --primary-hover: #6d28d9;
            --secondary: #0891b2;
            --success: #059669;
            --warning: #d97706;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, var(--bg) 0%, #1a2332 100%);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 40px;
        }

        .header {
            background: linear-gradient(135deg, var(--surface) 0%, var(--border) 100%);
            border-bottom: 1px solid var(--border);
            padding: 24px 20px;
            box-shadow: 0 4px 12px var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 14px;
            color: var(--text-dim);
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .toolbar {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px var(--shadow);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px var(--shadow);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-icon {
            padding: 10px;
            min-width: 44px;
            justify-content: center;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px var(--shadow);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: 0 8px 24px var(--shadow);
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .preset-btn {
            background: var(--surface);
            border: 2px solid var(--border);
            padding: 14px 16px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s ease;
            font-size: 13px;
        }

        .preset-btn:hover {
            border-color: var(--primary);
            background: var(--border);
            transform: translateY(-2px);
        }

        .preset-btn .title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .preset-btn .desc {
            color: var(--text-dim);
            font-size: 11px;
        }

        .fields-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .field-group {
            background: var(--border);
            padding: 16px;
            border-radius: 8px;
        }

        .field-label {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 14px;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .field-hint {
            font-size: 11px;
            color: var(--text-dim);
            font-weight: normal;
        }

        select, input {
            width: 100%;
            padding: 10px 12px;
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.2s ease;
        }

        select:focus, input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .output-section {
            background: linear-gradient(135deg, var(--primary), var(--primary-hover));
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 8px 24px var(--shadow);
        }

        .output-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .output-value {
            background: rgba(255, 255, 255, 0.15);
            padding: 16px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 2px;
            text-align: center;
            margin-bottom: 12px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .output-description {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 12px;
            backdrop-filter: blur(10px);
        }

        .output-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-white {
            background: white;
            color: var(--primary);
            border: none;
        }

        .btn-white:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        .schedule-list {
            list-style: none;
            padding: 0;
        }

        .schedule-item {
            background: var(--border);
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .schedule-item .index {
            background: var(--primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 12px;
            flex-shrink: 0;
        }

        .schedule-item .time {
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dim);
            border-bottom: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .tab:hover {
            color: var(--text);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .direct-input {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 16px;
        }

        .direct-input input {
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 18px;
            text-align: center;
            letter-spacing: 1px;
        }

        .help-text {
            background: var(--border);
            padding: 12px 16px;
            border-radius: 6px;
            font-size: 13px;
            color: var(--text-dim);
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .header {
                padding: 16px;
            }
            .header h1 {
                font-size: 20px;
            }
            .container {
                padding: 0 16px;
            }
            .fields-grid {
                grid-template-columns: 1fr;
            }
            .preset-grid {
                grid-template-columns: 1fr;
            }
            .output-value {
                font-size: 18px;
                letter-spacing: 1px;
            }
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--surface);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>‚è∞ Cron Expression Builder</h1>
            <p>ÏãúÍ∞ÅÏ†Å UIÎ°ú Cron ÌëúÌòÑÏãùÏùÑ ÏâΩÍ≤å ÏÉùÏÑ±ÌïòÍ≥† Îã§Ïùå Ïã§Ìñâ ÏãúÍ∞ÑÏùÑ ÎØ∏Î¶¨Î≥¥ÏÑ∏Ïöî</p>
        </div>
    </div>

    <div class="container">
        <div class="toolbar">
            <button class="btn btn-secondary" id="resetBtn">
                <span>üîÑ</span>
                <span>Reset</span>
            </button>
            <div style="flex: 1;"></div>
            <select id="langSelect" style="width: auto; padding: 8px 12px;">
                <option value="ko">üá∞üá∑ ÌïúÍµ≠Ïñ¥</option>
                <option value="en">üá∫üá∏ English</option>
            </select>
            <button class="btn btn-secondary btn-icon" id="themeBtn" title="Toggle theme">üåô</button>
        </div>

        <div class="card">
            <div class="card-title">üéØ Presets</div>
            <div class="preset-grid">
                <button class="preset-btn" onclick="applyPreset('* * * * *')">
                    <div class="title">Every minute</div>
                    <div class="desc">Îß§Î∂Ñ Ïã§Ìñâ</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 * * * *')">
                    <div class="title">Every hour</div>
                    <div class="desc">Îß§ÏãúÍ∞Ñ Ï†ïÍ∞Å</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 0 * * *')">
                    <div class="title">Daily at midnight</div>
                    <div class="desc">Îß§Ïùº ÏûêÏ†ï</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 9 * * *')">
                    <div class="title">Daily at 9 AM</div>
                    <div class="desc">Îß§Ïùº Ïò§Ï†Ñ 9Ïãú</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 0 * * 0')">
                    <div class="title">Weekly on Sunday</div>
                    <div class="desc">Îß§Ï£º ÏùºÏöîÏùº ÏûêÏ†ï</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 0 * * 1')">
                    <div class="title">Weekly on Monday</div>
                    <div class="desc">Îß§Ï£º ÏõîÏöîÏùº ÏûêÏ†ï</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 0 1 * *')">
                    <div class="title">Monthly on 1st</div>
                    <div class="desc">Îß§Ïõî 1Ïùº ÏûêÏ†ï</div>
                </button>
                <button class="preset-btn" onclick="applyPreset('0 0 1 1 *')">
                    <div class="title">Yearly on Jan 1st</div>
                    <div class="desc">Îß§ÎÖÑ 1Ïõî 1Ïùº</div>
                </button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('visual')">üé® Visual Builder</button>
            <button class="tab" onclick="switchTab('direct')">‚å®Ô∏è Direct Input</button>
        </div>

        <div id="visualTab" class="tab-content active">
            <div class="card">
                <div class="card-title">‚öôÔ∏è Configure Schedule</div>
                <div class="fields-grid">
                    <div class="field-group">
                        <div class="field-label">
                            Minute
                            <span class="field-hint">(0-59)</span>
                        </div>
                        <select id="minuteType" onchange="updateMinuteField()">
                            <option value="*">Every minute (*)</option>
                            <option value="specific">Specific minute</option>
                            <option value="interval">Every N minutes</option>
                            <option value="range">Range</option>
                        </select>
                        <div id="minuteField" style="margin-top: 10px;"></div>
                    </div>

                    <div class="field-group">
                        <div class="field-label">
                            Hour
                            <span class="field-hint">(0-23)</span>
                        </div>
                        <select id="hourType" onchange="updateHourField()">
                            <option value="*">Every hour (*)</option>
                            <option value="specific">Specific hour</option>
                            <option value="interval">Every N hours</option>
                            <option value="range">Range</option>
                        </select>
                        <div id="hourField" style="margin-top: 10px;"></div>
                    </div>

                    <div class="field-group">
                        <div class="field-label">
                            Day of Month
                            <span class="field-hint">(1-31)</span>
                        </div>
                        <select id="dayType" onchange="updateDayField()">
                            <option value="*">Every day (*)</option>
                            <option value="specific">Specific day</option>
                            <option value="interval">Every N days</option>
                            <option value="range">Range</option>
                        </select>
                        <div id="dayField" style="margin-top: 10px;"></div>
                    </div>

                    <div class="field-group">
                        <div class="field-label">
                            Month
                            <span class="field-hint">(1-12)</span>
                        </div>
                        <select id="monthType" onchange="updateMonthField()">
                            <option value="*">Every month (*)</option>
                            <option value="specific">Specific month</option>
                            <option value="interval">Every N months</option>
                            <option value="range">Range</option>
                        </select>
                        <div id="monthField" style="margin-top: 10px;"></div>
                    </div>

                    <div class="field-group">
                        <div class="field-label">
                            Day of Week
                            <span class="field-hint">(0-6, 0=Sun)</span>
                        </div>
                        <select id="weekdayType" onchange="updateWeekdayField()">
                            <option value="*">Every day (*)</option>
                            <option value="specific">Specific days</option>
                        </select>
                        <div id="weekdayField" style="margin-top: 10px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="directTab" class="tab-content">
            <div class="card">
                <div class="card-title">‚å®Ô∏è Direct Cron Expression</div>
                <div class="direct-input">
                    <input type="text" id="directInput" placeholder="* * * * *" onblur="parseDirectInput()">
                    <div class="help-text">
                        <strong>Format:</strong> minute hour day month weekday<br>
                        <strong>Example:</strong> 0 9 * * 1-5 (Mon-Fri at 9 AM)
                    </div>
                </div>
            </div>
        </div>

        <div class="output-section">
            <div class="output-label">Generated Cron Expression</div>
            <div class="output-value" id="cronOutput">* * * * *</div>
            <div class="output-description" id="cronDescription">Runs every minute</div>
            <div class="output-actions">
                <button class="btn btn-white" id="copyBtn">
                    <span>üìã</span>
                    <span>Copy Expression</span>
                </button>
            </div>
        </div>

        <div class="card">
            <div class="card-title">üìÖ Next 10 Executions</div>
            <ul class="schedule-list" id="scheduleList">
                <li class="schedule-item">
                    <div class="index">1</div>
                    <div class="time">Loading...</div>
                </li>
            </ul>
        </div>
    </div>

    <script>
        let currentLang = localStorage.getItem('cron-lang') || 'ko';
        const langSelect = document.getElementById('langSelect');
        langSelect.value = currentLang;

        const translations = {
            ko: {
                everyMinute: 'Îß§Î∂Ñ Ïã§Ìñâ',
                everyHour: 'Îß§ÏãúÍ∞Ñ Ï†ïÍ∞Å Ïã§Ìñâ',
                everyDay: 'Îß§Ïùº ÏûêÏ†ï Ïã§Ìñâ',
                everyWeek: 'Îß§Ï£º ÏùºÏöîÏùº ÏûêÏ†ï Ïã§Ìñâ',
                everyMonth: 'Îß§Ïõî 1Ïùº ÏûêÏ†ï Ïã§Ìñâ',
                at: 'Ïóê',
                on: 'Ïùº',
                every: 'Îß§',
                minute: 'Î∂Ñ',
                hour: 'Ïãú',
                day: 'Ïùº',
                month: 'Ïõî',
                weekdays: ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'],
                months: ['1Ïõî', '2Ïõî', '3Ïõî', '4Ïõî', '5Ïõî', '6Ïõî', '7Ïõî', '8Ïõî', '9Ïõî', '10Ïõî', '11Ïõî', '12Ïõî']
            },
            en: {
                everyMinute: 'Runs every minute',
                everyHour: 'Runs every hour at minute 0',
                everyDay: 'Runs every day at midnight',
                everyWeek: 'Runs every week on Sunday at midnight',
                everyMonth: 'Runs every month on the 1st at midnight',
                at: 'at',
                on: 'on',
                every: 'every',
                minute: 'minute',
                hour: 'hour',
                day: 'day',
                month: 'month',
                weekdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
            }
        };

        function updateMinuteField() {
            const type = document.getElementById('minuteType').value;
            const field = document.getElementById('minuteField');
            if (type === '*') {
                field.innerHTML = '';
            } else if (type === 'specific') {
                field.innerHTML = '<input type="number" id="minuteValue" min="0" max="59" value="0" onchange="updateCron()">';
            } else if (type === 'interval') {
                field.innerHTML = '<input type="number" id="minuteValue" min="1" max="59" value="5" onchange="updateCron()" placeholder="Every N minutes">';
            } else if (type === 'range') {
                field.innerHTML = '<div style="display:flex;gap:8px;align-items:center;"><input type="number" id="minuteStart" min="0" max="59" value="0" onchange="updateCron()"><span>-</span><input type="number" id="minuteEnd" min="0" max="59" value="30" onchange="updateCron()"></div>';
            }
            updateCron();
        }

        function updateHourField() {
            const type = document.getElementById('hourType').value;
            const field = document.getElementById('hourField');
            if (type === '*') {
                field.innerHTML = '';
            } else if (type === 'specific') {
                field.innerHTML = '<input type="number" id="hourValue" min="0" max="23" value="0" onchange="updateCron()">';
            } else if (type === 'interval') {
                field.innerHTML = '<input type="number" id="hourValue" min="1" max="23" value="6" onchange="updateCron()" placeholder="Every N hours">';
            } else if (type === 'range') {
                field.innerHTML = '<div style="display:flex;gap:8px;align-items:center;"><input type="number" id="hourStart" min="0" max="23" value="9" onchange="updateCron()"><span>-</span><input type="number" id="hourEnd" min="0" max="23" value="17" onchange="updateCron()"></div>';
            }
            updateCron();
        }

        function updateDayField() {
            const type = document.getElementById('dayType').value;
            const field = document.getElementById('dayField');
            if (type === '*') {
                field.innerHTML = '';
            } else if (type === 'specific') {
                field.innerHTML = '<input type="number" id="dayValue" min="1" max="31" value="1" onchange="updateCron()">';
            } else if (type === 'interval') {
                field.innerHTML = '<input type="number" id="dayValue" min="1" max="31" value="7" onchange="updateCron()" placeholder="Every N days">';
            } else if (type === 'range') {
                field.innerHTML = '<div style="display:flex;gap:8px;align-items:center;"><input type="number" id="dayStart" min="1" max="31" value="1" onchange="updateCron()"><span>-</span><input type="number" id="dayEnd" min="1" max="31" value="15" onchange="updateCron()"></div>';
            }
            updateCron();
        }

        function updateMonthField() {
            const type = document.getElementById('monthType').value;
            const field = document.getElementById('monthField');
            if (type === '*') {
                field.innerHTML = '';
            } else if (type === 'specific') {
                field.innerHTML = '<select id="monthValue" onchange="updateCron()">' +
                    Array.from({length: 12}, (_, i) => `<option value="${i+1}">${translations[currentLang].months[i]}</option>`).join('') +
                    '</select>';
            } else if (type === 'interval') {
                field.innerHTML = '<input type="number" id="monthValue" min="1" max="12" value="3" onchange="updateCron()" placeholder="Every N months">';
            } else if (type === 'range') {
                field.innerHTML = '<div style="display:flex;gap:8px;align-items:center;"><select id="monthStart" onchange="updateCron()">' +
                    Array.from({length: 12}, (_, i) => `<option value="${i+1}">${translations[currentLang].months[i]}</option>`).join('') +
                    '</select><span>-</span><select id="monthEnd" onchange="updateCron()">' +
                    Array.from({length: 12}, (_, i) => `<option value="${i+1}" ${i===11?'selected':''}>${translations[currentLang].months[i]}</option>`).join('') +
                    '</select></div>';
            }
            updateCron();
        }

        function updateWeekdayField() {
            const type = document.getElementById('weekdayType').value;
            const field = document.getElementById('weekdayField');
            if (type === '*') {
                field.innerHTML = '';
            } else if (type === 'specific') {
                const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                field.innerHTML = '<div class="checkbox-grid">' +
                    days.map((day, i) => `
                        <div class="checkbox-item">
                            <input type="checkbox" id="weekday${i}" value="${i}" onchange="updateCron()">
                            <label for="weekday${i}">${day}</label>
                        </div>
                    `).join('') +
                    '</div>';
            }
            updateCron();
        }

        function getCronExpression() {
            const minuteType = document.getElementById('minuteType').value;
            const hourType = document.getElementById('hourType').value;
            const dayType = document.getElementById('dayType').value;
            const monthType = document.getElementById('monthType').value;
            const weekdayType = document.getElementById('weekdayType').value;

            let minute = '*', hour = '*', day = '*', month = '*', weekday = '*';

            // Minute
            if (minuteType === 'specific') {
                minute = document.getElementById('minuteValue')?.value || '0';
            } else if (minuteType === 'interval') {
                minute = '*/' + (document.getElementById('minuteValue')?.value || '5');
            } else if (minuteType === 'range') {
                const start = document.getElementById('minuteStart')?.value || '0';
                const end = document.getElementById('minuteEnd')?.value || '30';
                minute = `${start}-${end}`;
            }

            // Hour
            if (hourType === 'specific') {
                hour = document.getElementById('hourValue')?.value || '0';
            } else if (hourType === 'interval') {
                hour = '*/' + (document.getElementById('hourValue')?.value || '6');
            } else if (hourType === 'range') {
                const start = document.getElementById('hourStart')?.value || '9';
                const end = document.getElementById('hourEnd')?.value || '17';
                hour = `${start}-${end}`;
            }

            // Day
            if (dayType === 'specific') {
                day = document.getElementById('dayValue')?.value || '1';
            } else if (dayType === 'interval') {
                day = '*/' + (document.getElementById('dayValue')?.value || '7');
            } else if (dayType === 'range') {
                const start = document.getElementById('dayStart')?.value || '1';
                const end = document.getElementById('dayEnd')?.value || '15';
                day = `${start}-${end}`;
            }

            // Month
            if (monthType === 'specific') {
                month = document.getElementById('monthValue')?.value || '1';
            } else if (monthType === 'interval') {
                month = '*/' + (document.getElementById('monthValue')?.value || '3');
            } else if (monthType === 'range') {
                const start = document.getElementById('monthStart')?.value || '1';
                const end = document.getElementById('monthEnd')?.value || '12';
                month = `${start}-${end}`;
            }

            // Weekday
            if (weekdayType === 'specific') {
                const selected = [];
                for (let i = 0; i < 7; i++) {
                    const checkbox = document.getElementById(`weekday${i}`);
                    if (checkbox?.checked) selected.push(i);
                }
                weekday = selected.length > 0 ? selected.join(',') : '*';
            }

            return `${minute} ${hour} ${day} ${month} ${weekday}`;
        }

        function describeCron(cron) {
            const parts = cron.split(' ');
            const [minute, hour, day, month, weekday] = parts;
            
            const t = translations[currentLang];
            let desc = '';

            if (cron === '* * * * *') return t.everyMinute;
            if (cron === '0 * * * *') return t.everyHour;
            if (cron === '0 0 * * *') return t.everyDay;

            // Build description
            const components = [];
            
            if (minute !== '*') components.push(`${t.minute} ${minute}`);
            if (hour !== '*') components.push(`${t.hour} ${hour}`);
            if (day !== '*') components.push(`${t.day} ${day}`);
            if (month !== '*') components.push(`${t.month} ${month}`);
            if (weekday !== '*') {
                const days = weekday.split(',').map(d => t.weekdays[parseInt(d)]).join(', ');
                components.push(days);
            }

            return components.join(' ') || t.everyMinute;
        }

        function updateCron() {
            const cron = getCronExpression();
            document.getElementById('cronOutput').textContent = cron;
            document.getElementById('cronDescription').textContent = describeCron(cron);
            document.getElementById('directInput').value = cron;
            updateSchedule(cron);
        }

        function updateSchedule(cron) {
            const scheduleList = document.getElementById('scheduleList');
            const times = getNextExecutions(cron, 10);
            
            scheduleList.innerHTML = times.map((time, i) => `
                <li class="schedule-item">
                    <div class="index">${i + 1}</div>
                    <div class="time">${time.toLocaleString(currentLang === 'ko' ? 'ko-KR' : 'en-US', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    })}</div>
                </li>
            `).join('');
        }

        function getNextExecutions(cron, count) {
            const parts = cron.split(' ');
            const [minute, hour, day, month, weekday] = parts;
            
            const times = [];
            let current = new Date();
            current.setSeconds(0);
            current.setMilliseconds(0);

            for (let i = 0; i < count * 1000 && times.length < count; i++) {
                current = new Date(current.getTime() + 60000); // Add 1 minute
                
                if (!matchesCron(current, minute, hour, day, month, weekday)) continue;
                
                times.push(new Date(current));
            }

            return times;
        }

        function matchesCron(date, minute, hour, day, month, weekday) {
            const m = date.getMinutes();
            const h = date.getHours();
            const d = date.getDate();
            const mo = date.getMonth() + 1;
            const w = date.getDay();

            return matchesField(m, minute, 0, 59) &&
                   matchesField(h, hour, 0, 23) &&
                   matchesField(d, day, 1, 31) &&
                   matchesField(mo, month, 1, 12) &&
                   matchesField(w, weekday, 0, 6);
        }

        function matchesField(value, pattern, min, max) {
            if (pattern === '*') return true;
            
            if (pattern.includes(',')) {
                return pattern.split(',').some(p => matchesField(value, p, min, max));
            }
            
            if (pattern.includes('/')) {
                const [base, step] = pattern.split('/');
                const start = base === '*' ? min : parseInt(base);
                return (value - start) % parseInt(step) === 0 && value >= start;
            }
            
            if (pattern.includes('-')) {
                const [start, end] = pattern.split('-').map(Number);
                return value >= start && value <= end;
            }
            
            return value === parseInt(pattern);
        }

        function applyPreset(cron) {
            const parts = cron.split(' ');
            const [minute, hour, day, month, weekday] = parts;

            // Reset to visual tab
            switchTab('visual');

            // Set types
            document.getElementById('minuteType').value = minute === '*' ? '*' : 'specific';
            document.getElementById('hourType').value = hour === '*' ? '*' : 'specific';
            document.getElementById('dayType').value = day === '*' ? '*' : 'specific';
            document.getElementById('monthType').value = month === '*' ? '*' : 'specific';
            document.getElementById('weekdayType').value = weekday === '*' ? '*' : 'specific';

            // Update fields
            updateMinuteField();
            updateHourField();
            updateDayField();
            updateMonthField();
            updateWeekdayField();

            // Set values
            if (minute !== '*' && document.getElementById('minuteValue')) {
                document.getElementById('minuteValue').value = minute;
            }
            if (hour !== '*' && document.getElementById('hourValue')) {
                document.getElementById('hourValue').value = hour;
            }
            if (day !== '*' && document.getElementById('dayValue')) {
                document.getElementById('dayValue').value = day;
            }
            if (month !== '*' && document.getElementById('monthValue')) {
                document.getElementById('monthValue').value = month;
            }
            if (weekday !== '*') {
                for (let i = 0; i < 7; i++) {
                    const checkbox = document.getElementById(`weekday${i}`);
                    if (checkbox) checkbox.checked = weekday.includes(String(i));
                }
            }

            updateCron();
        }

        function parseDirectInput() {
            const cron = document.getElementById('directInput').value.trim();
            if (cron) {
                applyPreset(cron);
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'visual') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('visualTab').classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('directTab').classList.add('active');
            }
        }

        // Event listeners
        document.getElementById('copyBtn').addEventListener('click', async () => {
            const cron = document.getElementById('cronOutput').textContent;
            try {
                await navigator.clipboard.writeText(cron);
                const btn = document.getElementById('copyBtn');
                const original = btn.innerHTML;
                btn.innerHTML = '<span>‚úÖ</span><span>Copied!</span>';
                setTimeout(() => btn.innerHTML = original, 2000);
            } catch (e) {
                alert('Failed to copy');
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('Reset to default (* * * * *)?')) {
                applyPreset('* * * * *');
            }
        });

        langSelect.addEventListener('change', () => {
            currentLang = langSelect.value;
            localStorage.setItem('cron-lang', currentLang);
            updateMonthField();
            updateCron();
        });

        // Theme toggle
        const themeBtn = document.getElementById('themeBtn');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
        let currentTheme = localStorage.getItem('cron-theme') || (prefersDark.matches ? 'dark' : 'light');

        function applyTheme(theme) {
            if (theme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
                themeBtn.textContent = '‚òÄÔ∏è';
            } else {
                document.documentElement.removeAttribute('data-theme');
                themeBtn.textContent = 'üåô';
            }
            currentTheme = theme;
            localStorage.setItem('cron-theme', theme);
        }

        applyTheme(currentTheme);
        themeBtn.addEventListener('click', () => {
            applyTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });

        // Initialize
        updateMinuteField();
        updateHourField();
        updateDayField();
        updateMonthField();
        updateWeekdayField();
        updateCron();
    </script>
</body>
</html>
