<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.env íŒŒì¼ í¸ì§‘ê¸° | ì›¹ ë„êµ¬ ëª¨ìŒ</title>
    <style>
        :root{--bg-primary:#fff;--bg-secondary:#f8f9fa;--text-primary:#212529;--text-secondary:#6c757d;--accent:linear-gradient(135deg,#667eea 0%,#764ba2 100%);--border:#dee2e6;--shadow:rgba(0,0,0,.1);--card-bg:#fff}
        [data-theme="dark"]{--bg-primary:#1a1a1a;--bg-secondary:#121212;--text-primary:#f8f9fa;--text-secondary:#adb5bd;--border:#444;--shadow:rgba(0,0,0,.3);--card-bg:#2d2d2d}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg-secondary);color:var(--text-primary);line-height:1.6;padding:20px;min-height:100vh}
        .container{max-width:900px;margin:0 auto}
        header{display:flex;align-items:center;justify-content:space-between;margin-bottom:30px}
        .back-btn{text-decoration:none;color:var(--text-secondary);display:flex;align-items:center;gap:5px;font-weight:500}.back-btn:hover{color:var(--text-primary)}
        .theme-toggle{background:none;border:none;cursor:pointer;font-size:1.5rem}
        .card{background:var(--card-bg);border-radius:20px;padding:30px;box-shadow:0 10px 30px var(--shadow);border:1px solid var(--border);margin-bottom:20px}
        h1{font-size:1.8rem;margin-bottom:10px;background:var(--accent);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
        .desc{color:var(--text-secondary);margin-bottom:20px}
        label{display:block;font-weight:600;margin-bottom:6px;font-size:.9rem}
        textarea{width:100%;padding:12px;border:2px solid var(--border);border-radius:12px;background:var(--bg-primary);color:var(--text-primary);font-size:.9rem;outline:none;font-family:'Courier New',monospace;resize:vertical;height:200px;margin-bottom:16px}
        textarea:focus{border-color:#667eea}
        .btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:20px}
        .btn{padding:10px 20px;border:none;border-radius:12px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .2s}
        .btn-primary{background:var(--accent);color:#fff}
        .btn-secondary{background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border)}
        .btn:hover{opacity:.85;transform:translateY(-1px)}
        .env-table{width:100%;border-collapse:collapse;margin-bottom:16px}
        .env-table th{text-align:left;padding:10px 12px;background:var(--bg-secondary);font-size:.8rem;color:var(--text-secondary);border-bottom:2px solid var(--border)}
        .env-table td{padding:8px 12px;border-bottom:1px solid var(--border);font-size:.9rem;vertical-align:middle}
        .env-table td:first-child{font-family:'Courier New',monospace;font-weight:600;white-space:nowrap}
        .env-table td:nth-child(2){font-family:'Courier New',monospace;word-break:break-all;max-width:300px}
        .masked{filter:blur(4px);user-select:none;transition:filter .2s}
        .masked:hover{filter:none;user-select:auto}
        .tag{display:inline-block;padding:2px 8px;border-radius:6px;font-size:.7rem;font-weight:600}
        .tag-secret{background:#fee2e2;color:#dc2626}
        .tag-url{background:#dbeafe;color:#2563eb}
        .tag-number{background:#d1fae5;color:#059669}
        .tag-bool{background:#fef3c7;color:#d97706}
        .tag-string{background:#f3e8ff;color:#7c3aed}
        .error-row{background:#fef2f2!important}
        .error-msg{color:#dc2626;font-size:.8rem}
        .stats{display:flex;gap:20px;flex-wrap:wrap;margin-bottom:16px}
        .stat{padding:8px 16px;background:var(--bg-secondary);border-radius:10px;font-size:.85rem}
        .stat strong{color:var(--text-primary)}
        .output-box{background:var(--bg-secondary);border:1px solid var(--border);border-radius:12px;padding:16px;font-family:'Courier New',monospace;font-size:.85rem;white-space:pre-wrap;min-height:60px;position:relative}
        .copy-btn{position:absolute;top:10px;right:10px;padding:6px 12px;background:var(--card-bg);border:1px solid var(--border);border-radius:8px;cursor:pointer;font-size:.8rem;color:var(--text-primary)}
        .toggle-vis{cursor:pointer;font-size:.85rem;color:#667eea;border:none;background:none;padding:2px 6px}
        @media(max-width:600px){.btn-row{flex-direction:column}.stats{flex-direction:column}}
    </style>
</head>
<body>
<div class="container">
    <header>
        <a href="../" class="back-btn">â† ëª©ë¡ìœ¼ë¡œ</a>
        <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
    </header>
    <div class="card">
        <h1>ğŸ” .env íŒŒì¼ í¸ì§‘ê¸°</h1>
        <p class="desc">.env íŒŒì¼ì„ íŒŒì‹±í•˜ì—¬ í…Œì´ë¸”ë¡œ ë³´ì—¬ì£¼ê³ , ë¯¼ê° ê°’ ë§ˆìŠ¤í‚¹Â·ê²€ì¦Â·ë³µì‚¬ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.</p>
        <label for="envInput">.env ë‚´ìš© ë¶™ì—¬ë„£ê¸°</label>
        <textarea id="envInput" placeholder="DB_HOST=localhost
DB_PORT=5432
DATABASE_URL=postgres://user:pass@localhost/db
SECRET_KEY=my-secret-key-123
DEBUG=true
# ì£¼ì„ë„ ì§€ì›ë©ë‹ˆë‹¤"></textarea>
        <div class="btn-row">
            <button class="btn btn-primary" onclick="parse()">íŒŒì‹±í•˜ê¸°</button>
            <button class="btn btn-secondary" onclick="loadSample()">ìƒ˜í”Œ ë¡œë“œ</button>
            <button class="btn btn-secondary" onclick="sortAlpha()">A-Z ì •ë ¬</button>
            <button class="btn btn-secondary" onclick="exportEnv()">ë‚´ë³´ë‚´ê¸°</button>
        </div>
    </div>
    <div class="card" id="resultCard" style="display:none">
        <div class="stats" id="stats"></div>
        <div style="overflow-x:auto">
            <table class="env-table" id="envTable"><thead><tr><th>Key</th><th>Value</th><th>Type</th><th>ìƒíƒœ</th></tr></thead><tbody id="envBody"></tbody></table>
        </div>
    </div>
    <div class="card" id="exportCard" style="display:none">
        <div style="font-weight:700;font-size:.85rem;color:var(--text-secondary);margin-bottom:8px">ğŸ“‹ ë‚´ë³´ë‚´ê¸°</div>
        <div class="output-box" id="exportOutput"><button class="copy-btn" onclick="copyExport()">ë³µì‚¬</button></div>
    </div>
</div>
<script>
const SECRET_PATTERNS = /key|secret|password|token|auth|credential|private|api.?key/i;
const URL_PATTERN = /^(https?:\/\/|postgres(ql)?:\/\/|redis:\/\/|mongodb(\+srv)?:\/\/|amqp:\/\/)/i;
let entries = [];

function parse(){
    const raw = document.getElementById('envInput').value;
    entries = [];
    const lines = raw.split('\n');
    const errors = [];
    lines.forEach((line, i) => {
        const trimmed = line.trim();
        if(!trimmed || trimmed.startsWith('#')) return;
        const eq = trimmed.indexOf('=');
        if(eq === -1){ errors.push({line:i+1, msg:'= ê¸°í˜¸ ì—†ìŒ', raw:trimmed}); return; }
        const key = trimmed.substring(0, eq).trim();
        let val = trimmed.substring(eq+1).trim();
        if((val.startsWith('"')&&val.endsWith('"'))||(val.startsWith("'")&&val.endsWith("'"))) val = val.slice(1,-1);
        if(!key.match(/^[A-Za-z_][A-Za-z0-9_]*$/)) errors.push({line:i+1, msg:'ì˜ëª»ëœ í‚¤ ì´ë¦„', raw:key});
        const isSecret = SECRET_PATTERNS.test(key);
        let type = 'string';
        if(URL_PATTERN.test(val)) type = 'url';
        else if(val === 'true' || val === 'false') type = 'bool';
        else if(!isNaN(val) && val !== '') type = 'number';
        entries.push({key, val, type, isSecret, error: null});
    });
    errors.forEach(e => entries.push({key: e.raw, val:'', type:'error', isSecret:false, error:e.msg}));
    renderTable();
}

function renderTable(){
    const body = document.getElementById('envBody');
    body.innerHTML = '';
    const tags = {secret:'tag-secret',url:'tag-url',number:'tag-number',bool:'tag-bool',string:'tag-string',error:'tag-secret'};
    const tagLabels = {secret:'ğŸ”‘ Secret',url:'ğŸ”— URL',number:'ğŸ”¢ Number',bool:'âš¡ Bool',string:'ğŸ“ String',error:'âŒ Error'};
    entries.forEach((e,i)=>{
        const tr = document.createElement('tr');
        if(e.error) tr.className = 'error-row';
        const masked = e.isSecret ? 'masked' : '';
        const tLabel = e.isSecret ? 'secret' : e.type;
        tr.innerHTML = `<td>${esc(e.key)}</td>
            <td><span class="${masked}" id="val-${i}">${esc(e.val)}</span>${e.isSecret?` <button class="toggle-vis" onclick="toggleMask(${i})">ğŸ‘</button>`:''}</td>
            <td><span class="tag ${tags[tLabel]}">${tagLabels[tLabel]}</span></td>
            <td>${e.error?`<span class="error-msg">${e.error}</span>`:'âœ…'}</td>`;
        body.appendChild(tr);
    });
    document.getElementById('resultCard').style.display = 'block';
    const valid = entries.filter(e=>!e.error);
    document.getElementById('stats').innerHTML = `
        <div class="stat">ì „ì²´ <strong>${entries.length}</strong>ê°œ</div>
        <div class="stat">ì‹œí¬ë¦¿ <strong>${valid.filter(e=>e.isSecret).length}</strong>ê°œ</div>
        <div class="stat">URL <strong>${valid.filter(e=>e.type==='url').length}</strong>ê°œ</div>
        <div class="stat">ì˜¤ë¥˜ <strong>${entries.filter(e=>e.error).length}</strong>ê°œ</div>`;
}

function toggleMask(i){document.getElementById('val-'+i).classList.toggle('masked')}

function sortAlpha(){
    entries.sort((a,b)=>a.key.localeCompare(b.key));
    renderTable();
}

function exportEnv(){
    if(!entries.length){parse()}
    const text = entries.filter(e=>!e.error).map(e=>`${e.key}=${e.val}`).join('\n');
    document.getElementById('exportCard').style.display='block';
    document.getElementById('exportOutput').innerHTML=esc(text)+'<button class="copy-btn" onclick="copyExport()">ë³µì‚¬</button>';
}

function copyExport(){
    const el=document.getElementById('exportOutput');
    const t=el.textContent.replace('ë³µì‚¬','').replace('ë³µì‚¬ë¨!','').trim();
    navigator.clipboard.writeText(t).then(()=>{const b=el.querySelector('.copy-btn');b.textContent='ë³µì‚¬ë¨!';setTimeout(()=>b.textContent='ë³µì‚¬',1500)});
}

function loadSample(){
    document.getElementById('envInput').value=`# Database
DB_HOST=localhost
DB_PORT=5432
DB_NAME=myapp
DATABASE_URL=postgres://user:pass@localhost:5432/myapp

# Auth
SECRET_KEY=super-secret-key-abc123
JWT_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
API_KEY=sk-1234567890abcdef

# App
DEBUG=true
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# Redis
REDIS_URL=redis://localhost:6379`;
    parse();
}

function esc(t){return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}
function toggleTheme(){const h=document.documentElement;const t=h.getAttribute('data-theme')==='dark'?'light':'dark';h.setAttribute('data-theme',t);localStorage.setItem('theme',t)}
document.documentElement.setAttribute('data-theme',localStorage.getItem('theme')||'light');
</script>
</body>
</html>
