<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML â†’ Markdown ë³€í™˜ê¸° | HTML to Markdown Converter</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#fff;--bg2:#f8f9fa;--text:#212529;--text2:#6c757d;--accent:#667eea;--border:#dee2e6;--shadow:rgba(0,0,0,.1);--card:#fff;--code-bg:#f1f3f5}
        [data-theme="dark"]{--bg:#1a1a1a;--bg2:#2d2d2d;--text:#f8f9fa;--text2:#adb5bd;--border:#495057;--shadow:rgba(0,0,0,.3);--card:#2d2d2d;--code-bg:#3d3d3d}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg2);color:var(--text);padding:20px;min-height:100vh;transition:all .3s}
        .container{max-width:1000px;margin:0 auto}
        header{text-align:center;margin-bottom:30px}
        h1{font-size:1.8rem;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px}
        .subtitle{color:var(--text2);font-size:.95rem}
        .theme-toggle{position:fixed;top:15px;right:15px;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;z-index:10}
        .home-btn{position:fixed;top:15px;left:15px;text-decoration:none;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;z-index:10}
        .editor-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        .editor-panel{background:var(--card);border-radius:12px;overflow:hidden;box-shadow:0 2px 8px var(--shadow)}
        .editor-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--bg2);border-bottom:1px solid var(--border)}
        .editor-header h3{font-size:.9rem;display:flex;align-items:center;gap:6px}
        .editor-body textarea{width:100%;height:400px;padding:16px;border:none;font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.85rem;line-height:1.6;resize:vertical;background:var(--bg);color:var(--text)}
        .editor-body textarea:focus{outline:none}
        .editor-body .preview{padding:16px;min-height:400px;overflow-y:auto;font-size:.9rem;line-height:1.7}
        .arrow{display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:var(--text2)}
        .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px;justify-content:center}
        .btn{padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .2s}
        .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
        .btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(102,126,234,.4)}
        .btn-secondary{background:#e9ecef;color:var(--text)}
        [data-theme="dark"] .btn-secondary{background:#3d3d3d}
        .btn-icon{background:none;border:1px solid var(--border);color:var(--text);border-radius:6px;padding:6px 10px;cursor:pointer;font-size:.8rem}
        .btn-icon:hover{border-color:var(--accent);color:var(--accent)}
        .options{background:var(--card);border-radius:12px;padding:16px;margin-bottom:20px;box-shadow:0 2px 8px var(--shadow);display:flex;flex-wrap:wrap;gap:16px;align-items:center;justify-content:center}
        .option label{font-size:.85rem;display:flex;align-items:center;gap:6px;cursor:pointer}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:10px 24px;border-radius:8px;font-size:.9rem;opacity:0;transition:opacity .3s;z-index:100}
        .toast.show{opacity:1}
        @media(max-width:700px){.editor-grid{grid-template-columns:1fr}.editor-body textarea,.editor-body .preview{height:250px}h1{font-size:1.4rem}}
    </style>
</head>
<body>
    <a href="/tools/" class="home-btn" title="ë„êµ¬ ëª©ë¡">ğŸ </a>
    <button class="theme-toggle" onclick="toggleTheme()" title="í…Œë§ˆ ì „í™˜">ğŸŒ“</button>
    <div class="container">
        <header>
            <h1>ğŸ”„ HTML â†’ Markdown ë³€í™˜ê¸°</h1>
            <p class="subtitle">HTMLì„ Markdownìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì§€ì›.</p>
        </header>
        <div class="options">
            <div class="option"><label><input type="checkbox" id="optBold" checked onchange="convert()"> **Bold**</label></div>
            <div class="option"><label><input type="checkbox" id="optHeading" checked onchange="convert()"> # Headings</label></div>
            <div class="option"><label><input type="checkbox" id="optLinks" checked onchange="convert()"> [Links]()</label></div>
            <div class="option"><label><input type="checkbox" id="optImages" checked onchange="convert()"> ![Images]()</label></div>
            <div class="option"><label><input type="checkbox" id="optCode" checked onchange="convert()"> `Code`</label></div>
            <div class="option"><label><input type="checkbox" id="optTable" checked onchange="convert()"> Tables</label></div>
        </div>
        <div class="toolbar">
            <button class="btn btn-primary" onclick="convert()">ğŸ”„ ë³€í™˜</button>
            <button class="btn btn-secondary" onclick="copyOutput()">ğŸ“‹ ë³µì‚¬</button>
            <button class="btn btn-secondary" onclick="downloadMd()">ğŸ’¾ .md ë‹¤ìš´ë¡œë“œ</button>
            <button class="btn btn-secondary" onclick="loadSample()">ğŸ“ ìƒ˜í”Œ ë¡œë“œ</button>
            <button class="btn btn-secondary" onclick="clearAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
        </div>
        <div class="editor-grid">
            <div class="editor-panel">
                <div class="editor-header"><h3>ğŸ“„ HTML ì…ë ¥</h3><button class="btn-icon" onclick="pasteFromClipboard()">ğŸ“‹ ë¶™ì—¬ë„£ê¸°</button></div>
                <div class="editor-body"><textarea id="htmlInput" placeholder="HTMLì„ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”..." oninput="convert()"></textarea></div>
            </div>
            <div class="editor-panel">
                <div class="editor-header"><h3>ğŸ“ Markdown ì¶œë ¥</h3><button class="btn-icon" onclick="copyOutput()">ğŸ“‹ ë³µì‚¬</button></div>
                <div class="editor-body"><textarea id="mdOutput" readonly placeholder="ë³€í™˜ëœ Markdownì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤..."></textarea></div>
            </div>
        </div>
    </div>
    <div class="toast" id="toast"></div>
<script>
function convert(){
    const html=document.getElementById('htmlInput').value;
    if(!html.trim()){document.getElementById('mdOutput').value='';return;}
    const opts={
        bold:document.getElementById('optBold').checked,
        heading:document.getElementById('optHeading').checked,
        links:document.getElementById('optLinks').checked,
        images:document.getElementById('optImages').checked,
        code:document.getElementById('optCode').checked,
        table:document.getElementById('optTable').checked
    };
    document.getElementById('mdOutput').value=htmlToMarkdown(html,opts);
}

function htmlToMarkdown(html,opts){
    let md=html;
    // Normalize line breaks
    md=md.replace(/\r\n/g,'\n');
    
    // Handle code blocks first (preserve content)
    if(opts.code){
        md=md.replace(/<pre[^>]*><code[^>]*>([\s\S]*?)<\/code><\/pre>/gi,(_,c)=>'```\n'+decodeHtml(c).trim()+'\n```');
        md=md.replace(/<pre[^>]*>([\s\S]*?)<\/pre>/gi,(_,c)=>'```\n'+decodeHtml(c).trim()+'\n```');
        md=md.replace(/<code[^>]*>(.*?)<\/code>/gi,(_,c)=>'`'+decodeHtml(c)+'`');
    }
    
    // Headings
    if(opts.heading){
        for(let i=6;i>=1;i--){
            const re=new RegExp(`<h${i}[^>]*>(.*?)<\\/h${i}>`,'gi');
            md=md.replace(re,(_,c)=>'\n'+'#'.repeat(i)+' '+c.trim()+'\n');
        }
    }
    
    // Bold & Italic
    if(opts.bold){
        md=md.replace(/<(strong|b)>(.*?)<\/\1>/gi,'**$2**');
        md=md.replace(/<(em|i)>(.*?)<\/\1>/gi,'*$2*');
        md=md.replace(/<(del|s|strike)>(.*?)<\/\1>/gi,'~~$2~~');
    }
    
    // Images (before links)
    if(opts.images){
        md=md.replace(/<img[^>]*src=["']([^"']+)["'][^>]*alt=["']([^"']*)["'][^>]*\/?>/gi,'![$2]($1)');
        md=md.replace(/<img[^>]*alt=["']([^"']*)["'][^>]*src=["']([^"']+)["'][^>]*\/?>/gi,'![$1]($2)');
        md=md.replace(/<img[^>]*src=["']([^"']+)["'][^>]*\/?>/gi,'![]($1)');
    }
    
    // Links
    if(opts.links){
        md=md.replace(/<a[^>]*href=["']([^"']+)["'][^>]*>(.*?)<\/a>/gi,'[$2]($1)');
    }
    
    // Lists
    md=md.replace(/<ul[^>]*>([\s\S]*?)<\/ul>/gi,(_,c)=>{
        return '\n'+c.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,(_,li)=>'- '+li.trim()).trim()+'\n';
    });
    md=md.replace(/<ol[^>]*>([\s\S]*?)<\/ol>/gi,(_,c)=>{
        let n=0;
        return '\n'+c.replace(/<li[^>]*>([\s\S]*?)<\/li>/gi,(_,li)=>(++n)+'. '+li.trim()).trim()+'\n';
    });
    
    // Tables
    if(opts.table){
        md=md.replace(/<table[^>]*>([\s\S]*?)<\/table>/gi,(_,tableHtml)=>{
            const rows=[];
            const trMatches=tableHtml.match(/<tr[^>]*>([\s\S]*?)<\/tr>/gi)||[];
            trMatches.forEach(tr=>{
                const cells=[];
                const cellMatches=tr.match(/<(td|th)[^>]*>([\s\S]*?)<\/\1>/gi)||[];
                cellMatches.forEach(cell=>{
                    const content=cell.replace(/<\/?[^>]+>/g,'').trim();
                    cells.push(content);
                });
                if(cells.length)rows.push(cells);
            });
            if(!rows.length)return '';
            const maxCols=Math.max(...rows.map(r=>r.length));
            let result='\n';
            rows.forEach((row,i)=>{
                const padded=row.concat(Array(maxCols-row.length).fill(''));
                result+='| '+padded.join(' | ')+' |\n';
                if(i===0)result+='| '+padded.map(()=>'---').join(' | ')+' |\n';
            });
            return result;
        });
    }
    
    // Blockquote
    md=md.replace(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/gi,(_,c)=>{
        return '\n'+c.trim().split('\n').map(l=>'> '+l.trim()).join('\n')+'\n';
    });
    
    // HR
    md=md.replace(/<hr\s*\/?>/gi,'\n---\n');
    
    // BR
    md=md.replace(/<br\s*\/?>/gi,'  \n');
    
    // Paragraphs
    md=md.replace(/<p[^>]*>([\s\S]*?)<\/p>/gi,'\n$1\n');
    
    // Remove remaining tags
    md=md.replace(/<\/?[^>]+>/g,'');
    
    // Decode HTML entities
    md=decodeHtml(md);
    
    // Clean up whitespace
    md=md.replace(/\n{3,}/g,'\n\n').trim();
    
    return md;
}

function decodeHtml(html){
    const el=document.createElement('textarea');
    el.innerHTML=html;
    return el.value;
}

function copyOutput(){
    const t=document.getElementById('mdOutput').value;
    if(!t){showToast('ë³€í™˜í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤');return;}
    navigator.clipboard.writeText(t).then(()=>showToast('Markdown ë³µì‚¬ë¨! âœ…'));
}
function downloadMd(){
    const t=document.getElementById('mdOutput').value;
    if(!t){showToast('ë³€í™˜í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤');return;}
    const a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([t],{type:'text/markdown'}));
    a.download='converted.md';a.click();
    showToast('ë‹¤ìš´ë¡œë“œ ì™„ë£Œ! ğŸ’¾');
}
async function pasteFromClipboard(){
    try{const t=await navigator.clipboard.readText();document.getElementById('htmlInput').value=t;convert();showToast('ë¶™ì—¬ë„£ê¸° ì™„ë£Œ!');}
    catch(e){showToast('í´ë¦½ë³´ë“œ ì ‘ê·¼ ì‹¤íŒ¨');}
}
function loadSample(){
    document.getElementById('htmlInput').value=`<h1>HTML to Markdown ë³€í™˜ê¸°</h1>
<p>ì´ ë„êµ¬ëŠ” <strong>HTML</strong>ì„ <em>Markdown</em>ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>

<h2>ê¸°ëŠ¥ ëª©ë¡</h2>
<ul>
    <li>ì œëª© ë³€í™˜ (h1~h6)</li>
    <li>í…ìŠ¤íŠ¸ ì„œì‹ (<strong>Bold</strong>, <em>Italic</em>, <del>Strikethrough</del>)</li>
    <li>ë§í¬: <a href="https://eastsea.monster">eastsea.monster</a></li>
    <li>ì´ë¯¸ì§€: <img src="https://via.placeholder.com/150" alt="ìƒ˜í”Œ ì´ë¯¸ì§€"></li>
</ul>

<h2>ì½”ë“œ ì˜ˆì œ</h2>
<pre><code>function hello() {
    console.log("Hello, World!");
}</code></pre>

<p>ì¸ë¼ì¸ ì½”ë“œ: <code>const x = 42;</code></p>

<h2>í…Œì´ë¸”</h2>
<table>
    <tr><th>ì´ë¦„</th><th>ë‚˜ì´</th><th>ì§ì—…</th></tr>
    <tr><td>í™ê¸¸ë™</td><td>30</td><td>ê°œë°œì</td></tr>
    <tr><td>ê¹€ì² ìˆ˜</td><td>25</td><td>ë””ìì´ë„ˆ</td></tr>
</table>

<blockquote>ì´ê²ƒì€ ì¸ìš©ë¬¸ì…ë‹ˆë‹¤.</blockquote>

<hr>
<p>ë!</p>`;
    convert();
    showToast('ìƒ˜í”Œ ë¡œë“œë¨! ğŸ“');
}
function clearAll(){document.getElementById('htmlInput').value='';document.getElementById('mdOutput').value='';}
function toggleTheme(){const d=document.documentElement;const t=d.getAttribute('data-theme')==='dark'?'':'dark';d.setAttribute('data-theme',t);localStorage.setItem('theme',t);}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000);}
if(localStorage.getItem('theme')==='dark')document.documentElement.setAttribute('data-theme','dark');
</script>
</body>
</html>