<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT ÌÜ†ÌÅ∞ ÎπåÎçî | JWT Token Builder</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#fff;--bg2:#f8f9fa;--text:#212529;--text2:#6c757d;--accent:#667eea;--border:#dee2e6;--shadow:rgba(0,0,0,.1);--card:#fff;--code-bg:#f1f3f5}
        [data-theme="dark"]{--bg:#1a1a1a;--bg2:#2d2d2d;--text:#f8f9fa;--text2:#adb5bd;--border:#495057;--shadow:rgba(0,0,0,.3);--card:#2d2d2d;--code-bg:#3d3d3d}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg2);color:var(--text);padding:20px;min-height:100vh;transition:all .3s}
        .container{max-width:900px;margin:0 auto}
        header{text-align:center;margin-bottom:30px}
        h1{font-size:1.8rem;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px}
        .subtitle{color:var(--text2);font-size:.95rem}
        .theme-toggle{position:fixed;top:15px;right:15px;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;z-index:10}
        .home-btn{position:fixed;top:15px;left:15px;text-decoration:none;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;z-index:10}
        .panel{background:var(--card);border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px var(--shadow)}
        .panel h2{font-size:1.1rem;margin-bottom:14px;display:flex;align-items:center;gap:8px}
        .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        label{display:block;font-size:.85rem;font-weight:600;margin-bottom:6px;color:var(--text2)}
        select,input,textarea{width:100%;padding:10px 12px;border:2px solid var(--border);border-radius:8px;font-size:.9rem;background:var(--bg);color:var(--text);transition:border .3s;font-family:inherit}
        select:focus,input:focus,textarea:focus{outline:none;border-color:var(--accent)}
        textarea{font-family:'SF Mono',Monaco,Consolas,monospace;resize:vertical;min-height:120px;line-height:1.5}
        .field-group{margin-bottom:14px}
        .jwt-output{font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.8rem;word-break:break-all;padding:16px;background:var(--code-bg);border-radius:8px;line-height:1.6;min-height:80px;cursor:pointer;border:1px solid var(--border)}
        .jwt-output .header-part{color:#e74c3c}
        .jwt-output .payload-part{color:#9b59b6}
        .jwt-output .sig-part{color:#3498db}
        .legend{display:flex;gap:16px;margin-top:10px;font-size:.8rem;flex-wrap:wrap}
        .legend span{display:flex;align-items:center;gap:4px}
        .legend .dot{width:10px;height:10px;border-radius:50%;display:inline-block}
        .btn-row{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
        .btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .2s}
        .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
        .btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(102,126,234,.4)}
        .btn-secondary{background:#e9ecef;color:var(--text)}
        [data-theme="dark"] .btn-secondary{background:#3d3d3d}
        .claim-row{display:flex;gap:8px;margin-bottom:8px;align-items:center}
        .claim-row input{flex:1}
        .claim-row .remove-btn{background:#e74c3c;color:#fff;border:none;border-radius:6px;width:32px;height:38px;cursor:pointer;font-size:1rem;flex-shrink:0}
        .add-claim{background:none;border:2px dashed var(--border);border-radius:8px;padding:8px;color:var(--text2);cursor:pointer;width:100%;font-size:.85rem;transition:all .2s}
        .add-claim:hover{border-color:var(--accent);color:var(--accent)}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:10px 24px;border-radius:8px;font-size:.9rem;opacity:0;transition:opacity .3s;z-index:100}
        .toast.show{opacity:1}
        .quick-claims{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px}
        .quick-btn{padding:4px 10px;border-radius:14px;background:var(--code-bg);border:1px solid var(--border);color:var(--text2);cursor:pointer;font-size:.75rem}
        .quick-btn:hover{border-color:var(--accent);color:var(--accent)}
        @media(max-width:700px){.grid{grid-template-columns:1fr}h1{font-size:1.4rem}}
    </style>
</head>
<body>
    <a href="/tools/" class="home-btn" title="ÎèÑÍµ¨ Î™©Î°ù">üè†</a>
    <button class="theme-toggle" onclick="toggleTheme()" title="ÌÖåÎßà Ï†ÑÌôò">üåì</button>
    <div class="container">
        <header>
            <h1>üîë JWT ÌÜ†ÌÅ∞ ÎπåÎçî</h1>
            <p class="subtitle">HeaderÏôÄ PayloadÎ•º ÏÑ§Ï†ïÌïòÏó¨ JWT ÌÜ†ÌÅ∞ÏùÑ ÏÉùÏÑ±Ìï©ÎãàÎã§ (HMAC ÏÑúÎ™Ö)</p>
        </header>
        <div class="grid">
            <div>
                <div class="panel">
                    <h2>üìã Header</h2>
                    <div class="field-group">
                        <label>Algorithm (alg)</label>
                        <select id="algorithm" onchange="generate()">
                            <option value="HS256" selected>HS256</option>
                            <option value="HS384">HS384</option>
                            <option value="HS512">HS512</option>
                        </select>
                    </div>
                    <div class="field-group">
                        <label>Type (typ)</label>
                        <input type="text" id="type" value="JWT" oninput="generate()">
                    </div>
                </div>
                <div class="panel">
                    <h2>üîê Secret</h2>
                    <div class="field-group">
                        <label>ÎπÑÎ∞Ä ÌÇ§ (Secret Key)</label>
                        <input type="text" id="secret" value="my-secret-key" oninput="generate()">
                    </div>
                    <label><input type="checkbox" id="base64Secret" onchange="generate()"> Base64Î°ú Ïù∏ÏΩîÎî©Îêú ÏãúÌÅ¨Î¶ø</label>
                </div>
            </div>
            <div>
                <div class="panel">
                    <h2>üì¶ Payload</h2>
                    <div class="quick-claims">
                        <button class="quick-btn" onclick="addQuickClaim('iss','eastsea.monster')">+ iss</button>
                        <button class="quick-btn" onclick="addQuickClaim('sub','user123')">+ sub</button>
                        <button class="quick-btn" onclick="addQuickClaim('aud','https://api.example.com')">+ aud</button>
                        <button class="quick-btn" onclick="addQuickClaim('exp',String(Math.floor(Date.now()/1000)+3600))">+ exp (1h)</button>
                        <button class="quick-btn" onclick="addQuickClaim('iat',String(Math.floor(Date.now()/1000)))">+ iat</button>
                        <button class="quick-btn" onclick="addQuickClaim('nbf',String(Math.floor(Date.now()/1000)))">+ nbf</button>
                        <button class="quick-btn" onclick="addQuickClaim('jti',crypto.randomUUID())">+ jti</button>
                        <button class="quick-btn" onclick="addQuickClaim('name','ÌôçÍ∏∏Îèô')">+ name</button>
                        <button class="quick-btn" onclick="addQuickClaim('role','admin')">+ role</button>
                    </div>
                    <div id="claims"></div>
                    <button class="add-claim" onclick="addClaim()">+ ÌÅ¥Î†àÏûÑ Ï∂îÍ∞Ä</button>
                </div>
            </div>
        </div>
        <div class="panel">
            <h2>üé´ ÏÉùÏÑ±Îêú JWT</h2>
            <div class="jwt-output" id="jwtOutput" onclick="copyJwt()" title="ÌÅ¥Î¶≠ÌïòÏó¨ Î≥µÏÇ¨"></div>
            <div class="legend">
                <span><span class="dot" style="background:#e74c3c"></span> Header</span>
                <span><span class="dot" style="background:#9b59b6"></span> Payload</span>
                <span><span class="dot" style="background:#3498db"></span> Signature</span>
            </div>
            <div class="btn-row">
                <button class="btn btn-primary" onclick="copyJwt()">üìã JWT Î≥µÏÇ¨</button>
                <button class="btn btn-secondary" onclick="copyPayload()">üì¶ Payload JSON Î≥µÏÇ¨</button>
            </div>
        </div>
    </div>
    <div class="toast" id="toast"></div>
<script>
let claimsList=[{key:'sub',value:'1234567890'},{key:'name',value:'ÌôçÍ∏∏Îèô'},{key:'iat',value:String(Math.floor(Date.now()/1000))}];

function init(){renderClaims();generate();}

function renderClaims(){
    const c=document.getElementById('claims');c.innerHTML='';
    claimsList.forEach((cl,i)=>{
        const row=document.createElement('div');row.className='claim-row';
        row.innerHTML=`<input type="text" value="${esc(cl.key)}" placeholder="key" oninput="claimsList[${i}].key=this.value;generate()"><input type="text" value="${esc(cl.value)}" placeholder="value" oninput="claimsList[${i}].value=this.value;generate()"><button class="remove-btn" onclick="claimsList.splice(${i},1);renderClaims();generate()">√ó</button>`;
        c.appendChild(row);
    });
}
function esc(s){return s.replace(/"/g,'&quot;')}
function addClaim(){claimsList.push({key:'',value:''});renderClaims();}
function addQuickClaim(k,v){
    const exists=claimsList.findIndex(c=>c.key===k);
    if(exists>=0){claimsList[exists].value=v;}else{claimsList.push({key:k,value:v});}
    renderClaims();generate();
}
function b64url(str){return btoa(str).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');}

async function generate(){
    const header=JSON.stringify({alg:document.getElementById('algorithm').value,typ:document.getElementById('type').value});
    const payload={};
    claimsList.forEach(c=>{
        if(!c.key)return;
        // auto-detect numbers
        if(/^\d+$/.test(c.value))payload[c.key]=parseInt(c.value);
        else if(c.value==='true')payload[c.key]=true;
        else if(c.value==='false')payload[c.key]=false;
        else payload[c.key]=c.value;
    });
    const payloadStr=JSON.stringify(payload);
    const headerB64=b64url(header);
    const payloadB64=b64url(payloadStr);
    const signingInput=headerB64+'.'+payloadB64;
    
    const alg=document.getElementById('algorithm').value;
    const algMap={HS256:'SHA-256',HS384:'SHA-384',HS512:'SHA-512'};
    let secret=document.getElementById('secret').value;
    if(document.getElementById('base64Secret').checked){try{secret=atob(secret);}catch(e){}}
    
    try{
        const enc=new TextEncoder();
        const keyData=enc.encode(secret);
        const key=await crypto.subtle.importKey('raw',keyData,{name:'HMAC',hash:algMap[alg]},false,['sign']);
        const sig=await crypto.subtle.sign('HMAC',key,enc.encode(signingInput));
        const sigB64=btoa(String.fromCharCode(...new Uint8Array(sig))).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');
        
        const out=document.getElementById('jwtOutput');
        out.innerHTML=`<span class="header-part">${headerB64}</span>.<span class="payload-part">${payloadB64}</span>.<span class="sig-part">${sigB64}</span>`;
    }catch(e){
        document.getElementById('jwtOutput').textContent='Error: '+e.message;
    }
}
function getJwt(){return document.getElementById('jwtOutput').textContent;}
function copyJwt(){
    const t=getJwt();if(!t)return;
    navigator.clipboard.writeText(t).then(()=>showToast('JWT Î≥µÏÇ¨Îê®! ‚úÖ'));
}
function copyPayload(){
    const payload={};
    claimsList.forEach(c=>{
        if(!c.key)return;
        if(/^\d+$/.test(c.value))payload[c.key]=parseInt(c.value);
        else if(c.value==='true')payload[c.key]=true;
        else if(c.value==='false')payload[c.key]=false;
        else payload[c.key]=c.value;
    });
    navigator.clipboard.writeText(JSON.stringify(payload,null,2)).then(()=>showToast('Payload JSON Î≥µÏÇ¨Îê®! ‚úÖ'));
}
function toggleTheme(){const d=document.documentElement;const t=d.getAttribute('data-theme')==='dark'?'':'dark';d.setAttribute('data-theme',t);localStorage.setItem('theme',t);}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000);}
if(localStorage.getItem('theme')==='dark')document.documentElement.setAttribute('data-theme','dark');
init();
</script>
</body>
</html>