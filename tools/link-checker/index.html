<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§í¬ ê²€ì‚¬ê¸° - Link Checker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            transition: background 0.3s;
        }

        body.dark {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        body.dark .container {
            background: #2d2d44;
            color: #e0e0e0;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2em;
        }

        body.dark h1 {
            color: #818cf8;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.95em;
        }

        body.dark .subtitle {
            color: #999;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            gap: 15px;
        }

        .theme-toggle {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        body.dark .theme-toggle {
            background: #818cf8;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 14px;
            font-family: monospace;
            resize: vertical;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        body.dark textarea {
            background: #1a1a2e;
            color: #e0e0e0;
            border-color: #444;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        button {
            flex: 1;
            min-width: 120px;
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
        }

        button:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        body.dark button {
            background: #818cf8;
        }

        body.dark button:hover:not(:disabled) {
            background: #6366f1;
        }

        .results {
            margin-top: 30px;
        }

        .result-item {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        body.dark .result-item {
            background: #1a1a2e;
            border-left-color: #818cf8;
        }

        .result-item.success {
            border-left-color: #10b981;
        }

        .result-item.error {
            border-left-color: #ef4444;
        }

        .result-item.warning {
            border-left-color: #f59e0b;
        }

        .result-url {
            font-weight: 600;
            color: #667eea;
            word-break: break-all;
            margin-bottom: 8px;
        }

        body.dark .result-url {
            color: #818cf8;
        }

        .result-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 10px;
        }

        .status-success {
            background: #d1fae5;
            color: #065f46;
        }

        .status-error {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-warning {
            background: #fef3c7;
            color: #92400e;
        }

        body.dark .status-success {
            background: #064e3b;
            color: #6ee7b7;
        }

        body.dark .status-error {
            background: #7f1d1d;
            color: #fca5a5;
        }

        body.dark .status-warning {
            background: #78350f;
            color: #fcd34d;
        }

        .result-time {
            color: #666;
            font-size: 0.85em;
        }

        body.dark .result-time {
            color: #999;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        body.dark .stats {
            background: #1a1a2e;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        body.dark .stat-value {
            color: #818cf8;
        }

        .stat-label {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        body.dark .stat-label {
            color: #999;
        }

        .progress {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
            display: none;
        }

        .progress.active {
            display: block;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s;
        }

        body.dark .progress {
            background: #1a1a2e;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.5em;
            }

            .controls {
                flex-direction: column;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <h1>ğŸ”— ë§í¬ ê²€ì‚¬ê¸°</h1>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>
        </div>
        <p class="subtitle">ì—¬ëŸ¬ URLì˜ ìœ íš¨ì„±ì„ í•œ ë²ˆì— ê²€ì‚¬í•˜ì„¸ìš”</p>

        <textarea id="urlInput" placeholder="ê²€ì‚¬í•  URLì„ í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”&#10;ì˜ˆì‹œ:&#10;https://example.com&#10;https://google.com&#10;https://github.com"></textarea>

        <div class="button-group">
            <button onclick="checkLinks()">ğŸ” ê²€ì‚¬ ì‹œì‘</button>
            <button onclick="clearAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
            <button onclick="exportResults()">ğŸ“¥ ê²°ê³¼ ë‚´ë³´ë‚´ê¸°</button>
        </div>

        <div class="progress" id="progress">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="stats" id="stats" style="display: none;">
            <div class="stat-item">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">ì´ ë§í¬</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="successCount" style="color: #10b981;">0</div>
                <div class="stat-label">ì •ìƒ</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="errorCount" style="color: #ef4444;">0</div>
                <div class="stat-label">ì˜¤ë¥˜</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="warningCount" style="color: #f59e0b;">0</div>
                <div class="stat-label">ê²½ê³ </div>
            </div>
        </div>

        <div class="results" id="results"></div>
    </div>

    <script>
        let resultsData = [];

        function toggleTheme() {
            document.body.classList.toggle('dark');
            const btn = document.querySelector('.theme-toggle');
            btn.textContent = document.body.classList.contains('dark') ? 'â˜€ï¸ ë¼ì´íŠ¸ëª¨ë“œ' : 'ğŸŒ™ ë‹¤í¬ëª¨ë“œ';
        }

        async function checkLinks() {
            const input = document.getElementById('urlInput').value.trim();
            if (!input) {
                alert('ê²€ì‚¬í•  URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const urls = input.split('\n').filter(url => url.trim());
            if (urls.length === 0) {
                alert('ìœ íš¨í•œ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            resultsData = [];
            document.getElementById('results').innerHTML = '';
            document.getElementById('stats').style.display = 'grid';
            document.getElementById('progress').classList.add('active');

            let total = urls.length;
            let success = 0;
            let error = 0;
            let warning = 0;

            for (let i = 0; i < urls.length; i++) {
                const url = urls[i].trim();
                const progress = ((i + 1) / total) * 100;
                document.getElementById('progressBar').style.width = progress + '%';

                const result = await checkSingleLink(url);
                resultsData.push(result);

                if (result.status === 'success') success++;
                else if (result.status === 'error') error++;
                else if (result.status === 'warning') warning++;

                updateStats(total, success, error, warning);
                displayResult(result);
            }

            document.getElementById('progress').classList.remove('active');
        }

        async function checkSingleLink(url) {
            const startTime = Date.now();
            let result = {
                url: url,
                status: 'error',
                statusCode: null,
                message: '',
                responseTime: 0
            };

            try {
                // URL validation
                new URL(url);

                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000);

                const response = await fetch(url, {
                    method: 'HEAD',
                    mode: 'no-cors', // CORS ìš°íšŒ
                    signal: controller.signal
                });

                clearTimeout(timeoutId);

                const responseTime = Date.now() - startTime;
                result.responseTime = responseTime;

                // no-cors ëª¨ë“œì—ì„œëŠ” statusë¥¼ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ GET ì‹œë„
                if (response.type === 'opaque') {
                    // ì‘ë‹µì„ ë°›ì•˜ë‹¤ë©´ ì„œë²„ê°€ ì‚´ì•„ìˆëŠ” ê²ƒ
                    result.status = 'success';
                    result.statusCode = 'OK';
                    result.message = 'ì‘ë‹µ ìˆ˜ì‹  (CORS ì œí•œìœ¼ë¡œ ìƒì„¸ ì •ë³´ ì—†ìŒ)';
                } else {
                    result.statusCode = response.status;

                    if (response.status >= 200 && response.status < 300) {
                        result.status = 'success';
                        result.message = 'ì •ìƒ ì‘ë‹µ';
                    } else if (response.status >= 300 && response.status < 400) {
                        result.status = 'warning';
                        result.message = 'ë¦¬ë‹¤ì´ë ‰íŠ¸';
                    } else {
                        result.status = 'error';
                        result.message = `HTTP ${response.status}`;
                    }
                }
            } catch (err) {
                const responseTime = Date.now() - startTime;
                result.responseTime = responseTime;

                if (err.name === 'AbortError') {
                    result.message = 'íƒ€ì„ì•„ì›ƒ (10ì´ˆ ì´ˆê³¼)';
                } else if (err.name === 'TypeError' && err.message.includes('URL')) {
                    result.message = 'ì˜ëª»ëœ URL í˜•ì‹';
                } else {
                    // CORS ì—ëŸ¬ëŠ” ì‹¤ì œë¡œëŠ” ì„œë²„ê°€ ì‘ë‹µí–ˆì„ ìˆ˜ ìˆìŒ
                    result.status = 'warning';
                    result.message = 'ì ‘ê·¼ ë¶ˆê°€ (CORS ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜)';
                }
            }

            return result;
        }

        function updateStats(total, success, error, warning) {
            document.getElementById('totalCount').textContent = total;
            document.getElementById('successCount').textContent = success;
            document.getElementById('errorCount').textContent = error;
            document.getElementById('warningCount').textContent = warning;
        }

        function displayResult(result) {
            const resultsDiv = document.getElementById('results');
            const resultItem = document.createElement('div');
            resultItem.className = `result-item ${result.status}`;

            let statusClass = 'status-error';
            if (result.status === 'success') statusClass = 'status-success';
            else if (result.status === 'warning') statusClass = 'status-warning';

            resultItem.innerHTML = `
                <div class="result-url">${escapeHtml(result.url)}</div>
                <div>
                    <span class="result-status ${statusClass}">
                        ${result.statusCode || 'N/A'} ${result.message}
                    </span>
                    <span class="result-time">ì‘ë‹µ ì‹œê°„: ${result.responseTime}ms</span>
                </div>
            `;

            resultsDiv.appendChild(resultItem);
        }

        function clearAll() {
            document.getElementById('urlInput').value = '';
            document.getElementById('results').innerHTML = '';
            document.getElementById('stats').style.display = 'none';
            document.getElementById('progress').classList.remove('active');
            document.getElementById('progressBar').style.width = '0%';
            resultsData = [];
        }

        function exportResults() {
            if (resultsData.length === 0) {
                alert('ë‚´ë³´ë‚¼ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            let csv = 'URL,Status,Status Code,Message,Response Time (ms)\n';
            resultsData.forEach(result => {
                csv += `"${result.url}","${result.status}","${result.statusCode || 'N/A'}","${result.message}",${result.responseTime}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `link-check-results-${Date.now()}.csv`;
            link.click();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ì˜ˆì‹œ URL ìë™ ì…ë ¥ (ê°œë°œìš©)
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            // ê°œë°œ í™˜ê²½ì—ì„œë§Œ
        }
    </script>
</body>
</html>
