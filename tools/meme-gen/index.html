<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meme Generator | ë°ˆ ìƒì„±ê¸°</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#f8f9fa;--bg2:#fff;--text:#212529;--text2:#6c757d;--border:#dee2e6;--accent:#667eea;--accent2:#764ba2;--shadow:rgba(0,0,0,.08)}
[data-theme=dark]{--bg:#121212;--bg2:#1e1e1e;--text:#e0e0e0;--text2:#999;--border:#333;--shadow:rgba(0,0,0,.3)}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;transition:all .3s}
.header{text-align:center;padding:30px 20px 20px;position:relative}
.header h1{font-size:1.8rem;background:linear-gradient(135deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header p{color:var(--text2);margin-top:8px;font-size:.95rem}
.back-link{position:absolute;left:20px;top:35px;text-decoration:none;color:var(--accent);font-size:1.2rem}
.theme-btn{position:absolute;right:20px;top:30px;background:var(--bg2);border:2px solid var(--border);border-radius:50%;width:42px;height:42px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center}
.container{max-width:1100px;margin:0 auto;padding:0 20px 40px;display:grid;grid-template-columns:360px 1fr;gap:24px}
@media(max-width:800px){.container{grid-template-columns:1fr}}
.panel{background:var(--bg2);border-radius:16px;padding:24px;box-shadow:0 4px 20px var(--shadow)}
label{display:block;font-weight:600;margin-bottom:6px;font-size:.9rem}
select,input,textarea{width:100%;padding:10px 14px;border:2px solid var(--border);border-radius:10px;background:var(--bg);color:var(--text);font-size:.95rem;transition:border .2s;font-family:inherit}
select:focus,input:focus,textarea:focus{outline:none;border-color:var(--accent)}
.row{display:flex;gap:12px;margin-bottom:16px}
.row>div{flex:1}
.mb{margin-bottom:16px}
.btn{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;border:none;border-radius:10px;cursor:pointer;font-size:.95rem;font-weight:600;transition:all .2s}
.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(102,126,234,.4)}
.btn-secondary{background:var(--bg);border:2px solid var(--border);color:var(--text)}
.btn-secondary:hover{border-color:var(--accent)}
.btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px}
.drop-zone{border:3px dashed var(--border);border-radius:16px;padding:40px 20px;text-align:center;cursor:pointer;transition:all .3s;position:relative;margin-bottom:16px}
.drop-zone:hover,.drop-zone.drag{border-color:var(--accent);background:rgba(102,126,234,.05)}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer}
.drop-zone .icon{font-size:2.5rem;margin-bottom:8px}
.drop-zone p{color:var(--text2);font-size:.9rem}
.templates{display:grid;grid-template-columns:repeat(auto-fill,minmax(50px,1fr));gap:8px;margin-bottom:16px}
.tpl{width:100%;aspect-ratio:1;border-radius:8px;border:3px solid transparent;cursor:pointer;transition:all .2s}
.tpl:hover,.tpl.active{border-color:var(--accent);transform:scale(1.1)}
.canvas-wrap{display:flex;align-items:center;justify-content:center;min-height:400px}
canvas{max-width:100%;border-radius:8px;box-shadow:0 4px 20px var(--shadow)}
.hint{font-size:.8rem;color:var(--text2);margin-top:4px}
.color-input{display:flex;gap:8px;align-items:center}
.color-input input[type=color]{width:42px;height:38px;padding:2px;border-radius:8px;cursor:pointer}
.color-input input[type=range]{flex:1}
</style>
</head>
<body>
<div class="header">
<a href="../" class="back-link">â† ë„êµ¬ ëª©ë¡</a>
<button class="theme-btn" onclick="toggleTheme()">ğŸŒ“</button>
<h1>ğŸ˜‚ Meme Generator</h1>
<p>ì´ë¯¸ì§€ì— ë°ˆ í…ìŠ¤íŠ¸ë¥¼ ì˜¤ë²„ë ˆì´í•˜ì„¸ìš”</p>
</div>
<div class="container">
<div class="panel">
<div class="drop-zone" id="dropZone">
<input type="file" accept="image/*" onchange="loadImage(event)">
<div class="icon">ğŸ“·</div>
<p>ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì„¸ìš”</p>
</div>
<div class="mb">
<label>í”„ë¦¬ì…‹ ë°°ê²½</label>
<div class="templates" id="templates"></div>
</div>
<div class="mb">
<label>ìƒë‹¨ í…ìŠ¤íŠ¸</label>
<input type="text" id="topText" placeholder="ìƒë‹¨ í…ìŠ¤íŠ¸ ì…ë ¥..." oninput="render()">
</div>
<div class="mb">
<label>í•˜ë‹¨ í…ìŠ¤íŠ¸</label>
<input type="text" id="bottomText" placeholder="í•˜ë‹¨ í…ìŠ¤íŠ¸ ì…ë ¥..." oninput="render()">
</div>
<div class="row">
<div>
<label>í°íŠ¸ í¬ê¸°</label>
<input type="range" id="fontSize" min="20" max="120" value="48" oninput="render()">
</div>
<div style="flex:0 0 60px;text-align:center;padding-top:28px" id="fontSizeVal">48</div>
</div>
<div class="mb">
<label>í…ìŠ¤íŠ¸ ìƒ‰ìƒ</label>
<div class="color-input">
<input type="color" id="textColor" value="#ffffff" oninput="render()">
<span id="textColorVal">#ffffff</span>
</div>
</div>
<div class="mb">
<label>ì™¸ê³½ì„  ìƒ‰ìƒ</label>
<div class="color-input">
<input type="color" id="strokeColor" value="#000000" oninput="render()">
<span id="strokeColorVal">#000000</span>
</div>
</div>
<div class="row">
<div>
<label>ì™¸ê³½ì„  ë‘ê»˜</label>
<input type="range" id="strokeWidth" min="0" max="12" value="4" oninput="render()">
</div>
<div style="flex:0 0 40px;text-align:center;padding-top:28px" id="strokeWidthVal">4</div>
</div>
<div class="mb">
<label>í°íŠ¸ ìŠ¤íƒ€ì¼</label>
<select id="fontStyle" onchange="render()">
<option value="Impact">Impact (Classic)</option>
<option value="Arial Black">Arial Black</option>
<option value="Comic Sans MS">Comic Sans</option>
<option value="Georgia">Georgia</option>
<option value="Courier New">Courier New</option>
</select>
</div>
<div class="btn-row">
<button class="btn btn-primary" onclick="download()">ğŸ’¾ PNG ë‹¤ìš´ë¡œë“œ</button>
<button class="btn btn-secondary" onclick="resetAll()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>
</div>
</div>
<div class="panel">
<div class="canvas-wrap">
<canvas id="meme" width="600" height="600"></canvas>
</div>
</div>
</div>
<script>
let img=null;
let bgColor='#1a1a1a';

const PRESETS=[
  {bg:'#1a1a1a',label:'ê²€ì •'},{bg:'#ffffff',label:'í°ìƒ‰'},{bg:'#ff4e50',label:'ë¹¨ê°•'},
  {bg:'#3a86ff',label:'íŒŒë‘'},{bg:'#06d6a0',label:'ì´ˆë¡'},{bg:'#ffd166',label:'ë…¸ë‘'},
  {bg:'#8338ec',label:'ë³´ë¼'},{bg:'linear-gradient(135deg,#667eea,#764ba2)',label:'ê·¸ë¼ë””ì–¸íŠ¸'},
  {bg:'linear-gradient(135deg,#ff4e50,#fc913a)',label:'ì„ì–‘'},
  {bg:'linear-gradient(135deg,#43e97b,#38f9d7)',label:'ë¯¼íŠ¸'}
];

function initTemplates(){
  const el=document.getElementById('templates');
  PRESETS.forEach((p,i)=>{
    const d=document.createElement('div');
    d.className='tpl'+(i===0?' active':'');
    d.style.background=p.bg;
    d.title=p.label;
    d.onclick=()=>{
      img=null;bgColor=p.bg;
      document.querySelectorAll('.tpl').forEach(t=>t.classList.remove('active'));
      d.classList.add('active');render();
    };
    el.appendChild(d);
  });
}

function loadImage(e){
  const file=(e.dataTransfer?e.dataTransfer.files:e.target.files)[0];
  if(!file||!file.type.startsWith('image/'))return;
  const reader=new FileReader();
  reader.onload=ev=>{
    const i=new Image();
    i.onload=()=>{img=i;document.querySelectorAll('.tpl').forEach(t=>t.classList.remove('active'));render()};
    i.src=ev.target.result;
  };
  reader.readAsDataURL(file);
}

const dz=document.getElementById('dropZone');
['dragover','dragenter'].forEach(e=>dz.addEventListener(e,ev=>{ev.preventDefault();dz.classList.add('drag')}));
['dragleave','drop'].forEach(e=>dz.addEventListener(e,ev=>{ev.preventDefault();dz.classList.remove('drag')}));
dz.addEventListener('drop',loadImage);

function render(){
  const canvas=document.getElementById('meme');
  const ctx=canvas.getContext('2d');
  const fontSize=parseInt(document.getElementById('fontSize').value);
  document.getElementById('fontSizeVal').textContent=fontSize;
  const sw=parseInt(document.getElementById('strokeWidth').value);
  document.getElementById('strokeWidthVal').textContent=sw;
  const tc=document.getElementById('textColor').value;
  document.getElementById('textColorVal').textContent=tc;
  const sc=document.getElementById('strokeColor').value;
  document.getElementById('strokeColorVal').textContent=sc;
  const font=document.getElementById('fontStyle').value;

  if(img){
    canvas.width=img.width;canvas.height=img.height;
    ctx.drawImage(img,0,0);
  }else{
    canvas.width=600;canvas.height=600;
    if(bgColor.startsWith('linear')){
      const m=bgColor.match(/#[0-9a-fA-F]{6}/g);
      if(m&&m.length>=2){
        const g=ctx.createLinearGradient(0,0,canvas.width,canvas.height);
        g.addColorStop(0,m[0]);g.addColorStop(1,m[1]);ctx.fillStyle=g;
      }else ctx.fillStyle='#1a1a1a';
    }else ctx.fillStyle=bgColor;
    ctx.fillRect(0,0,canvas.width,canvas.height);
  }
  
  const topText=document.getElementById('topText').value;
  const bottomText=document.getElementById('bottomText').value;
  
  ctx.font=`bold ${fontSize}px "${font}",Impact,sans-serif`;
  ctx.textAlign='center';ctx.fillStyle=tc;ctx.strokeStyle=sc;ctx.lineWidth=sw;ctx.lineJoin='round';ctx.miterLimit=2;
  
  if(topText)drawMemeText(ctx,topText,canvas.width/2,fontSize+20,canvas.width-40,fontSize,sw);
  if(bottomText)drawMemeText(ctx,bottomText,canvas.width/2,canvas.height-25,canvas.width-40,fontSize,sw);
}

function drawMemeText(ctx,text,x,y,maxW,fontSize,sw){
  const words=text.split(' ');
  const lines=[];let line='';
  words.forEach(w=>{
    const test=line?line+' '+w:w;
    if(ctx.measureText(test).width>maxW&&line){lines.push(line);line=w}
    else line=test;
  });
  if(line)lines.push(line);
  
  const lineH=fontSize*1.15;
  const totalH=lines.length*lineH;
  const startY=y>300?y-totalH+lineH:y;
  
  lines.forEach((l,i)=>{
    const ly=startY+i*lineH;
    if(sw>0)ctx.strokeText(l,x,ly);
    ctx.fillText(l,x,ly);
  });
}

function download(){
  const a=document.createElement('a');a.download='meme.png';
  a.href=document.getElementById('meme').toDataURL('image/png');a.click();
}

function resetAll(){
  img=null;bgColor='#1a1a1a';
  document.getElementById('topText').value='';
  document.getElementById('bottomText').value='';
  document.getElementById('fontSize').value=48;
  document.getElementById('textColor').value='#ffffff';
  document.getElementById('strokeColor').value='#000000';
  document.getElementById('strokeWidth').value=4;
  document.querySelectorAll('.tpl').forEach((t,i)=>t.classList.toggle('active',i===0));
  render();
}

function toggleTheme(){
  const t=document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark';
  document.documentElement.setAttribute('data-theme',t);localStorage.setItem('theme',t);
}
document.documentElement.setAttribute('data-theme',localStorage.getItem('theme')||'light');
initTemplates();render();
</script>
</body>
</html>
