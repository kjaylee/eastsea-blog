<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nginx ì„¤ì • ìƒì„±ê¸° | Nginx Config Generator</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#fff;--bg2:#f8f9fa;--text:#212529;--text2:#6c757d;--accent:#667eea;--border:#dee2e6;--shadow:rgba(0,0,0,.1);--card:#fff;--code-bg:#f1f3f5}
        [data-theme="dark"]{--bg:#1a1a1a;--bg2:#2d2d2d;--text:#f8f9fa;--text2:#adb5bd;--border:#495057;--shadow:rgba(0,0,0,.3);--card:#2d2d2d;--code-bg:#1e1e1e}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg2);color:var(--text);padding:20px;min-height:100vh;transition:all .3s}
        .container{max-width:1000px;margin:0 auto}
        header{text-align:center;margin-bottom:30px}
        h1{font-size:1.8rem;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px}
        .subtitle{color:var(--text2);font-size:.95rem}
        .theme-toggle{position:fixed;top:15px;right:15px;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;cursor:pointer;font-size:1.2rem;display:flex;align-items:center;justify-content:center;z-index:10}
        .home-btn{position:fixed;top:15px;left:15px;text-decoration:none;background:var(--card);border:1px solid var(--border);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;z-index:10}
        .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
        .panel{background:var(--card);border-radius:12px;padding:20px;margin-bottom:20px;box-shadow:0 2px 8px var(--shadow)}
        .panel h2{font-size:1rem;margin-bottom:14px;display:flex;align-items:center;gap:8px}
        .field{margin-bottom:12px}
        label{display:block;font-size:.85rem;font-weight:600;margin-bottom:4px;color:var(--text2)}
        input,select{width:100%;padding:10px 12px;border:2px solid var(--border);border-radius:8px;font-size:.9rem;background:var(--bg);color:var(--text);transition:border .3s}
        input:focus,select:focus{outline:none;border-color:var(--accent)}
        .checkbox-group{display:flex;flex-wrap:wrap;gap:10px;margin:8px 0}
        .checkbox-group label{display:flex;align-items:center;gap:6px;cursor:pointer;font-weight:normal;color:var(--text)}
        .output-area{position:relative}
        .output{width:100%;min-height:500px;padding:16px;border:1px solid var(--border);border-radius:8px;font-family:'SF Mono',Monaco,Consolas,monospace;font-size:.8rem;line-height:1.6;background:var(--code-bg);color:var(--text);resize:vertical;white-space:pre;overflow-x:auto;tab-size:4}
        .btn-row{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
        .btn{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .2s}
        .btn-primary{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}
        .btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(102,126,234,.4)}
        .btn-secondary{background:#e9ecef;color:var(--text)}
        [data-theme="dark"] .btn-secondary{background:#3d3d3d}
        .preset-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
        .preset{padding:6px 14px;border-radius:20px;border:1px solid var(--border);background:var(--bg);color:var(--text);cursor:pointer;font-size:.8rem;transition:all .2s}
        .preset:hover,.preset.active{background:var(--accent);color:#fff;border-color:var(--accent)}
        .toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:10px 24px;border-radius:8px;font-size:.9rem;opacity:0;transition:opacity .3s;z-index:100}
        .toast.show{opacity:1}
        @media(max-width:700px){.grid{grid-template-columns:1fr}h1{font-size:1.4rem}.output{min-height:300px}}
    </style>
</head>
<body>
    <a href="/tools/" class="home-btn" title="ë„êµ¬ ëª©ë¡">ğŸ </a>
    <button class="theme-toggle" onclick="toggleTheme()" title="í…Œë§ˆ ì „í™˜">ğŸŒ“</button>
    <div class="container">
        <header>
            <h1>âš™ï¸ Nginx ì„¤ì • ìƒì„±ê¸°</h1>
            <p class="subtitle">ì˜µì…˜ì„ ì„ íƒí•˜ë©´ Nginx ì„¤ì • íŒŒì¼ì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤</p>
        </header>
        <div class="preset-row">
            <button class="preset active" onclick="applyPreset('static')">ğŸ“ ì •ì  ì‚¬ì´íŠ¸</button>
            <button class="preset" onclick="applyPreset('proxy')">ğŸ”„ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ</button>
            <button class="preset" onclick="applyPreset('spa')">âš›ï¸ SPA (React/Vue)</button>
            <button class="preset" onclick="applyPreset('php')">ğŸ˜ PHP (Laravel)</button>
            <button class="preset" onclick="applyPreset('wordpress')">ğŸ“ WordPress</button>
            <button class="preset" onclick="applyPreset('api')">ğŸ”Œ API ì„œë²„</button>
        </div>
        <div class="grid">
            <div>
                <div class="panel">
                    <h2>ğŸŒ ì„œë²„ ê¸°ë³¸</h2>
                    <div class="field"><label>ë„ë©”ì¸</label><input type="text" id="domain" value="example.com" oninput="generate()"></div>
                    <div class="field"><label>í¬íŠ¸</label><input type="number" id="port" value="80" oninput="generate()"></div>
                    <div class="field"><label>Root ê²½ë¡œ</label><input type="text" id="root" value="/var/www/html" oninput="generate()"></div>
                </div>
                <div class="panel">
                    <h2>ğŸ”’ SSL/TLS</h2>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="ssl" onchange="generate()"> SSL í™œì„±í™”</label>
                        <label><input type="checkbox" id="http2" onchange="generate()"> HTTP/2</label>
                        <label><input type="checkbox" id="hsts" onchange="generate()"> HSTS</label>
                        <label><input type="checkbox" id="redirect" onchange="generate()"> HTTPâ†’HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸</label>
                    </div>
                    <div class="field"><label>ì¸ì¦ì„œ ê²½ë¡œ</label><input type="text" id="certPath" value="/etc/letsencrypt/live/example.com/fullchain.pem" oninput="generate()"></div>
                    <div class="field"><label>í‚¤ ê²½ë¡œ</label><input type="text" id="keyPath" value="/etc/letsencrypt/live/example.com/privkey.pem" oninput="generate()"></div>
                </div>
                <div class="panel">
                    <h2>ğŸ”„ í”„ë¡ì‹œ ì„¤ì •</h2>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="proxy" onchange="generate()"> ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ</label>
                        <label><input type="checkbox" id="websocket" onchange="generate()"> WebSocket ì§€ì›</label>
                    </div>
                    <div class="field"><label>ì—…ìŠ¤íŠ¸ë¦¼ ì£¼ì†Œ</label><input type="text" id="upstream" value="http://127.0.0.1:3000" oninput="generate()"></div>
                </div>
                <div class="panel">
                    <h2>âš¡ ìµœì í™”</h2>
                    <div class="checkbox-group">
                        <label><input type="checkbox" id="gzip" checked onchange="generate()"> Gzip ì••ì¶•</label>
                        <label><input type="checkbox" id="cache" onchange="generate()"> ì •ì  íŒŒì¼ ìºì‹œ</label>
                        <label><input type="checkbox" id="security" onchange="generate()"> ë³´ì•ˆ í—¤ë”</label>
                        <label><input type="checkbox" id="cors" onchange="generate()"> CORS í—ˆìš©</label>
                        <label><input type="checkbox" id="rateLimit" onchange="generate()"> Rate Limit</label>
                        <label><input type="checkbox" id="logging" checked onchange="generate()"> ë¡œê¹…</label>
                    </div>
                </div>
            </div>
            <div class="output-area">
                <div class="panel" style="height:100%">
                    <h2>ğŸ“„ ìƒì„±ëœ ì„¤ì •</h2>
                    <textarea class="output" id="output" readonly></textarea>
                    <div class="btn-row">
                        <button class="btn btn-primary" onclick="copyOutput()">ğŸ“‹ ë³µì‚¬</button>
                        <button class="btn btn-secondary" onclick="downloadConf()">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="toast" id="toast"></div>
<script>
const presets={
    static:{ssl:false,http2:false,hsts:false,redirect:false,proxy:false,websocket:false,gzip:true,cache:true,security:false,cors:false,rateLimit:false,logging:true,root:'/var/www/html',upstream:'http://127.0.0.1:3000'},
    proxy:{ssl:true,http2:true,hsts:true,redirect:true,proxy:true,websocket:false,gzip:true,cache:false,security:true,cors:false,rateLimit:false,logging:true,root:'/var/www/html',upstream:'http://127.0.0.1:3000'},
    spa:{ssl:true,http2:true,hsts:true,redirect:true,proxy:false,websocket:false,gzip:true,cache:true,security:true,cors:false,rateLimit:false,logging:true,root:'/var/www/app/dist',upstream:'http://127.0.0.1:3000'},
    php:{ssl:true,http2:true,hsts:false,redirect:true,proxy:false,websocket:false,gzip:true,cache:true,security:true,cors:false,rateLimit:false,logging:true,root:'/var/www/html/public',upstream:'http://127.0.0.1:3000'},
    wordpress:{ssl:true,http2:true,hsts:false,redirect:true,proxy:false,websocket:false,gzip:true,cache:true,security:true,cors:false,rateLimit:false,logging:true,root:'/var/www/wordpress',upstream:'http://127.0.0.1:3000'},
    api:{ssl:true,http2:true,hsts:true,redirect:true,proxy:true,websocket:true,gzip:true,cache:false,security:true,cors:true,rateLimit:true,logging:true,root:'/var/www/html',upstream:'http://127.0.0.1:8080'}
};
let currentPreset='static';

function applyPreset(name){
    currentPreset=name;
    const p=presets[name];
    document.querySelectorAll('.preset').forEach(b=>b.classList.remove('active'));
    event.target.classList.add('active');
    ['ssl','http2','hsts','redirect','proxy','websocket','gzip','cache','security','cors','rateLimit','logging'].forEach(k=>{
        document.getElementById(k).checked=p[k];
    });
    document.getElementById('root').value=p.root;
    document.getElementById('upstream').value=p.upstream;
    generate();
}

function generate(){
    const domain=document.getElementById('domain').value||'example.com';
    const port=document.getElementById('port').value||'80';
    const root=document.getElementById('root').value;
    const ssl=document.getElementById('ssl').checked;
    const http2=document.getElementById('http2').checked;
    const hsts=document.getElementById('hsts').checked;
    const redirect=document.getElementById('redirect').checked;
    const proxy=document.getElementById('proxy').checked;
    const websocket=document.getElementById('websocket').checked;
    const upstream=document.getElementById('upstream').value;
    const gzip=document.getElementById('gzip').checked;
    const cache=document.getElementById('cache').checked;
    const security=document.getElementById('security').checked;
    const cors=document.getElementById('cors').checked;
    const rateLimit=document.getElementById('rateLimit').checked;
    const logging=document.getElementById('logging').checked;
    const certPath=document.getElementById('certPath').value;
    const keyPath=document.getElementById('keyPath').value;

    let conf='# Nginx Configuration\n# Generated by eastsea.monster/tools/nginx-config-gen\n# Preset: '+currentPreset+'\n\n';

    if(ssl&&redirect){
        conf+='# HTTP â†’ HTTPS Redirect\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name '+domain+' www.'+domain+';\n    return 301 https://$server_name$request_uri;\n}\n\n';
    }

    if(rateLimit){
        conf+='# Rate Limiting\nlimit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n\n';
    }

    conf+='server {\n';
    if(ssl){
        conf+='    listen 443 ssl'+(http2?' http2':'')+';\n';
        conf+='    listen [::]:443 ssl'+(http2?' http2':'')+';\n';
    }else{
        conf+='    listen '+port+';\n    listen [::]:'+port+';\n';
    }
    conf+='    server_name '+domain+' www.'+domain+';\n';
    conf+='    root '+root+';\n    index index.html index.htm'+(currentPreset==='php'||currentPreset==='wordpress'?' index.php':'')+';\n\n';

    if(ssl){
        conf+='    # SSL Configuration\n';
        conf+='    ssl_certificate '+certPath+';\n';
        conf+='    ssl_certificate_key '+keyPath+';\n';
        conf+='    ssl_protocols TLSv1.2 TLSv1.3;\n';
        conf+='    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384;\n';
        conf+='    ssl_prefer_server_ciphers off;\n';
        conf+='    ssl_session_cache shared:SSL:10m;\n';
        conf+='    ssl_session_timeout 1d;\n';
        conf+='    ssl_session_tickets off;\n\n';
    }

    if(hsts){
        conf+='    # HSTS\n    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;\n\n';
    }

    if(security){
        conf+='    # Security Headers\n';
        conf+='    add_header X-Frame-Options "SAMEORIGIN" always;\n';
        conf+='    add_header X-Content-Type-Options "nosniff" always;\n';
        conf+='    add_header X-XSS-Protection "1; mode=block" always;\n';
        conf+='    add_header Referrer-Policy "strict-origin-when-cross-origin" always;\n';
        conf+='    add_header Content-Security-Policy "default-src \'self\'; script-src \'self\' \'unsafe-inline\'; style-src \'self\' \'unsafe-inline\';" always;\n\n';
    }

    if(cors){
        conf+='    # CORS\n';
        conf+='    add_header Access-Control-Allow-Origin "*" always;\n';
        conf+='    add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;\n';
        conf+='    add_header Access-Control-Allow-Headers "Authorization, Content-Type, Accept" always;\n';
        conf+='    if ($request_method = OPTIONS) {\n        return 204;\n    }\n\n';
    }

    if(logging){
        conf+='    # Logging\n    access_log /var/log/nginx/'+domain+'.access.log;\n    error_log /var/log/nginx/'+domain+'.error.log;\n\n';
    }

    if(gzip){
        conf+='    # Gzip Compression\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css text/xml application/json application/javascript application/xml+rss application/atom+xml image/svg+xml;\n\n';
    }

    if(proxy){
        conf+='    # Reverse Proxy\n    location / {\n';
        if(rateLimit)conf+='        limit_req zone=api burst=20 nodelay;\n';
        conf+='        proxy_pass '+upstream+';\n';
        conf+='        proxy_http_version 1.1;\n';
        conf+='        proxy_set_header Host $host;\n';
        conf+='        proxy_set_header X-Real-IP $remote_addr;\n';
        conf+='        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n';
        conf+='        proxy_set_header X-Forwarded-Proto $scheme;\n';
        if(websocket){
            conf+='        proxy_set_header Upgrade $http_upgrade;\n';
            conf+='        proxy_set_header Connection "upgrade";\n';
        }
        conf+='    }\n\n';
    }else if(currentPreset==='spa'){
        conf+='    # SPA Fallback\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n\n';
    }else if(currentPreset==='php'||currentPreset==='laravel'){
        conf+='    # Laravel/PHP\n    location / {\n        try_files $uri $uri/ /index.php?$query_string;\n    }\n\n';
        conf+='    location ~ \\.php$ {\n        fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;\n        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;\n        include fastcgi_params;\n    }\n\n';
    }else if(currentPreset==='wordpress'){
        conf+='    # WordPress\n    location / {\n        try_files $uri $uri/ /index.php?$args;\n    }\n\n';
        conf+='    location ~ \\.php$ {\n        fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        include fastcgi_params;\n        fastcgi_intercept_errors on;\n    }\n\n';
        conf+='    # WordPress security\n    location ~* /(?:uploads|files)/.*\\.php$ {\n        deny all;\n    }\n    location ~ /\\.(ht|git) {\n        deny all;\n    }\n\n';
    }else{
        conf+='    location / {\n        try_files $uri $uri/ =404;\n    }\n\n';
    }

    if(cache){
        conf+='    # Static File Caching\n    location ~* \\.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {\n        expires 30d;\n        add_header Cache-Control "public, immutable";\n    }\n\n';
    }

    conf+='    # Deny hidden files\n    location ~ /\\. {\n        deny all;\n    }\n';
    conf+='}\n';

    document.getElementById('output').value=conf;
}

function copyOutput(){
    navigator.clipboard.writeText(document.getElementById('output').value).then(()=>showToast('ì„¤ì • ë³µì‚¬ë¨! âœ…'));
}
function downloadConf(){
    const domain=document.getElementById('domain').value||'example';
    const a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([document.getElementById('output').value],{type:'text/plain'}));
    a.download=domain+'.conf';a.click();
    showToast('ë‹¤ìš´ë¡œë“œ ì™„ë£Œ! ğŸ’¾');
}
function toggleTheme(){const d=document.documentElement;const t=d.getAttribute('data-theme')==='dark'?'':'dark';d.setAttribute('data-theme',t);localStorage.setItem('theme',t);}
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2000);}
if(localStorage.getItem('theme')==='dark')document.documentElement.setAttribute('data-theme','dark');
generate();
</script>
</body>
</html>