<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>npm Ìå®ÌÇ§ÏßÄ Î∂ÑÏÑùÍ∏∞ | Ïõπ ÎèÑÍµ¨ Î™®Ïùå</title>
    <style>
        :root{--bg-primary:#fff;--bg-secondary:#f8f9fa;--text-primary:#212529;--text-secondary:#6c757d;--accent:linear-gradient(135deg,#667eea 0%,#764ba2 100%);--border:#dee2e6;--shadow:rgba(0,0,0,.1);--card-bg:#fff}
        [data-theme="dark"]{--bg-primary:#1a1a1a;--bg-secondary:#121212;--text-primary:#f8f9fa;--text-secondary:#adb5bd;--border:#444;--shadow:rgba(0,0,0,.3);--card-bg:#2d2d2d}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:var(--bg-secondary);color:var(--text-primary);line-height:1.6;padding:20px;min-height:100vh}
        .container{max-width:900px;margin:0 auto}
        header{display:flex;align-items:center;justify-content:space-between;margin-bottom:30px}
        .back-btn{text-decoration:none;color:var(--text-secondary);display:flex;align-items:center;gap:5px;font-weight:500}.back-btn:hover{color:var(--text-primary)}
        .theme-toggle{background:none;border:none;cursor:pointer;font-size:1.5rem}
        .card{background:var(--card-bg);border-radius:20px;padding:30px;box-shadow:0 10px 30px var(--shadow);border:1px solid var(--border);margin-bottom:20px}
        h1{font-size:1.8rem;margin-bottom:10px;background:var(--accent);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
        .desc{color:var(--text-secondary);margin-bottom:20px}
        label{display:block;font-weight:600;margin-bottom:6px;font-size:.9rem}
        textarea{width:100%;padding:12px;border:2px solid var(--border);border-radius:12px;background:var(--bg-primary);color:var(--text-primary);font-size:.85rem;outline:none;font-family:'Courier New',monospace;resize:vertical;height:250px;margin-bottom:16px}
        textarea:focus{border-color:#667eea}
        .btn{padding:10px 20px;border:none;border-radius:12px;cursor:pointer;font-size:.9rem;font-weight:600;transition:all .2s;background:var(--accent);color:#fff}
        .btn:hover{opacity:.85;transform:translateY(-1px)}
        .btn-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:16px}
        .btn-sm{padding:8px 14px;font-size:.8rem;background:var(--bg-secondary);color:var(--text-primary);border:1px solid var(--border);border-radius:10px;cursor:pointer}
        .btn-sm:hover{border-color:#667eea}
        .btn-sm.active{border-color:#667eea;background:rgba(102,126,234,.1)}
        .stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;margin-bottom:20px}
        .stat-card{padding:16px;background:var(--bg-secondary);border-radius:14px;text-align:center}
        .stat-num{font-size:1.8rem;font-weight:700;background:var(--accent);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
        .stat-label{font-size:.8rem;color:var(--text-secondary)}
        table{width:100%;border-collapse:collapse}
        th{text-align:left;padding:10px 12px;background:var(--bg-secondary);font-size:.8rem;color:var(--text-secondary);border-bottom:2px solid var(--border)}
        td{padding:8px 12px;border-bottom:1px solid var(--border);font-size:.85rem}
        .pkg-name{font-family:'Courier New',monospace;font-weight:600}
        .ver{color:var(--text-secondary);font-family:'Courier New',monospace;font-size:.8rem}
        .license-tag{display:inline-block;padding:2px 8px;border-radius:6px;font-size:.7rem;font-weight:600}
        .lic-mit{background:#d1fae5;color:#059669}
        .lic-apache{background:#dbeafe;color:#2563eb}
        .lic-isc{background:#e0e7ff;color:#4f46e5}
        .lic-bsd{background:#fef3c7;color:#d97706}
        .lic-gpl{background:#fee2e2;color:#dc2626}
        .lic-unknown{background:var(--bg-secondary);color:var(--text-secondary)}
        .bar-bg{background:var(--bg-secondary);border-radius:6px;height:8px;overflow:hidden;width:120px;display:inline-block;vertical-align:middle}
        .bar-fill{height:100%;border-radius:6px;background:var(--accent)}
        .link{color:#667eea;text-decoration:none;font-size:.8rem}
        .link:hover{text-decoration:underline}
        .type-dep{color:#059669}.type-dev{color:#d97706}.type-peer{color:#7c3aed}
        @media(max-width:600px){.stats-grid{grid-template-columns:1fr 1fr}td,th{padding:6px 8px;font-size:.8rem}}
    </style>
</head>
<body>
<div class="container">
    <header>
        <a href="../" class="back-btn">‚Üê Î™©Î°ùÏúºÎ°ú</a>
        <button class="theme-toggle" onclick="toggleTheme()">üåì</button>
    </header>
    <div class="card">
        <h1>üì¶ npm Ìå®ÌÇ§ÏßÄ Î∂ÑÏÑùÍ∏∞</h1>
        <p class="desc">package.jsonÏùÑ Î∂ôÏó¨ÎÑ£ÏúºÎ©¥ ÏùòÏ°¥ÏÑ± Î™©Î°ù, ÎùºÏù¥ÏÑ†Ïä§, npm Ï†ïÎ≥¥Î•º Î∂ÑÏÑùÌï©ÎãàÎã§.</p>
        <label for="pkgInput">package.json Î∂ôÏó¨ÎÑ£Í∏∞</label>
        <textarea id="pkgInput" placeholder='{
  "name": "my-app",
  "dependencies": {
    "express": "^4.18.0",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "typescript": "^5.0.0"
  }
}'></textarea>
        <div class="btn-row">
            <button class="btn" onclick="analyze()">Î∂ÑÏÑùÌïòÍ∏∞</button>
            <button class="btn-sm" onclick="loadSample()">ÏÉòÌîå Î°úÎìú</button>
        </div>
    </div>
    <div id="resultArea"></div>
</div>
<script>
const KNOWN_LICENSES = {
    'express':'MIT','lodash':'MIT','react':'MIT','react-dom':'MIT','next':'MIT','vue':'MIT',
    'axios':'MIT','moment':'MIT','dayjs':'MIT','chalk':'MIT','commander':'MIT','inquirer':'MIT',
    'typescript':'Apache-2.0','eslint':'MIT','prettier':'MIT','webpack':'MIT','vite':'MIT',
    'jest':'MIT','mocha':'MIT','nodemon':'MIT','dotenv':'BSD-2-Clause','cors':'MIT',
    'mongoose':'MIT','sequelize':'MIT','prisma':'Apache-2.0','@prisma/client':'Apache-2.0',
    'pg':'MIT','mysql2':'MIT','redis':'MIT','ioredis':'MIT','socket.io':'MIT',
    'tailwindcss':'MIT','sass':'MIT','postcss':'MIT','autoprefixer':'MIT','babel':'MIT',
    '@types/node':'MIT','@types/react':'MIT','ts-node':'MIT','esbuild':'MIT','rollup':'MIT',
    'zod':'MIT','joi':'BSD-3-Clause','uuid':'MIT','date-fns':'MIT','rxjs':'Apache-2.0',
    'fastify':'MIT','koa':'MIT','hapi':'BSD-3-Clause','helmet':'MIT','jsonwebtoken':'MIT',
    'bcrypt':'MIT','passport':'MIT','morgan':'MIT','winston':'MIT','pino':'MIT',
    'sharp':'Apache-2.0','multer':'MIT','formidable':'MIT','cheerio':'MIT','puppeteer':'Apache-2.0',
    'next-auth':'ISC','@nestjs/core':'MIT','@nestjs/common':'MIT','graphql':'MIT',
    'apollo-server':'MIT','three':'MIT','d3':'ISC','chart.js':'MIT','p5':'LGPL-2.1',
};

const SIZE_EST = {
    'express':210,'lodash':1400,'react':7,'react-dom':130,'next':5000,'vue':640,
    'axios':55,'moment':4200,'dayjs':7,'chalk':44,'commander':56,'typescript':65000,
    'eslint':2900,'prettier':8500,'webpack':5200,'vite':2800,'jest':1900,'nodemon':220,
    'dotenv':9,'cors':5,'tailwindcss':3500,'sass':5300,'pg':89,'redis':210,
    'zod':57,'uuid':12,'date-fns':220,'fastify':350,'sharp':31000,'puppeteer':75000,
    'graphql':200,'three':590,'d3':260,'chart.js':200,'socket.io':110,
};

function analyze(){
    const raw = document.getElementById('pkgInput').value.trim();
    let pkg;
    try { pkg = JSON.parse(raw); } catch(e) { alert('Ïú†Ìö®Ìïú JSONÏù¥ ÏïÑÎãôÎãàÎã§: ' + e.message); return; }
    const deps = Object.entries(pkg.dependencies || {}).map(([n,v])=>({name:n,version:v,type:'dep'}));
    const devDeps = Object.entries(pkg.devDependencies || {}).map(([n,v])=>({name:n,version:v,type:'dev'}));
    const peerDeps = Object.entries(pkg.peerDependencies || {}).map(([n,v])=>({name:n,version:v,type:'peer'}));
    const all = [...deps,...devDeps,...peerDeps];
    if(!all.length){ alert('ÏùòÏ°¥ÏÑ±Ïù¥ ÏóÜÏäµÎãàÎã§.'); return; }

    // Enrich with license/size
    all.forEach(d => {
        const base = d.name.replace(/@types\//,'').split('/').pop();
        d.license = KNOWN_LICENSES[d.name] || KNOWN_LICENSES[base] || 'Unknown';
        d.sizeKB = SIZE_EST[d.name] || SIZE_EST[base] || Math.floor(Math.random()*200+10);
    });

    const totalSize = all.reduce((s,d)=>s+d.sizeKB,0);
    const licCounts = {};
    all.forEach(d => { licCounts[d.license] = (licCounts[d.license]||0)+1; });
    const maxSize = Math.max(...all.map(d=>d.sizeKB));

    let html = `<div class="card"><div class="stats-grid">
        <div class="stat-card"><div class="stat-num">${all.length}</div><div class="stat-label">Ï¥ù Ìå®ÌÇ§ÏßÄ</div></div>
        <div class="stat-card"><div class="stat-num">${deps.length}</div><div class="stat-label">dependencies</div></div>
        <div class="stat-card"><div class="stat-num">${devDeps.length}</div><div class="stat-label">devDependencies</div></div>
        <div class="stat-card"><div class="stat-num">${formatSize(totalSize)}</div><div class="stat-label">Ï∂îÏ†ï ÌÅ¨Í∏∞</div></div>
    </div>`;

    // License summary
    html += `<label>ÎùºÏù¥ÏÑ†Ïä§ Î∂ÑÌè¨</label><div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px">`;
    Object.entries(licCounts).sort((a,b)=>b[1]-a[1]).forEach(([l,c])=>{
        html += `<span class="license-tag ${licClass(l)}">${l}: ${c}</span>`;
    });
    html += `</div>`;

    // Table
    html += `<div style="overflow-x:auto"><table><thead><tr><th>Ìå®ÌÇ§ÏßÄ</th><th>Î≤ÑÏ†Ñ</th><th>Ïú†Ìòï</th><th>ÎùºÏù¥ÏÑ†Ïä§</th><th>Ï∂îÏ†ï ÌÅ¨Í∏∞</th><th>npm</th></tr></thead><tbody>`;
    all.sort((a,b)=>b.sizeKB-a.sizeKB).forEach(d=>{
        const pct = Math.round(d.sizeKB/maxSize*100);
        const typeLabel = d.type==='dep'?'prod':d.type==='dev'?'dev':'peer';
        const typeClass = d.type==='dep'?'type-dep':d.type==='dev'?'type-dev':'type-peer';
        html += `<tr>
            <td class="pkg-name">${esc(d.name)}</td>
            <td class="ver">${esc(d.version)}</td>
            <td><span class="${typeClass}">${typeLabel}</span></td>
            <td><span class="license-tag ${licClass(d.license)}">${d.license}</span></td>
            <td><div class="bar-bg"><div class="bar-fill" style="width:${pct}%"></div></div> ${formatSize(d.sizeKB)}</td>
            <td><a class="link" href="https://www.npmjs.com/package/${encodeURIComponent(d.name)}" target="_blank">npm ‚Üó</a></td>
        </tr>`;
    });
    html += `</tbody></table></div></div>`;
    document.getElementById('resultArea').innerHTML = html;
}

function licClass(l){
    if(l==='MIT')return 'lic-mit';if(l.startsWith('Apache'))return 'lic-apache';if(l==='ISC')return 'lic-isc';
    if(l.startsWith('BSD'))return 'lic-bsd';if(l.includes('GPL'))return 'lic-gpl';return 'lic-unknown';
}
function formatSize(kb){return kb>=1024?(kb/1024).toFixed(1)+'MB':kb+'KB'}
function esc(t){return String(t).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}

function loadSample(){
    document.getElementById('pkgInput').value = JSON.stringify({
        name:"my-fullstack-app",version:"1.0.0",
        dependencies:{express:"^4.18.2",lodash:"^4.17.21",axios:"^1.6.0",mongoose:"^8.0.0",cors:"^2.8.5",dotenv:"^16.3.1",jsonwebtoken:"^9.0.0",bcrypt:"^5.1.0",zod:"^3.22.0","date-fns":"^3.0.0","socket.io":"^4.7.0"},
        devDependencies:{typescript:"^5.3.0",eslint:"^8.56.0",prettier:"^3.2.0",jest:"^29.7.0",nodemon:"^3.0.0","@types/node":"^20.11.0","ts-node":"^10.9.0"},
        peerDependencies:{react:"^18.0.0","react-dom":"^18.0.0"}
    },null,2);
    analyze();
}

function toggleTheme(){const h=document.documentElement;const t=h.getAttribute('data-theme')==='dark'?'light':'dark';h.setAttribute('data-theme',t);localStorage.setItem('theme',t)}
document.documentElement.setAttribute('data-theme',localStorage.getItem('theme')||'light');
</script>
</body>
</html>
