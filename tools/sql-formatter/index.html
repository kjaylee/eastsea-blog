<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Formatter | SQL ì¿¼ë¦¬ í¬ë§·í„°</title>
    <meta name="description" content="SQL ì¿¼ë¦¬ë¥¼ ì•„ë¦„ë‹µê²Œ í¬ë§·íŒ…í•˜ê³  ìƒ‰ìƒìœ¼ë¡œ êµ¬ë¶„í•˜ì„¸ìš”. SELECT, INSERT, UPDATE, DELETE ì§€ì›">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --accent: #3b82f6;
            --accent-hover: #2563eb;
            --border: #475569;
            --success: #10b981;
            --keyword: #f472b6;
            --string: #fbbf24;
            --number: #a78bfa;
            --comment: #64748b;
            --function: #34d399;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1e1b4b 100%);
            color: var(--text-primary);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .controls {
            background: var(--bg-secondary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid var(--border);
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .control-label {
            font-weight: 600;
            color: var(--text-secondary);
        }

        select, input[type="number"] {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 2px solid var(--border);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.95rem;
            cursor: pointer;
        }

        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: var(--accent);
        }

        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-secondary {
            background: #64748b;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .editor-panel {
            background: var(--bg-secondary);
            border-radius: 15px;
            border: 2px solid var(--border);
            overflow: hidden;
        }

        .panel-header {
            background: var(--bg-tertiary);
            padding: 15px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-actions {
            display: flex;
            gap: 10px;
        }

        .icon-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        textarea {
            width: 100%;
            min-height: 500px;
            padding: 20px;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: none;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
        }

        .output-area {
            width: 100%;
            min-height: 500px;
            padding: 20px;
            background: var(--bg-primary);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.8;
            overflow-x: auto;
            white-space: pre;
        }

        .sql-keyword {
            color: var(--keyword);
            font-weight: 700;
        }

        .sql-string {
            color: var(--string);
        }

        .sql-number {
            color: var(--number);
        }

        .sql-comment {
            color: var(--comment);
            font-style: italic;
        }

        .sql-function {
            color: var(--function);
            font-weight: 600;
        }

        .sql-operator {
            color: #94a3b8;
        }

        .examples {
            background: var(--bg-secondary);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid var(--border);
        }

        .examples h3 {
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .example-btn {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .example-btn:hover {
            background: var(--accent);
            color: white;
            border-color: var(--accent);
        }

        footer {
            text-align: center;
            padding: 30px;
            color: var(--text-secondary);
            margin-top: 40px;
        }

        footer a {
            color: var(--accent);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 1024px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .control-group {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ’¾ SQL Formatter</h1>
            <p class="subtitle">SQL ì¿¼ë¦¬ë¥¼ ì•„ë¦„ë‹µê²Œ í¬ë§·íŒ…í•˜ê³  ìƒ‰ìƒìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸í•˜ì„¸ìš”</p>
        </header>

        <div class="controls">
            <div class="control-group">
                <span class="control-label">í‚¤ì›Œë“œ ì¼€ì´ìŠ¤:</span>
                <select id="keywordCase">
                    <option value="upper">ëŒ€ë¬¸ì (UPPER)</option>
                    <option value="lower">ì†Œë¬¸ì (lower)</option>
                    <option value="capitalize">ì²«ê¸€ìë§Œ ëŒ€ë¬¸ì (Capitalize)</option>
                </select>
            </div>

            <div class="control-group">
                <span class="control-label">ë“¤ì—¬ì“°ê¸°:</span>
                <input type="number" id="indentSize" min="2" max="8" value="4" style="width: 70px;">
                <span class="control-label">ìŠ¤í˜ì´ìŠ¤</span>
            </div>

            <button class="btn btn-success" onclick="formatSQL()">
                âœ¨ í¬ë§·íŒ…
            </button>

            <button class="btn btn-secondary" onclick="clearAll()">
                ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ
            </button>
        </div>

        <div class="editor-container">
            <div class="editor-panel">
                <div class="panel-header">
                    <span>ğŸ“ ì…ë ¥ (Raw SQL)</span>
                    <div class="panel-actions">
                        <button class="icon-btn" onclick="pasteFromClipboard()" title="ë¶™ì—¬ë„£ê¸°">ğŸ“‹</button>
                    </div>
                </div>
                <textarea id="inputSQL" placeholder="SELECT * FROM users WHERE id = 1;

ì—¬ê¸°ì— SQL ì¿¼ë¦¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            </div>

            <div class="editor-panel">
                <div class="panel-header">
                    <span>ğŸ¨ ì¶œë ¥ (Formatted)</span>
                    <div class="panel-actions">
                        <button class="icon-btn" onclick="copyFormatted()" title="ë³µì‚¬">ğŸ“„</button>
                    </div>
                </div>
                <div id="outputSQL" class="output-area">í¬ë§·íŒ… ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
            </div>
        </div>

        <div class="examples">
            <h3>ğŸ“š ì˜ˆì œ ì¿¼ë¦¬</h3>
            <button class="example-btn" onclick="loadExample('select')">SELECT ì¿¼ë¦¬</button>
            <button class="example-btn" onclick="loadExample('insert')">INSERT ì¿¼ë¦¬</button>
            <button class="example-btn" onclick="loadExample('update')">UPDATE ì¿¼ë¦¬</button>
            <button class="example-btn" onclick="loadExample('delete')">DELETE ì¿¼ë¦¬</button>
            <button class="example-btn" onclick="loadExample('create')">CREATE TABLE</button>
            <button class="example-btn" onclick="loadExample('join')">JOIN ì¿¼ë¦¬</button>
            <button class="example-btn" onclick="loadExample('complex')">ë³µì¡í•œ ì¿¼ë¦¬</button>
        </div>

        <footer>
            <p>Made with â¤ï¸ | <a href="../">ë„êµ¬ ëª¨ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</a></p>
        </footer>
    </div>

    <script>
        const inputSQL = document.getElementById('inputSQL');
        const outputSQL = document.getElementById('outputSQL');
        const keywordCase = document.getElementById('keywordCase');
        const indentSize = document.getElementById('indentSize');

        const SQL_KEYWORDS = [
            'SELECT', 'FROM', 'WHERE', 'INSERT', 'INTO', 'VALUES', 'UPDATE', 'SET', 
            'DELETE', 'CREATE', 'TABLE', 'DROP', 'ALTER', 'ADD', 'COLUMN',
            'PRIMARY', 'KEY', 'FOREIGN', 'REFERENCES', 'INDEX', 'UNIQUE',
            'JOIN', 'INNER', 'LEFT', 'RIGHT', 'OUTER', 'ON', 'AS', 'AND', 'OR', 'NOT',
            'IN', 'BETWEEN', 'LIKE', 'IS', 'NULL', 'ORDER', 'BY', 'GROUP', 'HAVING',
            'LIMIT', 'OFFSET', 'DISTINCT', 'COUNT', 'SUM', 'AVG', 'MAX', 'MIN',
            'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'UNION', 'ALL', 'EXISTS',
            'DEFAULT', 'AUTO_INCREMENT', 'NOT NULL', 'CASCADE', 'CONSTRAINT'
        ];

        const SQL_FUNCTIONS = [
            'COUNT', 'SUM', 'AVG', 'MAX', 'MIN', 'UPPER', 'LOWER', 'CONCAT',
            'SUBSTRING', 'LENGTH', 'TRIM', 'NOW', 'DATE', 'TIME', 'YEAR', 'MONTH', 'DAY'
        ];

        function formatSQL() {
            const sql = inputSQL.value.trim();
            if (!sql) {
                outputSQL.textContent = 'ì¿¼ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                return;
            }

            const indent = ' '.repeat(parseInt(indentSize.value));
            const caseStyle = keywordCase.value;
            
            let formatted = sql;
            
            // Remove extra whitespace
            formatted = formatted.replace(/\s+/g, ' ').trim();
            
            // Add newlines before major keywords
            const majorKeywords = ['SELECT', 'FROM', 'WHERE', 'INSERT', 'INTO', 'VALUES', 
                                   'UPDATE', 'SET', 'DELETE', 'JOIN', 'INNER JOIN', 'LEFT JOIN', 
                                   'RIGHT JOIN', 'ORDER BY', 'GROUP BY', 'HAVING', 'LIMIT'];
            
            majorKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                formatted = formatted.replace(regex, `\n${keyword}`);
            });
            
            // Add indentation
            const lines = formatted.split('\n');
            let indentLevel = 0;
            formatted = lines.map((line, index) => {
                line = line.trim();
                if (!line) return '';
                
                // Decrease indent for closing keywords
                if (/^\)/i.test(line)) {
                    indentLevel = Math.max(0, indentLevel - 1);
                }
                
                const indented = indent.repeat(indentLevel) + line;
                
                // Increase indent for opening keywords
                if (/\($/i.test(line) || /^(SELECT|FROM|WHERE|JOIN)/i.test(line)) {
                    if (index > 0) indentLevel++;
                }
                
                return indented;
            }).join('\n');
            
            // Apply keyword case
            SQL_KEYWORDS.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                formatted = formatted.replace(regex, (match) => {
                    switch(caseStyle) {
                        case 'upper': return keyword.toUpperCase();
                        case 'lower': return keyword.toLowerCase();
                        case 'capitalize': return keyword.charAt(0).toUpperCase() + keyword.slice(1).toLowerCase();
                        default: return match;
                    }
                });
            });
            
            // Apply syntax highlighting
            const highlighted = highlightSQL(formatted);
            outputSQL.innerHTML = highlighted;
        }

        function highlightSQL(sql) {
            let result = sql;
            
            // Escape HTML
            result = result.replace(/</g, '&lt;').replace(/>/g, '&gt;');
            
            // Highlight comments
            result = result.replace(/--.*/g, (match) => `<span class="sql-comment">${match}</span>`);
            result = result.replace(/\/\*[\s\S]*?\*\//g, (match) => `<span class="sql-comment">${match}</span>`);
            
            // Highlight strings
            result = result.replace(/'[^']*'/g, (match) => `<span class="sql-string">${match}</span>`);
            result = result.replace(/"[^"]*"/g, (match) => `<span class="sql-string">${match}</span>`);
            
            // Highlight numbers
            result = result.replace(/\b\d+(\.\d+)?\b/g, (match) => `<span class="sql-number">${match}</span>`);
            
            // Highlight keywords
            SQL_KEYWORDS.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                result = result.replace(regex, (match) => `<span class="sql-keyword">${match}</span>`);
            });
            
            // Highlight functions
            SQL_FUNCTIONS.forEach(func => {
                const regex = new RegExp(`\\b${func}\\b(?=\\s*\\()`, 'gi');
                result = result.replace(regex, (match) => `<span class="sql-function">${match}</span>`);
            });
            
            // Highlight operators
            result = result.replace(/[=<>!]+|AND|OR|NOT/g, (match) => `<span class="sql-operator">${match}</span>`);
            
            return result;
        }

        function clearAll() {
            inputSQL.value = '';
            outputSQL.textContent = 'í¬ë§·íŒ… ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...';
        }

        async function pasteFromClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                inputSQL.value = text;
            } catch (err) {
                alert('í´ë¦½ë³´ë“œ ì ‘ê·¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.');
            }
        }

        async function copyFormatted() {
            const text = outputSQL.textContent;
            try {
                await navigator.clipboard.writeText(text);
                const btn = event.target;
                const original = btn.textContent;
                btn.textContent = 'âœ…';
                setTimeout(() => btn.textContent = original, 1500);
            } catch (err) {
                alert('ë³µì‚¬ ì‹¤íŒ¨');
            }
        }

        function loadExample(type) {
            const examples = {
                select: `SELECT u.id, u.name, u.email, o.order_date, o.total_amount FROM users u INNER JOIN orders o ON u.id = o.user_id WHERE o.order_date >= '2024-01-01' AND o.status = 'completed' ORDER BY o.order_date DESC LIMIT 10;`,
                
                insert: `INSERT INTO users (name, email, created_at, status) VALUES ('ê¹€ì² ìˆ˜', 'chulsoo@example.com', NOW(), 'active'), ('ì´ì˜í¬', 'younghee@example.com', NOW(), 'active'), ('ë°•ë¯¼ìˆ˜', 'minsu@example.com', NOW(), 'pending');`,
                
                update: `UPDATE users SET status = 'inactive', updated_at = NOW() WHERE last_login < DATE_SUB(NOW(), INTERVAL 6 MONTH) AND status = 'active';`,
                
                delete: `DELETE FROM logs WHERE created_at < DATE_SUB(NOW(), INTERVAL 90 DAY) AND log_level = 'DEBUG';`,
                
                create: `CREATE TABLE products (id INT AUTO_INCREMENT PRIMARY KEY, name VARCHAR(255) NOT NULL, description TEXT, price DECIMAL(10, 2) NOT NULL, stock INT DEFAULT 0, category_id INT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE CASCADE);`,
                
                join: `SELECT c.name AS customer_name, p.name AS product_name, oi.quantity, oi.price FROM customers c INNER JOIN orders o ON c.id = o.customer_id INNER JOIN order_items oi ON o.id = oi.order_id INNER JOIN products p ON oi.product_id = p.id WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31';`,
                
                complex: `SELECT department, AVG(salary) as avg_salary, COUNT(*) as employee_count FROM employees WHERE hire_date >= '2020-01-01' GROUP BY department HAVING AVG(salary) > 50000 ORDER BY avg_salary DESC;`
            };
            
            inputSQL.value = examples[type] || '';
            formatSQL();
        }

        // Auto-format on load if there's content
        if (inputSQL.value.trim()) {
            formatSQL();
        }
    </script>
</body>
</html>