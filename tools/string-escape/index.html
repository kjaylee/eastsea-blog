<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>String Escape/Unescape</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #ffffff; --bg-secondary: #f8f9fa; --bg-tertiary: #e9ecef;
            --text-primary: #212529; --text-secondary: #6c757d;
            --accent: #0891b2; --border: #dee2e6; --shadow: rgba(0,0,0,0.1);
        }
        [data-theme="dark"] {
            --bg-primary: #0f0f23; --bg-secondary: #1a1a2e; --bg-tertiary: #16213e;
            --text-primary: #e4e4e7; --text-secondary: #a1a1aa;
            --border: #27272a; --shadow: rgba(0,0,0,0.5);
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: var(--bg-primary); color: var(--text-primary);
            padding: 20px; min-height: 100vh; transition: background 0.3s, color 0.3s;
        }
        .container { max-width: 800px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 24px; }
        h1 { font-size: 1.8rem; color: var(--accent); margin-bottom: 6px; }
        .subtitle { color: var(--text-secondary); font-size: 0.9rem; }
        .theme-toggle {
            position: fixed; top: 20px; right: 20px; width: 44px; height: 44px;
            border-radius: 50%; background: var(--bg-secondary); border: 2px solid var(--border);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.3rem; cursor: pointer; z-index: 1000;
        }
        .card {
            background: var(--bg-secondary); border-radius: 16px; padding: 20px;
            border: 1px solid var(--border); margin-bottom: 16px;
        }
        .card h2 { font-size: 1rem; margin-bottom: 12px; color: var(--accent); }
        textarea {
            width: 100%; height: 150px; padding: 12px; border: 1px solid var(--border); border-radius: 10px;
            background: var(--bg-primary); color: var(--text-primary);
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace; font-size: 0.85rem;
            resize: vertical; line-height: 1.5;
        }
        .modes { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
        .mode-btn {
            padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-weight: 600;
            border: 1px solid var(--border); background: var(--bg-tertiary); transition: all 0.2s;
        }
        .mode-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
        .mode-btn:hover { border-color: var(--accent); }
        .btn-row { display: flex; gap: 8px; margin: 12px 0; flex-wrap: wrap; }
        .btn {
            padding: 8px 16px; border: none; border-radius: 8px;
            font-weight: 700; cursor: pointer; font-size: 0.85rem;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border); }
        .btn:hover { opacity: 0.85; }
        .result-box { position: relative; }
        .copy-btn {
            position: absolute; top: 8px; right: 8px; padding: 4px 10px;
            border-radius: 6px; border: 1px solid var(--border); background: var(--bg-secondary);
            color: var(--text-secondary); cursor: pointer; font-size: 0.75rem; z-index: 1;
        }
        .copy-btn:hover { background: var(--accent); color: white; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 8px; }
        .info-item {
            padding: 10px; background: var(--bg-tertiary); border-radius: 8px;
            border: 1px solid var(--border); font-size: 0.8rem;
        }
        .info-item strong { color: var(--accent); }
        @media (max-width: 500px) { .modes { flex-direction: column; } }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()" id="theme-btn">üåô</button>
    <div class="container">
        <header>
            <h1>üîê String Escape / Unescape</h1>
            <p class="subtitle">Îã§ÏñëÌïú ÌòïÏãùÏùò Î¨∏ÏûêÏó¥ Ïù¥Ïä§ÏºÄÏù¥ÌîÑ & Ïñ∏Ïù¥Ïä§ÏºÄÏù¥ÌîÑ</p>
        </header>

        <div class="card">
            <h2>Î™®Îìú ÏÑ†ÌÉù</h2>
            <div class="modes">
                <div class="mode-btn active" data-mode="json" onclick="setMode('json')">JSON</div>
                <div class="mode-btn" data-mode="html" onclick="setMode('html')">HTML</div>
                <div class="mode-btn" data-mode="url" onclick="setMode('url')">URL</div>
                <div class="mode-btn" data-mode="xml" onclick="setMode('xml')">XML</div>
                <div class="mode-btn" data-mode="csv" onclick="setMode('csv')">CSV</div>
                <div class="mode-btn" data-mode="regex" onclick="setMode('regex')">Regex</div>
                <div class="mode-btn" data-mode="sql" onclick="setMode('sql')">SQL</div>
                <div class="mode-btn" data-mode="shell" onclick="setMode('shell')">Shell</div>
            </div>
        </div>

        <div class="card">
            <h2>ÏûÖÎ†•</h2>
            <textarea id="input" placeholder='Î¨∏ÏûêÏó¥ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...&#10;Ïòà: Hello "World" <tag> &amp; ÌäπÏàòÎ¨∏Ïûê' oninput="process()"></textarea>
        </div>

        <div class="btn-row">
            <button class="btn btn-primary" onclick="doEscape()">Escape ‚Üí</button>
            <button class="btn btn-primary" onclick="doUnescape()">‚Üê Unescape</button>
            <button class="btn btn-secondary" onclick="swap()">‚Üï ÍµêÌôò</button>
        </div>

        <div class="card">
            <h2>Í≤∞Í≥º</h2>
            <div class="result-box">
                <button class="copy-btn" onclick="copyResult()">Î≥µÏÇ¨</button>
                <textarea id="output" readonly></textarea>
            </div>
        </div>

        <div class="card">
            <h2>üìñ Ïù¥Ïä§ÏºÄÏù¥ÌîÑ Ï∞∏Ï°∞</h2>
            <div class="info-grid" id="ref-grid"></div>
        </div>
    </div>
    <script>
        let mode = 'json';

        function initTheme() {
            const s = localStorage.getItem('strescape-theme') || 'light';
            document.documentElement.setAttribute('data-theme', s);
            document.getElementById('theme-btn').textContent = s === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }
        function toggleTheme() {
            const c = document.documentElement.getAttribute('data-theme') || 'light';
            const n = c === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', n);
            localStorage.setItem('strescape-theme', n);
            document.getElementById('theme-btn').textContent = n === 'light' ? 'üåô' : '‚òÄÔ∏è';
        }

        function setMode(m) {
            mode = m;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.toggle('active', b.dataset.mode === m));
            updateRef();
            process();
        }

        const escapers = {
            json: {
                escape: s => JSON.stringify(s).slice(1, -1),
                unescape: s => { try { return JSON.parse('"' + s + '"'); } catch(e) { return s; } },
                ref: [['\\\\', 'Î∞±Ïä¨ÎûòÏãú'], ['\\"', 'ÌÅ∞Îî∞Ïò¥Ìëú'], ['\\n', 'Ï§ÑÎ∞îÍøà'], ['\\t', 'ÌÉ≠'], ['\\r', 'Ï∫êÎ¶¨ÏßÄÎ¶¨ÌÑ¥'], ['\\/', 'Ïä¨ÎûòÏãú'], ['\\uXXXX', 'Ïú†ÎãàÏΩîÎìú']]
            },
            html: {
                escape: s => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'),
                unescape: s => { const el = document.createElement('textarea'); el.innerHTML = s; return el.value; },
                ref: [['&amp;', '&'], ['&lt;', '<'], ['&gt;', '>'], ['&quot;', '"'], ['&#039;', "'"], ['&nbsp;', 'Í≥µÎ∞±']]
            },
            url: {
                escape: s => encodeURIComponent(s),
                unescape: s => { try { return decodeURIComponent(s); } catch(e) { return s; } },
                ref: [['%20', 'Í≥µÎ∞±'], ['%2F', '/'], ['%3A', ':'], ['%3F', '?'], ['%26', '&'], ['%3D', '='], ['%23', '#']]
            },
            xml: {
                escape: s => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;'),
                unescape: s => s.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,'>').replace(/&lt;/g,'<').replace(/&amp;/g,'&'),
                ref: [['&amp;', '&'], ['&lt;', '<'], ['&gt;', '>'], ['&quot;', '"'], ['&apos;', "'"]]
            },
            csv: {
                escape: s => '"' + s.replace(/"/g, '""') + '"',
                unescape: s => { if(s.startsWith('"')&&s.endsWith('"')) s=s.slice(1,-1); return s.replace(/""/g, '"'); },
                ref: [['""', 'ÌÅ∞Îî∞Ïò¥Ìëú'], ['"value"', 'ÌïÑÎìú Í∞êÏã∏Í∏∞'], [',', 'Íµ¨Î∂ÑÏûê']]
            },
            regex: {
                escape: s => s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'),
                unescape: s => s.replace(/\\([.*+?^${}()|[\]\\])/g, '$1'),
                ref: [['\\.', '.'], ['\\*', '*'], ['\\+', '+'], ['\\?', '?'], ['\\(\\)', '()'], ['\\[\\]', '[]'], ['\\{\\}', '{}']]
            },
            sql: {
                escape: s => s.replace(/'/g, "''").replace(/\\/g, '\\\\'),
                unescape: s => s.replace(/''/g, "'").replace(/\\\\/g, '\\'),
                ref: [["''", "Îî∞Ïò¥Ìëú"], ['\\\\', 'Î∞±Ïä¨ÎûòÏãú'], ['NULL', 'ÎÑêÍ∞í']]
            },
            shell: {
                escape: s => "'" + s.replace(/'/g, "'\\''") + "'",
                unescape: s => { if(s.startsWith("'")&&s.endsWith("'")) s=s.slice(1,-1); return s.replace(/'\\''/g, "'"); },
                ref: [["'\\''", "Îî∞Ïò¥Ìëú"], ['\\$', 'Îã¨Îü¨'], ['\\`', 'Î∞±Ìã±'], ['\\"', 'ÌÅ∞Îî∞Ïò¥Ìëú']]
            }
        };

        function doEscape() {
            const input = document.getElementById('input').value;
            document.getElementById('output').value = escapers[mode].escape(input);
        }
        function doUnescape() {
            const input = document.getElementById('input').value;
            document.getElementById('output').value = escapers[mode].unescape(input);
        }
        function process() { doEscape(); }
        function swap() {
            const inp = document.getElementById('input');
            const out = document.getElementById('output');
            const tmp = inp.value;
            inp.value = out.value;
            out.value = tmp;
        }
        function copyResult() {
            navigator.clipboard.writeText(document.getElementById('output').value);
        }

        function updateRef() {
            const refs = escapers[mode].ref;
            document.getElementById('ref-grid').innerHTML = refs.map(([esc, desc]) =>
                `<div class="info-item"><strong>${esc}</strong> ‚Üí ${desc}</div>`
            ).join('');
        }

        initTheme();
        updateRef();
    </script>
</body>
</html>
