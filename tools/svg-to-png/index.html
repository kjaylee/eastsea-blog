<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG â†’ PNG ë³€í™˜ê¸° | ì›¹ ë„êµ¬ ëª¨ìŒ</title>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --accent: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --border: #dee2e6;
            --shadow: rgba(0, 0, 0, 0.1);
            --card-bg: #ffffff;
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a1a;
            --bg-secondary: #121212;
            --text-primary: #f8f9fa;
            --text-secondary: #adb5bd;
            --border: #444;
            --shadow: rgba(0, 0, 0, 0.3);
            --card-bg: #2d2d2d;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container { max-width: 1000px; margin: 0 auto; }
        
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .back-btn {
            text-decoration: none;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
            transition: color 0.2s;
        }
        .back-btn:hover { color: var(--text-primary); }

        .theme-toggle {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px var(--shadow);
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            background: var(--accent);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .upload-area {
            border: 3px dashed var(--border);
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg-secondary);
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: #667eea;
            background: var(--bg-primary);
        }

        .upload-area.dragover {
            border-color: #667eea;
            background: var(--bg-primary);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        input[type="file"] {
            display: none;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        input[type="number"], select {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 10px;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            outline: none;
        }

        button {
            padding: 15px;
            border: none;
            border-radius: 12px;
            background: var(--accent);
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
        }

        button:active { transform: scale(0.98); }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .preview-area {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            background: var(--bg-secondary);
            border-radius: 15px;
            border: 1px solid var(--border);
            padding: 20px;
            overflow: auto;
        }

        .preview-area img, .preview-area svg {
            max-width: 100%;
            max-height: 500px;
        }

        .info-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 10px;
        }

        @media (max-width: 600px) {
            .controls { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../" class="back-btn">â† ëª©ë¡ìœ¼ë¡œ</a>
            <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
        </header>

        <div class="card">
            <h1>ğŸ–¼ï¸ SVG â†’ PNG ë³€í™˜ê¸°</h1>
            
            <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                <div class="upload-icon">ğŸ“</div>
                <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px;">
                    í´ë¦­í•˜ê±°ë‚˜ SVG íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”
                </div>
                <div class="info-text">ì§€ì› í˜•ì‹: .svg</div>
            </div>
            <input type="file" id="fileInput" accept=".svg,image/svg+xml" onchange="handleFile(event)">

            <div class="controls">
                <div class="control-group">
                    <label>ë„ˆë¹„ (px)</label>
                    <input type="number" id="width" value="800" min="1" max="4096">
                </div>
                <div class="control-group">
                    <label>ë†’ì´ (px)</label>
                    <input type="number" id="height" value="600" min="1" max="4096">
                </div>
                <div class="control-group">
                    <label>ë°°ê²½ìƒ‰</label>
                    <select id="bgColor">
                        <option value="transparent" selected>íˆ¬ëª…</option>
                        <option value="#FFFFFF">í°ìƒ‰</option>
                        <option value="#000000">ê²€ì •ìƒ‰</option>
                        <option value="custom">ì‚¬ìš©ì ì •ì˜</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>ìŠ¤ì¼€ì¼ ë°°ìœ¨</label>
                    <select id="scale">
                        <option value="1">1x</option>
                        <option value="2" selected>2x (Retina)</option>
                        <option value="3">3x</option>
                        <option value="4">4x</option>
                    </select>
                </div>
            </div>

            <button onclick="convertToPNG()" id="convertBtn" disabled>PNGë¡œ ë³€í™˜ ë° ë‹¤ìš´ë¡œë“œ</button>
        </div>

        <div class="card">
            <h1>ğŸ“¸ ë¯¸ë¦¬ë³´ê¸°</h1>
            <div class="preview-area" id="previewArea">
                <div class="info-text">SVG íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë©ë‹ˆë‹¤</div>
            </div>
        </div>
    </div>

    <script>
        let svgContent = null;
        let svgElement = null;

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');

        // Drag and drop
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                loadSVG(files[0]);
            }
        });

        function handleFile(event) {
            const file = event.target.files[0];
            if (file) {
                loadSVG(file);
            }
        }

        function loadSVG(file) {
            if (!file.type.includes('svg')) {
                alert('SVG íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                svgContent = e.target.result;
                displayPreview(svgContent);
                document.getElementById('convertBtn').disabled = false;
            };
            reader.readAsText(file);
        }

        function displayPreview(svgText) {
            const previewArea = document.getElementById('previewArea');
            previewArea.innerHTML = svgText;
            svgElement = previewArea.querySelector('svg');
            
            if (svgElement) {
                // Get original dimensions
                const viewBox = svgElement.getAttribute('viewBox');
                if (viewBox) {
                    const [, , w, h] = viewBox.split(' ').map(Number);
                    document.getElementById('width').value = Math.round(w);
                    document.getElementById('height').value = Math.round(h);
                } else if (svgElement.width && svgElement.height) {
                    const w = parseFloat(svgElement.getAttribute('width'));
                    const h = parseFloat(svgElement.getAttribute('height'));
                    document.getElementById('width').value = Math.round(w);
                    document.getElementById('height').value = Math.round(h);
                }
            }
        }

        async function convertToPNG() {
            if (!svgContent) {
                alert('ë¨¼ì € SVG íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”');
                return;
            }

            const width = parseInt(document.getElementById('width').value);
            const height = parseInt(document.getElementById('height').value);
            const scale = parseInt(document.getElementById('scale').value);
            const bgColor = document.getElementById('bgColor').value;

            const canvas = document.createElement('canvas');
            canvas.width = width * scale;
            canvas.height = height * scale;
            const ctx = canvas.getContext('2d');

            // Set background
            if (bgColor !== 'transparent') {
                ctx.fillStyle = bgColor === 'custom' ? prompt('ë°°ê²½ìƒ‰ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: #FF0000):', '#FFFFFF') : bgColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            // Create blob from SVG
            const blob = new Blob([svgContent], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);

            const img = new Image();
            img.onload = () => {
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                
                // Download
                canvas.toBlob((pngBlob) => {
                    const downloadUrl = URL.createObjectURL(pngBlob);
                    const a = document.createElement('a');
                    a.href = downloadUrl;
                    a.download = `converted-${Date.now()}.png`;
                    a.click();
                    URL.revokeObjectURL(downloadUrl);
                });

                URL.revokeObjectURL(url);
            };

            img.onerror = () => {
                alert('SVG ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. SVG íŒŒì¼ì´ ì†ìƒë˜ì—ˆê±°ë‚˜ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ë¥¼ ì°¸ì¡°í•˜ê³  ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                URL.revokeObjectURL(url);
            };

            img.src = url;
        }

        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script>
</body>
</html>
